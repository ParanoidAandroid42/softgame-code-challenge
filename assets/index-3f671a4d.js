var Gg=Object.defineProperty;var zg=(r,t,e)=>t in r?Gg(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var L=(r,t,e)=>(zg(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Hg(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),e}var Nd={exports:{}};(function(r,t){(function(e,i){r.exports=i()})(zr,function(){var e=function(){function i(f){return o.appendChild(f.dom),f}function s(f){for(var p=0;p<o.children.length;p++)o.children[p].style.display=p===f?"block":"none";n=f}var n=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(f){f.preventDefault(),s(++n%o.children.length)},!1);var a=(performance||Date).now(),h=a,l=0,u=i(new e.Panel("FPS","#0ff","#002")),c=i(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=i(new e.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:o,addPanel:i,showPanel:s,begin:function(){a=(performance||Date).now()},end:function(){l++;var f=(performance||Date).now();if(c.update(f-a,200),f>h+1e3&&(u.update(1e3*l/(f-h),100),h=f,l=0,d)){var p=performance.memory;d.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return f},update:function(){a=this.end()},domElement:o,setMode:s}};return e.Panel=function(i,s,n){var o=1/0,a=0,h=Math.round,l=h(window.devicePixelRatio||1),u=80*l,c=48*l,d=3*l,f=2*l,p=3*l,m=15*l,g=74*l,y=30*l,v=document.createElement("canvas");v.width=u,v.height=c,v.style.cssText="width:80px;height:48px";var _=v.getContext("2d");return _.font="bold "+9*l+"px Helvetica,Arial,sans-serif",_.textBaseline="top",_.fillStyle=n,_.fillRect(0,0,u,c),_.fillStyle=s,_.fillText(i,d,f),_.fillRect(p,m,g,y),_.fillStyle=n,_.globalAlpha=.9,_.fillRect(p,m,g,y),{dom:v,update:function(x,b){o=Math.min(o,x),a=Math.max(a,x),_.fillStyle=n,_.globalAlpha=1,_.fillRect(0,0,u,m),_.fillStyle=s,_.fillText(h(x)+" "+i+" ("+h(o)+"-"+h(a)+")",d,f),_.drawImage(v,p+l,m,g-l,y,p,m,g-l,y),_.fillRect(p+g-l,m,l,y),_.fillStyle=n,_.globalAlpha=.9,_.fillRect(p+g-l,m,l,h((1-x/b)*y))}}},e})})(Nd);var $g=Nd.exports;const Vg=Cl($g);class Xg{constructor(){const t=new Vg;document.body.appendChild(t.dom);function e(){t.begin(),t.end(),requestAnimationFrame(e)}e()}}var Ae=(r=>(r.Menu="MainStage",r.FirstTask="FirstTask",r.SecondTask="SecondTaskStage",r.ThirdTask="ThirdTaskStage",r))(Ae||{}),Hr=(r=>(r[r.Landscape=0]="Landscape",r[r.Portrait=1]="Portrait",r[r.None=2]="None",r))(Hr||{});class $r{}L($r,"DisplayResolution",{width:1280,height:720});var zi=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(zi||{}),El=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(El||{}),wo=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(wo||{}),W=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(W||{}),Pe=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(Pe||{}),F=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(F||{}),nr=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(nr||{}),X=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(X||{}),G=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(G||{}),Re=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(Re||{}),ti=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(ti||{}),Oe=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(Oe||{}),jt=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(jt||{}),Ce=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(Ce||{}),ea=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(ea||{}),oe=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(oe||{}),Ct=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(Ct||{}),Ud=(r=>(r[r.RED=1]="RED",r[r.GREEN=2]="GREEN",r[r.BLUE=4]="BLUE",r[r.ALPHA=8]="ALPHA",r))(Ud||{}),Tt=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Tt||{}),Fe=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(Fe||{});const Gd={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},U={ADAPTER:Gd,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var va=/iPhone/i,Nu=/iPod/i,Uu=/iPad/i,Gu=/\biOS-universal(?:.+)Mac\b/i,xa=/\bAndroid(?:.+)Mobile\b/i,zu=/Android/i,wr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Fn=/Silk/i,oi=/Windows Phone/i,Hu=/\bWindows(?:.+)ARM\b/i,$u=/BlackBerry/i,Vu=/BB10/i,Xu=/Opera Mini/i,Wu=/\b(CriOS|Chrome)(?:.+)Mobile/i,ju=/Mobile(?:.+)Firefox\b/i,Yu=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function Wg(r){return function(t){return t.test(r)}}function qu(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var s=Wg(e),n={apple:{phone:s(va)&&!s(oi),ipod:s(Nu),tablet:!s(va)&&(s(Uu)||Yu(t))&&!s(oi),universal:s(Gu),device:(s(va)||s(Nu)||s(Uu)||s(Gu)||Yu(t))&&!s(oi)},amazon:{phone:s(wr),tablet:!s(wr)&&s(Fn),device:s(wr)||s(Fn)},android:{phone:!s(oi)&&s(wr)||!s(oi)&&s(xa),tablet:!s(oi)&&!s(wr)&&!s(xa)&&(s(Fn)||s(zu)),device:!s(oi)&&(s(wr)||s(Fn)||s(xa)||s(zu))||s(/\bokhttp\b/i)},windows:{phone:s(oi),tablet:s(Hu),device:s(oi)||s(Hu)},other:{blackberry:s($u),blackberry10:s(Vu),opera:s(Xu),firefox:s(ju),chrome:s(Wu),device:s($u)||s(Vu)||s(Xu)||s(ju)||s(Wu)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const jg=qu.default??qu,Ie=jg(globalThis.navigator);U.RETINA_PREFIX=/@([0-9\.]+)x/;U.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var zd={exports:{}};(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(h,l,u){this.fn=h,this.context=l,this.once=u||!1}function n(h,l,u,c,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,c||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,c;if(this._eventsCount===0)return l;for(c in u=this._events)t.call(u,c)&&l.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=e?e+l:l,c=this._events[u];if(!c)return[];if(c.fn)return[c.fn];for(var d=0,f=c.length,p=new Array(f);d<f;d++)p[d]=c[d].fn;return p},a.prototype.listenerCount=function(l){var u=e?e+l:l,c=this._events[u];return c?c.fn?1:c.length:0},a.prototype.emit=function(l,u,c,d,f,p){var m=e?e+l:l;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,v,_;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,c),!0;case 4:return g.fn.call(g.context,u,c,d),!0;case 5:return g.fn.call(g.context,u,c,d,f),!0;case 6:return g.fn.call(g.context,u,c,d,f,p),!0}for(_=1,v=new Array(y-1);_<y;_++)v[_-1]=arguments[_];g.fn.apply(g.context,v)}else{var x=g.length,b;for(_=0;_<x;_++)switch(g[_].once&&this.removeListener(l,g[_].fn,void 0,!0),y){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,u);break;case 3:g[_].fn.call(g[_].context,u,c);break;case 4:g[_].fn.call(g[_].context,u,c,d);break;default:if(!v)for(b=1,v=new Array(y-1);b<y;b++)v[b-1]=arguments[b];g[_].fn.apply(g[_].context,v)}}return!0},a.prototype.on=function(l,u,c){return n(this,l,u,c,!1)},a.prototype.once=function(l,u,c){return n(this,l,u,c,!0)},a.prototype.removeListener=function(l,u,c,d){var f=e?e+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!d||p.once)&&(!c||p.context===c)&&o(this,f);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==u||d&&!p[m].once||c&&p[m].context!==c)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=e?e+l:l,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,r.exports=a})(zd);var Yg=zd.exports;const vr=Cl(Yg);var Pl={exports:{}};Pl.exports=ia;Pl.exports.default=ia;function ia(r,t,e){e=e||2;var i=t&&t.length,s=i?t[0]*e:r.length,n=Hd(r,0,s,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,u,c,d,f;if(i&&(n=Jg(r,t,n,e)),r.length>80*e){a=l=r[0],h=u=r[1];for(var p=e;p<s;p+=e)c=r[p],d=r[p+1],c<a&&(a=c),d<h&&(h=d),c>l&&(l=c),d>u&&(u=d);f=Math.max(l-a,u-h),f=f!==0?32767/f:0}return Xs(n,o,e,a,h,f,0),o}function Hd(r,t,e,i,s){var n,o;if(s===mh(r,t,e,i)>0)for(n=t;n<e;n+=i)o=Ku(n,r[n],r[n+1],o);else for(n=e-i;n>=t;n-=i)o=Ku(n,r[n],r[n+1],o);return o&&ra(o,o.next)&&(js(o),o=o.next),o}function mr(r,t){if(!r)return r;t||(t=r);var e=r,i;do if(i=!1,!e.steiner&&(ra(e,e.next)||gt(e.prev,e,e.next)===0)){if(js(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function Xs(r,t,e,i,s,n,o){if(r){!o&&n&&s_(r,i,s,n);for(var a=r,h,l;r.prev!==r.next;){if(h=r.prev,l=r.next,n?Kg(r,i,s,n):qg(r)){t.push(h.i/e|0),t.push(r.i/e|0),t.push(l.i/e|0),js(r),r=l.next,a=l.next;continue}if(r=l,r===a){o?o===1?(r=Zg(mr(r),t,e),Xs(r,t,e,i,s,n,2)):o===2&&Qg(r,t,e,i,s,n):Xs(mr(r),t,e,i,s,n,1);break}}}}function qg(r){var t=r.prev,e=r,i=r.next;if(gt(t,e,i)>=0)return!1;for(var s=t.x,n=e.x,o=i.x,a=t.y,h=e.y,l=i.y,u=s<n?s<o?s:o:n<o?n:o,c=a<h?a<l?a:l:h<l?h:l,d=s>n?s>o?s:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,p=i.next;p!==t;){if(p.x>=u&&p.x<=d&&p.y>=c&&p.y<=f&&kr(s,a,n,h,o,l,p.x,p.y)&&gt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Kg(r,t,e,i){var s=r.prev,n=r,o=r.next;if(gt(s,n,o)>=0)return!1;for(var a=s.x,h=n.x,l=o.x,u=s.y,c=n.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,p=u<c?u<d?u:d:c<d?c:d,m=a>h?a>l?a:l:h>l?h:l,g=u>c?u>d?u:d:c>d?c:d,y=fh(f,p,t,e,i),v=fh(m,g,t,e,i),_=r.prevZ,x=r.nextZ;_&&_.z>=y&&x&&x.z<=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==s&&_!==o&&kr(a,u,h,c,l,d,_.x,_.y)&&gt(_.prev,_,_.next)>=0||(_=_.prevZ,x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==s&&x!==o&&kr(a,u,h,c,l,d,x.x,x.y)&&gt(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==s&&_!==o&&kr(a,u,h,c,l,d,_.x,_.y)&&gt(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=v;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==s&&x!==o&&kr(a,u,h,c,l,d,x.x,x.y)&&gt(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Zg(r,t,e){var i=r;do{var s=i.prev,n=i.next.next;!ra(s,n)&&$d(s,i,i.next,n)&&Ws(s,n)&&Ws(n,s)&&(t.push(s.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),js(i),js(i.next),i=r=n),i=i.next}while(i!==r);return mr(i)}function Qg(r,t,e,i,s,n){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&a_(o,a)){var h=Vd(o,a);o=mr(o,o.next),h=mr(h,h.next),Xs(o,t,e,i,s,n,0),Xs(h,t,e,i,s,n,0);return}a=a.next}o=o.next}while(o!==r)}function Jg(r,t,e,i){var s=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*i,h=n<o-1?t[n+1]*i:r.length,l=Hd(r,a,h,i,!1),l===l.next&&(l.steiner=!0),s.push(o_(l));for(s.sort(t_),n=0;n<s.length;n++)e=e_(s[n],e);return e}function t_(r,t){return r.x-t.x}function e_(r,t){var e=i_(r,t);if(!e)return t;var i=Vd(e,r);return mr(i,i.next),mr(e,e.next)}function i_(r,t){var e=t,i=r.x,s=r.y,n=-1/0,o;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var a=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,l=o.x,u=o.y,c=1/0,d;e=o;do i>=e.x&&e.x>=l&&i!==e.x&&kr(s<u?i:n,s,l,u,s<u?n:i,s,e.x,e.y)&&(d=Math.abs(s-e.y)/(i-e.x),Ws(e,r)&&(d<c||d===c&&(e.x>o.x||e.x===o.x&&r_(o,e)))&&(o=e,c=d)),e=e.next;while(e!==h);return o}function r_(r,t){return gt(r.prev,r,t.prev)<0&&gt(t.next,r,r.next)<0}function s_(r,t,e,i){var s=r;do s.z===0&&(s.z=fh(s.x,s.y,t,e,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,n_(s)}function n_(r){var t,e,i,s,n,o,a,h,l=1;do{for(e=r,r=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<l&&(a++,i=i.nextZ,!!i);t++);for(h=l;a>0||h>0&&i;)a!==0&&(h===0||!i||e.z<=i.z)?(s=e,e=e.nextZ,a--):(s=i,i=i.nextZ,h--),n?n.nextZ=s:r=s,s.prevZ=n,n=s;e=i}n.nextZ=null,l*=2}while(o>1);return r}function fh(r,t,e,i,s){return r=(r-e)*s|0,t=(t-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function o_(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function kr(r,t,e,i,s,n,o,a){return(s-o)*(t-a)>=(r-o)*(n-a)&&(r-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(s-o)*(i-a)}function a_(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!h_(r,t)&&(Ws(r,t)&&Ws(t,r)&&l_(r,t)&&(gt(r.prev,r,t.prev)||gt(r,t.prev,t))||ra(r,t)&&gt(r.prev,r,r.next)>0&&gt(t.prev,t,t.next)>0)}function gt(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function ra(r,t){return r.x===t.x&&r.y===t.y}function $d(r,t,e,i){var s=Bn(gt(r,t,e)),n=Bn(gt(r,t,i)),o=Bn(gt(e,i,r)),a=Bn(gt(e,i,t));return!!(s!==n&&o!==a||s===0&&Dn(r,e,t)||n===0&&Dn(r,i,t)||o===0&&Dn(e,r,i)||a===0&&Dn(e,t,i))}function Dn(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function Bn(r){return r>0?1:r<0?-1:0}function h_(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&$d(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function Ws(r,t){return gt(r.prev,r,r.next)<0?gt(r,t,r.next)>=0&&gt(r,r.prev,t)>=0:gt(r,t,r.prev)<0||gt(r,r.next,t)<0}function l_(r,t){var e=r,i=!1,s=(r.x+t.x)/2,n=(r.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&s<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function Vd(r,t){var e=new ph(r.i,r.x,r.y),i=new ph(t.i,t.x,t.y),s=r.next,n=t.prev;return r.next=t,t.prev=r,e.next=s,s.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function Ku(r,t,e,i){var s=new ph(r,t,e);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function js(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function ph(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ia.deviation=function(r,t,e,i){var s=t&&t.length,n=s?t[0]*e:r.length,o=Math.abs(mh(r,0,n,e));if(s)for(var a=0,h=t.length;a<h;a++){var l=t[a]*e,u=a<h-1?t[a+1]*e:r.length;o-=Math.abs(mh(r,l,u,e))}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,p=i[a+2]*e;c+=Math.abs((r[d]-r[p])*(r[f+1]-r[d+1])-(r[d]-r[f])*(r[p+1]-r[d+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)};function mh(r,t,e,i){for(var s=0,n=t,o=e-i;n<e;n+=i)s+=(r[o]-r[n])*(r[n+1]+r[o+1]),o=n;return s}ia.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,s=0;s<r.length;s++){for(var n=0;n<r[s].length;n++)for(var o=0;o<t;o++)e.vertices.push(r[s][n][o]);s>0&&(i+=r[s-1].length,e.holes.push(i))}return e};var u_=Pl.exports;const Xd=Cl(u_);var So={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */So.exports;(function(r,t){(function(e){var i=t&&!t.nodeType&&t,s=r&&!r.nodeType&&r,n=typeof zr=="object"&&zr;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,h=36,l=1,u=26,c=38,d=700,f=72,p=128,m="-",g=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=h-l,b=Math.floor,C=String.fromCharCode,w;function T(M){throw new RangeError(_[M])}function A(M,O){for(var Q=M.length,nt=[];Q--;)nt[Q]=O(M[Q]);return nt}function I(M,O){var Q=M.split("@"),nt="";Q.length>1&&(nt=Q[0]+"@",M=Q[1]),M=M.replace(v,".");var J=M.split("."),at=A(J,O).join(".");return nt+at}function z(M){for(var O=[],Q=0,nt=M.length,J,at;Q<nt;)J=M.charCodeAt(Q++),J>=55296&&J<=56319&&Q<nt?(at=M.charCodeAt(Q++),(at&64512)==56320?O.push(((J&1023)<<10)+(at&1023)+65536):(O.push(J),Q--)):O.push(J);return O}function R(M){return A(M,function(O){var Q="";return O>65535&&(O-=65536,Q+=C(O>>>10&1023|55296),O=56320|O&1023),Q+=C(O),Q}).join("")}function S(M){return M-48<10?M-22:M-65<26?M-65:M-97<26?M-97:h}function P(M,O){return M+22+75*(M<26)-((O!=0)<<5)}function D(M,O,Q){var nt=0;for(M=Q?b(M/d):M>>1,M+=b(M/O);M>x*u>>1;nt+=h)M=b(M/x);return b(nt+(x+1)*M/(M+c))}function H(M){var O=[],Q=M.length,nt,J=0,at=p,St=f,Mt,Ut,Jt,Nt,dt,At,Pt,Ne,Ue;for(Mt=M.lastIndexOf(m),Mt<0&&(Mt=0),Ut=0;Ut<Mt;++Ut)M.charCodeAt(Ut)>=128&&T("not-basic"),O.push(M.charCodeAt(Ut));for(Jt=Mt>0?Mt+1:0;Jt<Q;){for(Nt=J,dt=1,At=h;Jt>=Q&&T("invalid-input"),Pt=S(M.charCodeAt(Jt++)),(Pt>=h||Pt>b((a-J)/dt))&&T("overflow"),J+=Pt*dt,Ne=At<=St?l:At>=St+u?u:At-St,!(Pt<Ne);At+=h)Ue=h-Ne,dt>b(a/Ue)&&T("overflow"),dt*=Ue;nt=O.length+1,St=D(J-Nt,nt,Nt==0),b(J/nt)>a-at&&T("overflow"),at+=b(J/nt),J%=nt,O.splice(J++,0,at)}return R(O)}function E(M){var O,Q,nt,J,at,St,Mt,Ut,Jt,Nt,dt,At=[],Pt,Ne,Ue,gs;for(M=z(M),Pt=M.length,O=p,Q=0,at=f,St=0;St<Pt;++St)dt=M[St],dt<128&&At.push(C(dt));for(nt=J=At.length,J&&At.push(m);nt<Pt;){for(Mt=a,St=0;St<Pt;++St)dt=M[St],dt>=O&&dt<Mt&&(Mt=dt);for(Ne=nt+1,Mt-O>b((a-Q)/Ne)&&T("overflow"),Q+=(Mt-O)*Ne,O=Mt,St=0;St<Pt;++St)if(dt=M[St],dt<O&&++Q>a&&T("overflow"),dt==O){for(Ut=Q,Jt=h;Nt=Jt<=at?l:Jt>=at+u?u:Jt-at,!(Ut<Nt);Jt+=h)gs=Ut-Nt,Ue=h-Nt,At.push(C(P(Nt+gs%Ue,0))),Ut=b(gs/Ue);At.push(C(P(Ut,0))),at=D(Q,Ne,nt==J),Q=0,++nt}++Q,++O}return At.join("")}function B(M){return I(M,function(O){return g.test(O)?H(O.slice(4).toLowerCase()):O})}function q(M){return I(M,function(O){return y.test(O)?"xn--"+E(O):O})}if(o={version:"1.4.1",ucs2:{decode:z,encode:R},decode:H,encode:E,toASCII:q,toUnicode:B},i&&s)if(r.exports==i)s.exports=o;else for(w in o)o.hasOwnProperty(w)&&(i[w]=o[w]);else e.punycode=o})(zr)})(So,So.exports);var c_=So.exports,d_=Error,f_=EvalError,p_=RangeError,m_=ReferenceError,Wd=SyntaxError,yn=TypeError,g_=URIError,__=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;t[e]=s;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==s||o.enumerable!==!0)return!1}return!0},Zu=typeof Symbol<"u"&&Symbol,y_=__,v_=function(){return typeof Zu!="function"||typeof Symbol!="function"||typeof Zu("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:y_()},ba={__proto__:null,foo:{}},x_=Object,b_=function(){return{__proto__:ba}.foo===ba.foo&&!(ba instanceof x_)},T_="Function.prototype.bind called on incompatible ",w_=Object.prototype.toString,S_=Math.max,A_="[object Function]",Qu=function(t,e){for(var i=[],s=0;s<t.length;s+=1)i[s]=t[s];for(var n=0;n<e.length;n+=1)i[n+t.length]=e[n];return i},C_=function(t,e){for(var i=[],s=e||0,n=0;s<t.length;s+=1,n+=1)i[n]=t[s];return i},E_=function(r,t){for(var e="",i=0;i<r.length;i+=1)e+=r[i],i+1<r.length&&(e+=t);return e},P_=function(t){var e=this;if(typeof e!="function"||w_.apply(e)!==A_)throw new TypeError(T_+e);for(var i=C_(arguments,1),s,n=function(){if(this instanceof s){var u=e.apply(this,Qu(i,arguments));return Object(u)===u?u:this}return e.apply(t,Qu(i,arguments))},o=S_(0,e.length-i.length),a=[],h=0;h<o;h++)a[h]="$"+h;if(s=Function("binder","return function ("+E_(a,",")+"){ return binder.apply(this,arguments); }")(n),e.prototype){var l=function(){};l.prototype=e.prototype,s.prototype=new l,l.prototype=null}return s},R_=P_,Rl=Function.prototype.bind||R_,I_=Function.prototype.call,M_=Object.prototype.hasOwnProperty,F_=Rl,D_=F_.call(I_,M_),et,B_=d_,O_=f_,L_=p_,k_=m_,Qr=Wd,Vr=yn,N_=g_,jd=Function,Ta=function(r){try{return jd('"use strict"; return ('+r+").constructor;")()}catch{}},or=Object.getOwnPropertyDescriptor;if(or)try{or({},"")}catch{or=null}var wa=function(){throw new Vr},U_=or?function(){try{return arguments.callee,wa}catch{try{return or(arguments,"callee").get}catch{return wa}}}():wa,Sr=v_(),G_=b_(),Dt=Object.getPrototypeOf||(G_?function(r){return r.__proto__}:null),Ir={},z_=typeof Uint8Array>"u"||!Dt?et:Dt(Uint8Array),ar={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?et:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?et:ArrayBuffer,"%ArrayIteratorPrototype%":Sr&&Dt?Dt([][Symbol.iterator]()):et,"%AsyncFromSyncIteratorPrototype%":et,"%AsyncFunction%":Ir,"%AsyncGenerator%":Ir,"%AsyncGeneratorFunction%":Ir,"%AsyncIteratorPrototype%":Ir,"%Atomics%":typeof Atomics>"u"?et:Atomics,"%BigInt%":typeof BigInt>"u"?et:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?et:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?et:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?et:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":B_,"%eval%":eval,"%EvalError%":O_,"%Float32Array%":typeof Float32Array>"u"?et:Float32Array,"%Float64Array%":typeof Float64Array>"u"?et:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?et:FinalizationRegistry,"%Function%":jd,"%GeneratorFunction%":Ir,"%Int8Array%":typeof Int8Array>"u"?et:Int8Array,"%Int16Array%":typeof Int16Array>"u"?et:Int16Array,"%Int32Array%":typeof Int32Array>"u"?et:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Sr&&Dt?Dt(Dt([][Symbol.iterator]())):et,"%JSON%":typeof JSON=="object"?JSON:et,"%Map%":typeof Map>"u"?et:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Sr||!Dt?et:Dt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?et:Promise,"%Proxy%":typeof Proxy>"u"?et:Proxy,"%RangeError%":L_,"%ReferenceError%":k_,"%Reflect%":typeof Reflect>"u"?et:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?et:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Sr||!Dt?et:Dt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?et:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Sr&&Dt?Dt(""[Symbol.iterator]()):et,"%Symbol%":Sr?Symbol:et,"%SyntaxError%":Qr,"%ThrowTypeError%":U_,"%TypedArray%":z_,"%TypeError%":Vr,"%Uint8Array%":typeof Uint8Array>"u"?et:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?et:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?et:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?et:Uint32Array,"%URIError%":N_,"%WeakMap%":typeof WeakMap>"u"?et:WeakMap,"%WeakRef%":typeof WeakRef>"u"?et:WeakRef,"%WeakSet%":typeof WeakSet>"u"?et:WeakSet};if(Dt)try{null.error}catch(r){var H_=Dt(Dt(r));ar["%Error.prototype%"]=H_}var $_=function r(t){var e;if(t==="%AsyncFunction%")e=Ta("async function () {}");else if(t==="%GeneratorFunction%")e=Ta("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Ta("async function* () {}");else if(t==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(e=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&Dt&&(e=Dt(s.prototype))}return ar[t]=e,e},Ju={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},vn=Rl,Ao=D_,V_=vn.call(Function.call,Array.prototype.concat),X_=vn.call(Function.apply,Array.prototype.splice),tc=vn.call(Function.call,String.prototype.replace),Co=vn.call(Function.call,String.prototype.slice),W_=vn.call(Function.call,RegExp.prototype.exec),j_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Y_=/\\(\\)?/g,q_=function(t){var e=Co(t,0,1),i=Co(t,-1);if(e==="%"&&i!=="%")throw new Qr("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&e!=="%")throw new Qr("invalid intrinsic syntax, expected opening `%`");var s=[];return tc(t,j_,function(n,o,a,h){s[s.length]=a?tc(h,Y_,"$1"):o||n}),s},K_=function(t,e){var i=t,s;if(Ao(Ju,i)&&(s=Ju[i],i="%"+s[0]+"%"),Ao(ar,i)){var n=ar[i];if(n===Ir&&(n=$_(i)),typeof n>"u"&&!e)throw new Vr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:s,name:i,value:n}}throw new Qr("intrinsic "+t+" does not exist!")},us=function(t,e){if(typeof t!="string"||t.length===0)throw new Vr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new Vr('"allowMissing" argument must be a boolean');if(W_(/^%?[^%]*%?$/,t)===null)throw new Qr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=q_(t),s=i.length>0?i[0]:"",n=K_("%"+s+"%",e),o=n.name,a=n.value,h=!1,l=n.alias;l&&(s=l[0],X_(i,V_([0,1],l)));for(var u=1,c=!0;u<i.length;u+=1){var d=i[u],f=Co(d,0,1),p=Co(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new Qr("property names with quotes must have matching quotes");if((d==="constructor"||!c)&&(h=!0),s+="."+d,o="%"+s+"%",Ao(ar,o))a=ar[o];else if(a!=null){if(!(d in a)){if(!e)throw new Vr("base intrinsic for "+t+" exists, but the property is not available.");return}if(or&&u+1>=i.length){var m=or(a,d);c=!!m,c&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else c=Ao(a,d),a=a[d];c&&!h&&(ar[o]=a)}}return a},Yd={exports:{}},Sa,ec;function Il(){if(ec)return Sa;ec=1;var r=us,t=r("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return Sa=t,Sa}var Z_=us,no=Z_("%Object.getOwnPropertyDescriptor%",!0);if(no)try{no([],"length")}catch{no=null}var qd=no,ic=Il(),Q_=Wd,Ar=yn,rc=qd,J_=function(t,e,i){if(!t||typeof t!="object"&&typeof t!="function")throw new Ar("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new Ar("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Ar("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Ar("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Ar("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Ar("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,h=!!rc&&rc(t,e);if(ic)ic(t,e,{configurable:o===null&&h?h.configurable:!o,enumerable:s===null&&h?h.enumerable:!s,value:i,writable:n===null&&h?h.writable:!n});else if(a||!s&&!n&&!o)t[e]=i;else throw new Q_("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},gh=Il(),Kd=function(){return!!gh};Kd.hasArrayLengthDefineBug=function(){if(!gh)return null;try{return gh([],"length",{value:1}).length!==1}catch{return!0}};var t0=Kd,e0=us,sc=J_,i0=t0(),nc=qd,oc=yn,r0=e0("%Math.floor%"),s0=function(t,e){if(typeof t!="function")throw new oc("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||r0(e)!==e)throw new oc("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],s=!0,n=!0;if("length"in t&&nc){var o=nc(t,"length");o&&!o.configurable&&(s=!1),o&&!o.writable&&(n=!1)}return(s||n||!i)&&(i0?sc(t,"length",e,!0,!0):sc(t,"length",e)),t};(function(r){var t=Rl,e=us,i=s0,s=yn,n=e("%Function.prototype.apply%"),o=e("%Function.prototype.call%"),a=e("%Reflect.apply%",!0)||t.call(o,n),h=Il(),l=e("%Math.max%");r.exports=function(d){if(typeof d!="function")throw new s("a function is required");var f=a(t,o,arguments);return i(f,1+l(0,d.length-(arguments.length-1)),!0)};var u=function(){return a(t,n,arguments)};h?h(r.exports,"apply",{value:u}):r.exports.apply=u})(Yd);var n0=Yd.exports,Zd=us,Qd=n0,o0=Qd(Zd("String.prototype.indexOf")),a0=function(t,e){var i=Zd(t,!!e);return typeof i=="function"&&o0(t,".prototype.")>-1?Qd(i):i};const h0={},l0=Object.freeze(Object.defineProperty({__proto__:null,default:h0},Symbol.toStringTag,{value:"Module"})),u0=Hg(l0);var Ml=typeof Map=="function"&&Map.prototype,Aa=Object.getOwnPropertyDescriptor&&Ml?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Eo=Ml&&Aa&&typeof Aa.get=="function"?Aa.get:null,ac=Ml&&Map.prototype.forEach,Fl=typeof Set=="function"&&Set.prototype,Ca=Object.getOwnPropertyDescriptor&&Fl?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Po=Fl&&Ca&&typeof Ca.get=="function"?Ca.get:null,hc=Fl&&Set.prototype.forEach,c0=typeof WeakMap=="function"&&WeakMap.prototype,Ls=c0?WeakMap.prototype.has:null,d0=typeof WeakSet=="function"&&WeakSet.prototype,ks=d0?WeakSet.prototype.has:null,f0=typeof WeakRef=="function"&&WeakRef.prototype,lc=f0?WeakRef.prototype.deref:null,p0=Boolean.prototype.valueOf,m0=Object.prototype.toString,g0=Function.prototype.toString,_0=String.prototype.match,Dl=String.prototype.slice,Ei=String.prototype.replace,y0=String.prototype.toUpperCase,uc=String.prototype.toLowerCase,Jd=RegExp.prototype.test,cc=Array.prototype.concat,qe=Array.prototype.join,v0=Array.prototype.slice,dc=Math.floor,_h=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ea=Object.getOwnPropertySymbols,yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Jr=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Xt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Jr||"symbol")?Symbol.toStringTag:null,tf=Object.prototype.propertyIsEnumerable,fc=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function pc(r,t){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||Jd.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-dc(-r):dc(r);if(i!==r){var s=String(i),n=Dl.call(t,s.length+1);return Ei.call(s,e,"$&_")+"."+Ei.call(Ei.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ei.call(t,e,"$&_")}var vh=u0,mc=vh.custom,gc=rf(mc)?mc:null,x0=function r(t,e,i,s){var n=e||{};if(bi(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(bi(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=bi(n,"customInspect")?n.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(bi(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(bi(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return nf(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var h=String(t);return a?pc(t,h):h}if(typeof t=="bigint"){var l=String(t)+"n";return a?pc(t,l):l}var u=typeof n.depth>"u"?5:n.depth;if(typeof i>"u"&&(i=0),i>=u&&u>0&&typeof t=="object")return xh(t)?"[Array]":"[Object]";var c=N0(n,i);if(typeof s>"u")s=[];else if(sf(s,t)>=0)return"[Circular]";function d(S,P,D){if(P&&(s=v0.call(s),s.push(P)),D){var H={depth:n.depth};return bi(n,"quoteStyle")&&(H.quoteStyle=n.quoteStyle),r(S,H,i+1,s)}return r(S,n,i+1,s)}if(typeof t=="function"&&!_c(t)){var f=R0(t),p=On(t,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+qe.call(p,", ")+" }":"")}if(rf(t)){var m=Jr?Ei.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):yh.call(t);return typeof t=="object"&&!Jr?_s(m):m}if(O0(t)){for(var g="<"+uc.call(String(t.nodeName)),y=t.attributes||[],v=0;v<y.length;v++)g+=" "+y[v].name+"="+ef(b0(y[v].value),"double",n);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+uc.call(String(t.nodeName))+">",g}if(xh(t)){if(t.length===0)return"[]";var _=On(t,d);return c&&!k0(_)?"["+bh(_,c)+"]":"[ "+qe.call(_,", ")+" ]"}if(w0(t)){var x=On(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!tf.call(t,"cause")?"{ ["+String(t)+"] "+qe.call(cc.call("[cause]: "+d(t.cause),x),", ")+" }":x.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+qe.call(x,", ")+" }"}if(typeof t=="object"&&o){if(gc&&typeof t[gc]=="function"&&vh)return vh(t,{depth:u-i});if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(I0(t)){var b=[];return ac&&ac.call(t,function(S,P){b.push(d(P,t,!0)+" => "+d(S,t))}),yc("Map",Eo.call(t),b,c)}if(D0(t)){var C=[];return hc&&hc.call(t,function(S){C.push(d(S,t))}),yc("Set",Po.call(t),C,c)}if(M0(t))return Pa("WeakMap");if(B0(t))return Pa("WeakSet");if(F0(t))return Pa("WeakRef");if(A0(t))return _s(d(Number(t)));if(E0(t))return _s(d(_h.call(t)));if(C0(t))return _s(p0.call(t));if(S0(t))return _s(d(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof zr<"u"&&t===zr)return"{ [object globalThis] }";if(!T0(t)&&!_c(t)){var w=On(t,d),T=fc?fc(t)===Object.prototype:t instanceof Object||t.constructor===Object,A=t instanceof Object?"":"null prototype",I=!T&&Xt&&Object(t)===t&&Xt in t?Dl.call(Hi(t),8,-1):A?"Object":"",z=T||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",R=z+(I||A?"["+qe.call(cc.call([],I||[],A||[]),": ")+"] ":"");return w.length===0?R+"{}":c?R+"{"+bh(w,c)+"}":R+"{ "+qe.call(w,", ")+" }"}return String(t)};function ef(r,t,e){var i=(e.quoteStyle||t)==="double"?'"':"'";return i+r+i}function b0(r){return Ei.call(String(r),/"/g,"&quot;")}function xh(r){return Hi(r)==="[object Array]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function T0(r){return Hi(r)==="[object Date]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function _c(r){return Hi(r)==="[object RegExp]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function w0(r){return Hi(r)==="[object Error]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function S0(r){return Hi(r)==="[object String]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function A0(r){return Hi(r)==="[object Number]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function C0(r){return Hi(r)==="[object Boolean]"&&(!Xt||!(typeof r=="object"&&Xt in r))}function rf(r){if(Jr)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!yh)return!1;try{return yh.call(r),!0}catch{}return!1}function E0(r){if(!r||typeof r!="object"||!_h)return!1;try{return _h.call(r),!0}catch{}return!1}var P0=Object.prototype.hasOwnProperty||function(r){return r in this};function bi(r,t){return P0.call(r,t)}function Hi(r){return m0.call(r)}function R0(r){if(r.name)return r.name;var t=_0.call(g0.call(r),/^function\s*([\w$]+)/);return t?t[1]:null}function sf(r,t){if(r.indexOf)return r.indexOf(t);for(var e=0,i=r.length;e<i;e++)if(r[e]===t)return e;return-1}function I0(r){if(!Eo||!r||typeof r!="object")return!1;try{Eo.call(r);try{Po.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function M0(r){if(!Ls||!r||typeof r!="object")return!1;try{Ls.call(r,Ls);try{ks.call(r,ks)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function F0(r){if(!lc||!r||typeof r!="object")return!1;try{return lc.call(r),!0}catch{}return!1}function D0(r){if(!Po||!r||typeof r!="object")return!1;try{Po.call(r);try{Eo.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function B0(r){if(!ks||!r||typeof r!="object")return!1;try{ks.call(r,ks);try{Ls.call(r,Ls)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function O0(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function nf(r,t){if(r.length>t.maxStringLength){var e=r.length-t.maxStringLength,i="... "+e+" more character"+(e>1?"s":"");return nf(Dl.call(r,0,t.maxStringLength),t)+i}var s=Ei.call(Ei.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,L0);return ef(s,"single",t)}function L0(r){var t=r.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+y0.call(t.toString(16))}function _s(r){return"Object("+r+")"}function Pa(r){return r+" { ? }"}function yc(r,t,e,i){var s=i?bh(e,i):qe.call(e,", ");return r+" ("+t+") {"+s+"}"}function k0(r){for(var t=0;t<r.length;t++)if(sf(r[t],`
`)>=0)return!1;return!0}function N0(r,t){var e;if(r.indent==="	")e="	";else if(typeof r.indent=="number"&&r.indent>0)e=qe.call(Array(r.indent+1)," ");else return null;return{base:e,prev:qe.call(Array(t+1),e)}}function bh(r,t){if(r.length===0)return"";var e=`
`+t.prev+t.base;return e+qe.call(r,","+e)+`
`+t.prev}function On(r,t){var e=xh(r),i=[];if(e){i.length=r.length;for(var s=0;s<r.length;s++)i[s]=bi(r,s)?t(r[s],r):""}var n=typeof Ea=="function"?Ea(r):[],o;if(Jr){o={};for(var a=0;a<n.length;a++)o["$"+n[a]]=n[a]}for(var h in r)bi(r,h)&&(e&&String(Number(h))===h&&h<r.length||Jr&&o["$"+h]instanceof Symbol||(Jd.call(/[^\w$]/,h)?i.push(t(h,r)+": "+t(r[h],r)):i.push(h+": "+t(r[h],r))));if(typeof Ea=="function")for(var l=0;l<n.length;l++)tf.call(r,n[l])&&i.push("["+t(n[l])+"]: "+t(r[n[l]],r));return i}var of=us,cs=a0,U0=x0,G0=yn,Ln=of("%WeakMap%",!0),kn=of("%Map%",!0),z0=cs("WeakMap.prototype.get",!0),H0=cs("WeakMap.prototype.set",!0),$0=cs("WeakMap.prototype.has",!0),V0=cs("Map.prototype.get",!0),X0=cs("Map.prototype.set",!0),W0=cs("Map.prototype.has",!0),Bl=function(r,t){for(var e=r,i;(i=e.next)!==null;e=i)if(i.key===t)return e.next=i.next,i.next=r.next,r.next=i,i},j0=function(r,t){var e=Bl(r,t);return e&&e.value},Y0=function(r,t,e){var i=Bl(r,t);i?i.value=e:r.next={key:t,next:r.next,value:e}},q0=function(r,t){return!!Bl(r,t)},K0=function(){var t,e,i,s={assert:function(n){if(!s.has(n))throw new G0("Side channel does not contain "+U0(n))},get:function(n){if(Ln&&n&&(typeof n=="object"||typeof n=="function")){if(t)return z0(t,n)}else if(kn){if(e)return V0(e,n)}else if(i)return j0(i,n)},has:function(n){if(Ln&&n&&(typeof n=="object"||typeof n=="function")){if(t)return $0(t,n)}else if(kn){if(e)return W0(e,n)}else if(i)return q0(i,n);return!1},set:function(n,o){Ln&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new Ln),H0(t,n,o)):kn?(e||(e=new kn),X0(e,n,o)):(i||(i={key:{},next:null}),Y0(i,n,o))}};return s},Z0=String.prototype.replace,Q0=/%20/g,Ra={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ol={default:Ra.RFC3986,formatters:{RFC1738:function(r){return Z0.call(r,Q0,"+")},RFC3986:function(r){return String(r)}},RFC1738:Ra.RFC1738,RFC3986:Ra.RFC3986},J0=Ol,Ia=Object.prototype.hasOwnProperty,tr=Array.isArray,Ge=function(){for(var r=[],t=0;t<256;++t)r.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return r}(),ty=function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(tr(i)){for(var s=[],n=0;n<i.length;++n)typeof i[n]<"u"&&s.push(i[n]);e.obj[e.prop]=s}}},af=function(t,e){for(var i=e&&e.plainObjects?Object.create(null):{},s=0;s<t.length;++s)typeof t[s]<"u"&&(i[s]=t[s]);return i},ey=function r(t,e,i){if(!e)return t;if(typeof e!="object"){if(tr(t))t.push(e);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!Ia.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var s=t;return tr(t)&&!tr(e)&&(s=af(t,i)),tr(t)&&tr(e)?(e.forEach(function(n,o){if(Ia.call(t,o)){var a=t[o];a&&typeof a=="object"&&n&&typeof n=="object"?t[o]=r(a,n,i):t.push(n)}else t[o]=n}),t):Object.keys(e).reduce(function(n,o){var a=e[o];return Ia.call(n,o)?n[o]=r(n[o],a,i):n[o]=a,n},s)},iy=function(t,e){return Object.keys(e).reduce(function(i,s){return i[s]=e[s],i},t)},ry=function(r,t,e){var i=r.replace(/\+/g," ");if(e==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},Ma=1024,sy=function(t,e,i,s,n){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(f){return"%26%23"+parseInt(f.slice(2),16)+"%3B"});for(var a="",h=0;h<o.length;h+=Ma){for(var l=o.length>=Ma?o.slice(h,h+Ma):o,u=[],c=0;c<l.length;++c){var d=l.charCodeAt(c);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||n===J0.RFC1738&&(d===40||d===41)){u[u.length]=l.charAt(c);continue}if(d<128){u[u.length]=Ge[d];continue}if(d<2048){u[u.length]=Ge[192|d>>6]+Ge[128|d&63];continue}if(d<55296||d>=57344){u[u.length]=Ge[224|d>>12]+Ge[128|d>>6&63]+Ge[128|d&63];continue}c+=1,d=65536+((d&1023)<<10|l.charCodeAt(c)&1023),u[u.length]=Ge[240|d>>18]+Ge[128|d>>12&63]+Ge[128|d>>6&63]+Ge[128|d&63]}a+=u.join("")}return a},ny=function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],s=0;s<e.length;++s)for(var n=e[s],o=n.obj[n.prop],a=Object.keys(o),h=0;h<a.length;++h){var l=a[h],u=o[l];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(e.push({obj:o,prop:l}),i.push(u))}return ty(e),t},oy=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},ay=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},hy=function(t,e){return[].concat(t,e)},ly=function(t,e){if(tr(t)){for(var i=[],s=0;s<t.length;s+=1)i.push(e(t[s]));return i}return e(t)},hf={arrayToObject:af,assign:iy,combine:hy,compact:ny,decode:ry,encode:sy,isBuffer:ay,isRegExp:oy,maybeMap:ly,merge:ey},lf=K0,oo=hf,Ns=Ol,uy=Object.prototype.hasOwnProperty,uf={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},je=Array.isArray,cy=Array.prototype.push,cf=function(r,t){cy.apply(r,je(t)?t:[t])},dy=Date.prototype.toISOString,vc=Ns.default,Rt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:oo.encode,encodeValuesOnly:!1,format:vc,formatter:Ns.formatters[vc],indices:!1,serializeDate:function(t){return dy.call(t)},skipNulls:!1,strictNullHandling:!1},fy=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Fa={},py=function r(t,e,i,s,n,o,a,h,l,u,c,d,f,p,m,g,y,v){for(var _=t,x=v,b=0,C=!1;(x=x.get(Fa))!==void 0&&!C;){var w=x.get(t);if(b+=1,typeof w<"u"){if(w===b)throw new RangeError("Cyclic object value");C=!0}typeof x.get(Fa)>"u"&&(b=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f(_):i==="comma"&&je(_)&&(_=oo.maybeMap(_,function(M){return M instanceof Date?f(M):M})),_===null){if(o)return l&&!g?l(e,Rt.encoder,y,"key",p):e;_=""}if(fy(_)||oo.isBuffer(_)){if(l){var T=g?e:l(e,Rt.encoder,y,"key",p);return[m(T)+"="+m(l(_,Rt.encoder,y,"value",p))]}return[m(e)+"="+m(String(_))]}var A=[];if(typeof _>"u")return A;var I;if(i==="comma"&&je(_))g&&l&&(_=oo.maybeMap(_,l)),I=[{value:_.length>0?_.join(",")||null:void 0}];else if(je(u))I=u;else{var z=Object.keys(_);I=c?z.sort(c):z}var R=h?e.replace(/\./g,"%2E"):e,S=s&&je(_)&&_.length===1?R+"[]":R;if(n&&je(_)&&_.length===0)return S+"[]";for(var P=0;P<I.length;++P){var D=I[P],H=typeof D=="object"&&typeof D.value<"u"?D.value:_[D];if(!(a&&H===null)){var E=d&&h?D.replace(/\./g,"%2E"):D,B=je(_)?typeof i=="function"?i(S,E):S:S+(d?"."+E:"["+E+"]");v.set(t,b);var q=lf();q.set(Fa,v),cf(A,r(H,B,i,s,n,o,a,h,i==="comma"&&g&&je(_)?null:l,u,c,d,f,p,m,g,y,q))}}return A},my=function(t){if(!t)return Rt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||Rt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Ns.default;if(typeof t.format<"u"){if(!uy.call(Ns.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var s=Ns.formatters[i],n=Rt.filter;(typeof t.filter=="function"||je(t.filter))&&(n=t.filter);var o;if(t.arrayFormat in uf?o=t.arrayFormat:"indices"in t?o=t.indices?"indices":"repeat":o=Rt.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=typeof t.allowDots>"u"?t.encodeDotInKeys===!0?!0:Rt.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Rt.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Rt.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Rt.charsetSentinel,commaRoundTrip:t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Rt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Rt.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Rt.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Rt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Rt.encodeValuesOnly,filter:n,format:i,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Rt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Rt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Rt.strictNullHandling}},gy=function(r,t){var e=r,i=my(t),s,n;typeof i.filter=="function"?(n=i.filter,e=n("",e)):je(i.filter)&&(n=i.filter,s=n);var o=[];if(typeof e!="object"||e===null)return"";var a=uf[i.arrayFormat],h=a==="comma"&&i.commaRoundTrip;s||(s=Object.keys(e)),i.sort&&s.sort(i.sort);for(var l=lf(),u=0;u<s.length;++u){var c=s[u];i.skipNulls&&e[c]===null||cf(o,py(e[c],c,a,h,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,l))}var d=o.join(i.delimiter),f=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""},ts=hf,Th=Object.prototype.hasOwnProperty,_y=Array.isArray,xt={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:ts.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},yy=function(r){return r.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},df=function(r,t){return r&&typeof r=="string"&&t.comma&&r.indexOf(",")>-1?r.split(","):r},vy="utf8=%26%2310003%3B",xy="utf8=%E2%9C%93",by=function(t,e){var i={__proto__:null},s=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;s=s.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var n=e.parameterLimit===1/0?void 0:e.parameterLimit,o=s.split(e.delimiter,n),a=-1,h,l=e.charset;if(e.charsetSentinel)for(h=0;h<o.length;++h)o[h].indexOf("utf8=")===0&&(o[h]===xy?l="utf-8":o[h]===vy&&(l="iso-8859-1"),a=h,h=o.length);for(h=0;h<o.length;++h)if(h!==a){var u=o[h],c=u.indexOf("]="),d=c===-1?u.indexOf("="):c+1,f,p;d===-1?(f=e.decoder(u,xt.decoder,l,"key"),p=e.strictNullHandling?null:""):(f=e.decoder(u.slice(0,d),xt.decoder,l,"key"),p=ts.maybeMap(df(u.slice(d+1),e),function(g){return e.decoder(g,xt.decoder,l,"value")})),p&&e.interpretNumericEntities&&l==="iso-8859-1"&&(p=yy(p)),u.indexOf("[]=")>-1&&(p=_y(p)?[p]:p);var m=Th.call(i,f);m&&e.duplicates==="combine"?i[f]=ts.combine(i[f],p):(!m||e.duplicates==="last")&&(i[f]=p)}return i},Ty=function(r,t,e,i){for(var s=i?t:df(t,e),n=r.length-1;n>=0;--n){var o,a=r[n];if(a==="[]"&&e.parseArrays)o=e.allowEmptyArrays&&s===""?[]:[].concat(s);else{o=e.plainObjects?Object.create(null):{};var h=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,l=e.decodeDotInKeys?h.replace(/%2E/g,"."):h,u=parseInt(l,10);!e.parseArrays&&l===""?o={0:s}:!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&e.parseArrays&&u<=e.arrayLimit?(o=[],o[u]=s):l!=="__proto__"&&(o[l]=s)}s=o}return s},wy=function(t,e,i,s){if(t){var n=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,h=i.depth>0&&o.exec(n),l=h?n.slice(0,h.index):n,u=[];if(l){if(!i.plainObjects&&Th.call(Object.prototype,l)&&!i.allowPrototypes)return;u.push(l)}for(var c=0;i.depth>0&&(h=a.exec(n))!==null&&c<i.depth;){if(c+=1,!i.plainObjects&&Th.call(Object.prototype,h[1].slice(1,-1))&&!i.allowPrototypes)return;u.push(h[1])}return h&&u.push("["+n.slice(h.index)+"]"),Ty(u,e,i,s)}},Sy=function(t){if(!t)return xt;if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.decodeDotInKeys<"u"&&typeof t.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(t.decoder!==null&&typeof t.decoder<"u"&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?xt.charset:t.charset,i=typeof t.duplicates>"u"?xt.duplicates:t.duplicates;if(i!=="combine"&&i!=="first"&&i!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var s=typeof t.allowDots>"u"?t.decodeDotInKeys===!0?!0:xt.allowDots:!!t.allowDots;return{allowDots:s,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:xt.allowEmptyArrays,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:xt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:xt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:xt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:xt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:xt.comma,decodeDotInKeys:typeof t.decodeDotInKeys=="boolean"?t.decodeDotInKeys:xt.decodeDotInKeys,decoder:typeof t.decoder=="function"?t.decoder:xt.decoder,delimiter:typeof t.delimiter=="string"||ts.isRegExp(t.delimiter)?t.delimiter:xt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:xt.depth,duplicates:i,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:xt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:xt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:xt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:xt.strictNullHandling}},Ay=function(r,t){var e=Sy(t);if(r===""||r===null||typeof r>"u")return e.plainObjects?Object.create(null):{};for(var i=typeof r=="string"?by(r,e):r,s=e.plainObjects?Object.create(null):{},n=Object.keys(i),o=0;o<n.length;++o){var a=n[o],h=wy(a,i[a],e,typeof r=="string");s=ts.merge(s,h,e)}return e.allowSparse===!0?s:ts.compact(s)},Cy=gy,Ey=Ay,Py=Ol,Ry={formats:Py,parse:Ey,stringify:Cy},Iy=c_;function De(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var My=/^([a-z0-9.+-]+:)/i,Fy=/:[0-9]*$/,Dy=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,By=["<",">",'"',"`"," ","\r",`
`,"	"],Oy=["{","}","|","\\","^","`"].concat(By),wh=["'"].concat(Oy),xc=["%","/","?",";","#"].concat(wh),bc=["/","?","#"],Ly=255,Tc=/^[+a-z0-9A-Z_-]{0,63}$/,ky=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ny={javascript:!0,"javascript:":!0},Sh={javascript:!0,"javascript:":!0},Xr={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ah=Ry;function sa(r,t,e){if(r&&typeof r=="object"&&r instanceof De)return r;var i=new De;return i.parse(r,t,e),i}De.prototype.parse=function(r,t,e){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),s=i!==-1&&i<r.indexOf("#")?"?":"#",n=r.split(s),o=/\\/g;n[0]=n[0].replace(o,"/"),r=n.join(s);var a=r;if(a=a.trim(),!e&&r.split("#").length===1){var h=Dy.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=Ah.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=My.exec(a);if(l){l=l[0];var u=l.toLowerCase();this.protocol=u,a=a.substr(l.length)}if(e||l||a.match(/^\/\/[^@/]+@[^@/]+/)){var c=a.substr(0,2)==="//";c&&!(l&&Sh[l])&&(a=a.substr(2),this.slashes=!0)}if(!Sh[l]&&(c||l&&!Xr[l])){for(var d=-1,f=0;f<bc.length;f++){var p=a.indexOf(bc[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var m,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(m=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<xc.length;f++){var p=a.indexOf(xc[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var v=this.hostname.split(/\./),f=0,_=v.length;f<_;f++){var x=v[f];if(x&&!x.match(Tc)){for(var b="",C=0,w=x.length;C<w;C++)x.charCodeAt(C)>127?b+="x":b+=x[C];if(!b.match(Tc)){var T=v.slice(0,f),A=v.slice(f+1),I=x.match(ky);I&&(T.push(I[1]),A.unshift(I[2])),A.length&&(a="/"+A.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>Ly?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Iy.toASCII(this.hostname));var z=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+z,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Ny[u])for(var f=0,_=wh.length;f<_;f++){var S=wh[f];if(a.indexOf(S)!==-1){var P=encodeURIComponent(S);P===S&&(P=escape(S)),a=a.split(S).join(P)}}var D=a.indexOf("#");D!==-1&&(this.hash=a.substr(D),a=a.slice(0,D));var H=a.indexOf("?");if(H!==-1?(this.search=a.substr(H),this.query=a.substr(H+1),t&&(this.query=Ah.parse(this.query)),a=a.slice(0,H)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Xr[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",E=this.search||"";this.path=z+E}return this.href=this.format(),this};function Uy(r){return typeof r=="string"&&(r=sa(r)),r instanceof De?r.format():De.prototype.format.call(r)}De.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",s=!1,n="";this.host?s=r+this.host:this.hostname&&(s=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=Ah.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Xr[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+s+e+o+i};function Gy(r,t){return sa(r,!1,!0).resolve(t)}De.prototype.resolve=function(r){return this.resolveObject(sa(r,!1,!0)).format()};De.prototype.resolveObject=function(r){if(typeof r=="string"){var t=new De;t.parse(r,!1,!0),r=t}for(var e=new De,i=Object.keys(this),s=0;s<i.length;s++){var n=i[s];e[n]=this[n]}if(e.hash=r.hash,r.href==="")return e.href=e.format(),e;if(r.slashes&&!r.protocol){for(var o=Object.keys(r),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=r[h])}return Xr[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(r.protocol&&r.protocol!==e.protocol){if(!Xr[r.protocol]){for(var l=Object.keys(r),u=0;u<l.length;u++){var c=l[u];e[c]=r[c]}return e.href=e.format(),e}if(e.protocol=r.protocol,!r.host&&!Sh[r.protocol]){for(var _=(r.pathname||"").split("/");_.length&&!(r.host=_.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),e.pathname=_.join("/")}else e.pathname=r.pathname;if(e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||r.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",m=r.host||r.pathname&&r.pathname.charAt(0)==="/",g=m||p||e.host&&r.pathname,y=g,v=e.pathname&&e.pathname.split("/")||[],_=r.pathname&&r.pathname.split("/")||[],x=e.protocol&&!Xr[e.protocol];if(x&&(e.hostname="",e.port=null,e.host&&(v[0]===""?v[0]=e.host:v.unshift(e.host)),e.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(_[0]===""?_[0]=r.host:_.unshift(r.host)),r.host=null),g=g&&(_[0]===""||v[0]==="")),m)e.host=r.host||r.host===""?r.host:e.host,e.hostname=r.hostname||r.hostname===""?r.hostname:e.hostname,e.search=r.search,e.query=r.query,v=_;else if(_.length)v||(v=[]),v.pop(),v=v.concat(_),e.search=r.search,e.query=r.query;else if(r.search!=null){if(x){e.host=v.shift(),e.hostname=e.host;var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.hostname=b.shift(),e.host=e.hostname)}return e.search=r.search,e.query=r.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!v.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var C=v.slice(-1)[0],w=(e.host||r.host||v.length>1)&&(C==="."||C==="..")||C==="",T=0,A=v.length;A>=0;A--)C=v[A],C==="."?v.splice(A,1):C===".."?(v.splice(A,1),T++):T&&(v.splice(A,1),T--);if(!g&&!y)for(;T--;T)v.unshift("..");g&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),w&&v.join("/").substr(-1)!=="/"&&v.push("");var I=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(x){e.hostname=I?"":v.length?v.shift():"",e.host=e.hostname;var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.hostname=b.shift(),e.host=e.hostname)}return g=g||e.host&&v.length,g&&!I&&v.unshift(""),v.length>0?e.pathname=v.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=e.format(),e};De.prototype.parseHost=function(){var r=this.host,t=Fy.exec(r);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),r=r.substr(0,r.length-t.length)),r&&(this.hostname=r)};var zy=sa,Hy=Gy,$y=Uy;const wc={};function Y(r,t,e=3){if(wc[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(i))),wc[t]=!0}const Vy={get parse(){return Y("7.3.0","utils.url.parse is deprecated, use native URL API instead."),zy},get format(){return Y("7.3.0","utils.url.format is deprecated, use native URL API instead."),$y},get resolve(){return Y("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),Hy}};function be(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function ys(r){return r.split("?")[0].split("#")[0]}function Xy(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Wy(r,t,e){return r.replace(new RegExp(Xy(t),"g"),e)}function jy(r,t){let e="",i=0,s=-1,n=0,o=-1;for(let a=0;a<=r.length;++a){if(a<r.length)o=r.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||n===1))if(s!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),s=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,s=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${r.slice(s+1,a)}`:e=r.slice(s+1,a),i=a-s-1;s=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const It={toPosix(r){return Wy(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){be(r),r=this.toPosix(r);const t=/^file:\/\/\//.exec(r);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(r);return e?e[0]:""},toAbsolute(r,t,e){if(be(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=ys(this.toPosix(t??U.ADAPTER.getBaseUrl())),s=ys(this.toPosix(e??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?It.join(s,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(be(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let t="";const e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));const i=r.endsWith("/");return r=jy(r,!1),r.length>0&&i&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return be(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){const i=r[e];if(be(i),i.length>0)if(t===void 0)t=i;else{const s=r[e-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(be(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0);const e=t===47;let i=-1,s=!0;const n=this.getProtocol(r),o=r;r=r.slice(n.length);for(let a=r.length-1;a>=1;--a)if(t=r.charCodeAt(a),t===47){if(!s){i=a;break}}else s=!1;return i===-1?e?"/":this.isUrl(o)?n+r:n:e&&i===1?"//":n+r.slice(0,i)},rootname(r){be(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){const e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){be(r),t&&be(t),r=ys(this.toPosix(r));let e=0,i=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let o=t.length-1,a=-1;for(n=r.length-1;n>=0;--n){const h=r.charCodeAt(n);if(h===47){if(!s){e=n+1;break}}else a===-1&&(s=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(n=r.length-1;n>=0;--n)if(r.charCodeAt(n)===47){if(!s){e=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":r.slice(e,i)},extname(r){be(r),r=ys(this.toPosix(r));let t=-1,e=0,i=-1,s=!0,n=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===47){if(!s){e=o+1;break}continue}i===-1&&(s=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":r.slice(t,i)},parse(r){be(r);const t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=ys(this.toPosix(r));let e=r.charCodeAt(0);const i=this.isAbsolute(r);let s;t.root=this.rootname(r),i||this.hasProtocol(r)?s=1:s=0;let n=-1,o=0,a=-1,h=!0,l=r.length-1,u=0;for(;l>=s;--l){if(e=r.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||a===-1||u===0||u===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=r.slice(1,a):t.base=t.name=r.slice(o,a)):(o===0&&i?(t.name=r.slice(1,n),t.base=r.slice(1,a)):(t.name=r.slice(o,n),t.base=r.slice(o,a)),t.ext=r.slice(n,a)),t.dir=this.dirname(r),t},sep:"/",delimiter:":",joinExtensions:[".html"]};let Da;async function ff(){return Da??(Da=(async()=>{var n;const r=document.createElement("canvas").getContext("webgl");if(!r)return jt.UNPACK;const t=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!t)return jt.UNPACK;const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);const i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,s),r.deleteFramebuffer(i),r.deleteTexture(e),(n=r.getExtension("WEBGL_lose_context"))==null||n.loseContext(),s[0]<=s[3]?jt.PMA:jt.UNPACK})()),Da}function Yy(){Y("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function qy(){Y("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}let Ba;function pf(){return typeof Ba>"u"&&(Ba=function(){var t;const r={stencil:!0,failIfMajorPerformanceCaveat:U.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!U.ADAPTER.getWebGLRenderingContext())return!1;const e=U.ADAPTER.createCanvas();let i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r);const s=!!((t=i==null?void 0:i.getContextAttributes())!=null&&t.stencil);if(i){const n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,s}catch{return!1}}()),Ba}var Ky={grad:.9,turn:360,rad:360/(2*Math.PI)},ai=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Bt=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*r)/e+0},me=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),r>e?e:r>t?r:t},mf=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},Sc=function(r){return{r:me(r.r,0,255),g:me(r.g,0,255),b:me(r.b,0,255),a:me(r.a)}},Oa=function(r){return{r:Bt(r.r),g:Bt(r.g),b:Bt(r.b),a:Bt(r.a,3)}},Zy=/^#([0-9a-f]{3,8})$/i,Nn=function(r){var t=r.toString(16);return t.length<2?"0"+t:t},gf=function(r){var t=r.r,e=r.g,i=r.b,s=r.a,n=Math.max(t,e,i),o=n-Math.min(t,e,i),a=o?n===t?(e-i)/o:n===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:s}},_f=function(r){var t=r.h,e=r.s,i=r.v,s=r.a;t=t/360*6,e/=100,i/=100;var n=Math.floor(t),o=i*(1-e),a=i*(1-(t-n)*e),h=i*(1-(1-t+n)*e),l=n%6;return{r:255*[i,a,o,o,h,i][l],g:255*[h,i,i,a,o,o][l],b:255*[o,o,h,i,i,a][l],a:s}},Ac=function(r){return{h:mf(r.h),s:me(r.s,0,100),l:me(r.l,0,100),a:me(r.a)}},Cc=function(r){return{h:Bt(r.h),s:Bt(r.s),l:Bt(r.l),a:Bt(r.a,3)}},Ec=function(r){return _f((e=(t=r).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},Us=function(r){return{h:(t=gf(r)).h,s:(s=(200-(e=t.s))*(i=t.v)/100)>0&&s<200?e*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,i,s},Qy=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Jy=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,tv=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ev=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ch={string:[[function(r){var t=Zy.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Bt(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Bt(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var t=tv.exec(r)||ev.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:Sc({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(r){var t=Qy.exec(r)||Jy.exec(r);if(!t)return null;var e,i,s=Ac({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(Ky[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Ec(s)},"hsl"]],object:[[function(r){var t=r.r,e=r.g,i=r.b,s=r.a,n=s===void 0?1:s;return ai(t)&&ai(e)&&ai(i)?Sc({r:Number(t),g:Number(e),b:Number(i),a:Number(n)}):null},"rgb"],[function(r){var t=r.h,e=r.s,i=r.l,s=r.a,n=s===void 0?1:s;if(!ai(t)||!ai(e)||!ai(i))return null;var o=Ac({h:Number(t),s:Number(e),l:Number(i),a:Number(n)});return Ec(o)},"hsl"],[function(r){var t=r.h,e=r.s,i=r.v,s=r.a,n=s===void 0?1:s;if(!ai(t)||!ai(e)||!ai(i))return null;var o=function(a){return{h:mf(a.h),s:me(a.s,0,100),v:me(a.v,0,100),a:me(a.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(n)});return _f(o)},"hsv"]]},Pc=function(r,t){for(var e=0;e<t.length;e++){var i=t[e][0](r);if(i)return[i,t[e][1]]}return[null,void 0]},iv=function(r){return typeof r=="string"?Pc(r.trim(),Ch.string):typeof r=="object"&&r!==null?Pc(r,Ch.object):[null,void 0]},La=function(r,t){var e=Us(r);return{h:e.h,s:me(e.s+100*t,0,100),l:e.l,a:e.a}},ka=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Rc=function(r,t){var e=Us(r);return{h:e.h,s:e.s,l:me(e.l+100*t,0,100),a:e.a}},Eh=function(){function r(t){this.parsed=iv(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Bt(ka(this.rgba),2)},r.prototype.isDark=function(){return ka(this.rgba)<.5},r.prototype.isLight=function(){return ka(this.rgba)>=.5},r.prototype.toHex=function(){return t=Oa(this.rgba),e=t.r,i=t.g,s=t.b,o=(n=t.a)<1?Nn(Bt(255*n)):"","#"+Nn(e)+Nn(i)+Nn(s)+o;var t,e,i,s,n,o},r.prototype.toRgb=function(){return Oa(this.rgba)},r.prototype.toRgbString=function(){return t=Oa(this.rgba),e=t.r,i=t.g,s=t.b,(n=t.a)<1?"rgba("+e+", "+i+", "+s+", "+n+")":"rgb("+e+", "+i+", "+s+")";var t,e,i,s,n},r.prototype.toHsl=function(){return Cc(Us(this.rgba))},r.prototype.toHslString=function(){return t=Cc(Us(this.rgba)),e=t.h,i=t.s,s=t.l,(n=t.a)<1?"hsla("+e+", "+i+"%, "+s+"%, "+n+")":"hsl("+e+", "+i+"%, "+s+"%)";var t,e,i,s,n},r.prototype.toHsv=function(){return t=gf(this.rgba),{h:Bt(t.h),s:Bt(t.s),v:Bt(t.v),a:Bt(t.a,3)};var t},r.prototype.invert=function(){return ze({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},r.prototype.saturate=function(t){return t===void 0&&(t=.1),ze(La(this.rgba,t))},r.prototype.desaturate=function(t){return t===void 0&&(t=.1),ze(La(this.rgba,-t))},r.prototype.grayscale=function(){return ze(La(this.rgba,-1))},r.prototype.lighten=function(t){return t===void 0&&(t=.1),ze(Rc(this.rgba,t))},r.prototype.darken=function(t){return t===void 0&&(t=.1),ze(Rc(this.rgba,-t))},r.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},r.prototype.alpha=function(t){return typeof t=="number"?ze({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Bt(this.rgba.a,3);var e},r.prototype.hue=function(t){var e=Us(this.rgba);return typeof t=="number"?ze({h:t,s:e.s,l:e.l,a:e.a}):Bt(e.h)},r.prototype.isEqual=function(t){return this.toHex()===ze(t).toHex()},r}(),ze=function(r){return r instanceof Eh?r:new Eh(r)},Ic=[],rv=function(r){r.forEach(function(t){Ic.indexOf(t)<0&&(t(Eh,Ch),Ic.push(t))})};function sv(r,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in e)i[e[s]]=s;var n={};r.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=i[this.toHex()];if(l)return l;if(o!=null&&o.closest){var u=this.toRgb(),c=1/0,d="black";if(!n.length)for(var f in e)n[f]=new r(e[f]).toRgb();for(var p in e){var m=(a=u,h=n[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));m<c&&(c=m,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new r(h).toRgb():null},"name"])}rv([sv]);const Mr=class ao{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof ao)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,n)=>s===e[n]);if(t!==null&&e!==null){const s=Object.keys(t),n=Object.keys(e);return s.length!==n.length?!1:s.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];const[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,s,n]=ao.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,s,n]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}normalize(t){let e,i,s,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,s=(o&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,n=255]=t,e/=255,i/=255,s/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=ao.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=ze(t);o.isValid()&&({r:e,g:i,b:s,a:n}=o.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,n)=>{t[n]=Math.min(Math.max(s,e),i)}),t)}};Mr.shared=new Mr,Mr.temp=new Mr,Mr.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let st=Mr;function ds(r,t=[]){return Y("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),st.shared.setValue(r).toRgbArray(t)}function yf(r){return Y("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),st.shared.setValue(r).toHex()}function nv(r){return Y("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),st.shared.setValue(r).toNumber()}function fs(r){return Y("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),st.shared.setValue(r).toNumber()}function ov(){const r=[],t=[];for(let i=0;i<32;i++)r[i]=i,t[i]=i;r[W.NORMAL_NPM]=W.NORMAL,r[W.ADD_NPM]=W.ADD,r[W.SCREEN_NPM]=W.SCREEN,t[W.NORMAL]=W.NORMAL_NPM,t[W.ADD]=W.ADD_NPM,t[W.SCREEN]=W.SCREEN_NPM;const e=[];return e.push(t),e.push(r),e}const Ll=ov();function kl(r,t){return Ll[t?1:0][r]}function av(r,t,e,i=!0){return Y("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),st.shared.setValue(r).premultiply(t,i).toArray(e??new Float32Array(4))}function hv(r,t){return Y("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),st.shared.setValue(r).toPremultiplied(t)}function lv(r,t,e,i=!0){return Y("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),st.shared.setValue(r).premultiply(t,i).toArray(e??new Float32Array(4))}const vf=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function xf(r,t=null){const e=r*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,s=0;i<e;i+=6,s+=4)t[i+0]=s+0,t[i+1]=s+1,t[i+2]=s+2,t[i+3]=s+0,t[i+4]=s+2,t[i+5]=s+3;return t}function na(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}const uv={Float32Array,Uint32Array,Int32Array,Uint8Array};function cv(r,t){let e=0,i=0;const s={};for(let h=0;h<r.length;h++)i+=t[h],e+=r[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<r.length;h++){const l=t[h],u=r[h],c=na(u);s[c]||(s[c]=new uv[c](n)),o=s[c];for(let d=0;d<u.length;d++){const f=(d/l|0)*i+a,p=d%l;o[f+p]=u[d]}a+=l}return new Float32Array(n)}function Ys(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Ph(r){return!(r&r-1)&&!!r}function Rh(r){let t=(r>65535?1:0)<<4;r>>>=t;let e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function hr(r,t,e){const i=r.length;let s;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(s=t;s<n;++s)r[s]=r[s+e];r.length=n}function fi(r){return r===0?0:r<0?-1:1}let dv=0;function Li(){return++dv}const Ih=class{constructor(r,t,e,i){this.left=r,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Ih.EMPTY=new Ih(0,0,0,0);let Mh=Ih;const Fh={},Gt=Object.create(null),ie=Object.create(null);function fv(){let r;for(r in Gt)Gt[r].destroy();for(r in ie)ie[r].destroy()}function pv(){let r;for(r in Gt)delete Gt[r];for(r in ie)delete ie[r]}class bf{constructor(t,e,i){this._canvas=U.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||U.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Mc(r,t,e){for(let i=0,s=4*e*t;i<t;++i,s+=4)if(r[s+3]!==0)return!1;return!0}function Fc(r,t,e,i,s){const n=4*t;for(let o=i,a=i*n+4*e;o<=s;++o,a+=n)if(r[a+3]!==0)return!1;return!0}function Tf(r){const{width:t,height:e}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const s=i.getImageData(0,0,t,e).data;let n=0,o=0,a=t-1,h=e-1;for(;o<e&&Mc(s,t,o);)++o;if(o===e)return Mh.EMPTY;for(;Mc(s,t,h);)--h;for(;Fc(s,t,n,o,h);)++n;for(;Fc(s,t,a,o,h);)--a;return++a,++h,new Mh(n,o,a,h)}function wf(r){const t=Tf(r),{width:e,height:i}=t;let s=null;if(!t.isEmpty()){const n=r.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");s=n.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:s}}function mv(r){const t=vf.exec(r);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function Sf(r,t=globalThis.location){if(r.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(r,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function ii(r,t=1){var i;const e=(i=U.RETINA_PREFIX)==null?void 0:i.exec(r);return e?parseFloat(e[1]):t}const gv=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:ie,BoundingBox:Mh,CanvasRenderTarget:bf,DATA_URI:vf,EventEmitter:vr,ProgramCache:Fh,TextureCache:Gt,clearTextureCache:pv,correctBlendMode:kl,createIndicesForQuads:xf,decomposeDataUri:mv,deprecation:Y,destroyTextureCache:fv,detectVideoAlphaMode:ff,determineCrossOrigin:Sf,earcut:Xd,getBufferType:na,getCanvasBoundingBox:Tf,getResolutionOfUrl:ii,hex2rgb:ds,hex2string:yf,interleaveTypedArrays:cv,isMobile:Ie,isPow2:Ph,isWebGLSupported:pf,log2:Rh,nextPow2:Ys,path:It,premultiplyBlendMode:Ll,premultiplyRgba:av,premultiplyTint:hv,premultiplyTintToRgba:lv,removeItems:hr,rgb2hex:fs,sayHello:qy,sign:fi,skipHello:Yy,string2hex:nv,trimCanvas:wf,uid:Li,url:Vy},Symbol.toStringTag,{value:"Module"}));var N=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(N||{});const Dh=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Dc=(r,t)=>Dh(r).priority??t,$={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Dh).forEach(t=>{t.type.forEach(e=>{var i,s;return(s=(i=this._removeHandlers)[e])==null?void 0:s.call(i,t)})}),this},add(...r){return r.map(Dh).forEach(t=>{t.type.forEach(e=>{var n,o;const i=this._addHandlers,s=this._queue;i[e]?(n=i[e])==null||n.call(i,t):(s[e]=s[e]||[],(o=s[e])==null||o.push(t))})}),this},handle(r,t,e){var o;const i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=t,s[r]=e;const n=this._queue;return n[r]&&((o=n[r])==null||o.forEach(a=>t(a)),delete n[r]),this},handleByMap(r,t){return this.handle(r,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(r,t,e=-1){return this.handle(r,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,n)=>Dc(n,e)-Dc(s,e)))},i=>{const s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})}};class Ro{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const _v=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function yv(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function Af(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=_v.replace(/%forloop%/gi,yv(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}const Na=0,Ua=1,Ga=2,za=3,Ha=4,$a=5;class Le{constructor(){this.data=0,this.blendMode=W.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Na)}set blend(t){!!(this.data&1<<Na)!==t&&(this.data^=1<<Na)}get offsets(){return!!(this.data&1<<Ua)}set offsets(t){!!(this.data&1<<Ua)!==t&&(this.data^=1<<Ua)}get culling(){return!!(this.data&1<<Ga)}set culling(t){!!(this.data&1<<Ga)!==t&&(this.data^=1<<Ga)}get depthTest(){return!!(this.data&1<<za)}set depthTest(t){!!(this.data&1<<za)!==t&&(this.data^=1<<za)}get depthMask(){return!!(this.data&1<<$a)}set depthMask(t){!!(this.data&1<<$a)!==t&&(this.data^=1<<$a)}get clockwiseFrontFace(){return!!(this.data&1<<Ha)}set clockwiseFrontFace(t){!!(this.data&1<<Ha)!==t&&(this.data^=1<<Ha)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==W.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new Le;return t.depthTest=!1,t.blend=!0,t}}Le.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Io=[];function Nl(r,t){if(!r)return null;let e="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(e=i[1].toLowerCase())}for(let i=Io.length-1;i>=0;--i){const s=Io[i];if(s.test&&s.test(r,e))return new s(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class he{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,s,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:u}=this;this._aliasCount++;for(let c=0,d=u.length;c<d;c++)u[c][l](t,e,i,s,n,o,a,h);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(he.prototype,{dispatch:{value:he.prototype.emit},run:{value:he.prototype.emit}});class es{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new he("setRealSize"),this.onUpdate=new he("update"),this.onError=new he("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class xn extends es{constructor(t,e){const{width:i,height:s}=e||{};if(!i||!s)throw new Error("BufferResource width or height invalid");super(i,s),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,i){const s=t.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===jt.UNPACK);const n=e.realWidth,o=e.realHeight;return i.width===n&&i.height===o?s.texSubImage2D(e.target,0,0,0,n,o,e.format,i.type,this.data):(i.width=n,i.height=o,s.texImage2D(e.target,0,i.internalFormat,n,o,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const vv={scaleMode:Re.NEAREST,alphaMode:jt.NPM},Bh=class Fr extends vr{constructor(t=null,e=null){super(),e=Object.assign({},Fr.defaultOptions,e);const{alphaMode:i,mipmap:s,anisotropicLevel:n,scaleMode:o,width:a,height:h,wrapMode:l,format:u,type:c,target:d,resolution:f,resourceOptions:p}=e;t&&!(t instanceof es)&&(t=Nl(t,p),t.internal=!0),this.resolution=f||U.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=n,this._wrapMode=l,this._scaleMode=o,this.format=u,this.type=c,this.target=d,this.alphaMode=i,this.uid=Li(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ph(this.realWidth)&&Ph(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ie[this.cacheId],delete Gt[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Fr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=U.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Li()}`}n=t._pixiId}let o=ie[n];if(s&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new Fr(t,e),o.cacheId=n,Fr.addToCache(o,n)),o}static fromBuffer(t,e,i,s){t=t||new Float32Array(e*i*4);const n=new xn(t,{width:e,height:i,...s==null?void 0:s.resourceOptions});let o,a;return t instanceof Float32Array?(o=F.RGBA,a=X.FLOAT):t instanceof Int32Array?(o=F.RGBA_INTEGER,a=X.INT):t instanceof Uint32Array?(o=F.RGBA_INTEGER,a=X.UNSIGNED_INT):t instanceof Int16Array?(o=F.RGBA_INTEGER,a=X.SHORT):t instanceof Uint16Array?(o=F.RGBA_INTEGER,a=X.UNSIGNED_SHORT):t instanceof Int8Array?(o=F.RGBA,a=X.BYTE):(o=F.RGBA,a=X.UNSIGNED_BYTE),n.internal=!0,new Fr(n,Object.assign({},vv,{type:a,format:o},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ie[e]&&ie[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),ie[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=ie[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete ie[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete ie[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Bh.defaultOptions={mipmap:Oe.POW2,anisotropicLevel:0,scaleMode:Re.LINEAR,wrapMode:ti.CLAMP,alphaMode:jt.UNPACK,target:nr.TEXTURE_2D,format:F.RGBA,type:X.UNSIGNED_BYTE},Bh._globalBatch=0;let K=Bh;class Mo{constructor(){this.texArray=null,this.blend=0,this.type=Pe.TRIANGLES,this.start=0,this.size=0,this.data=null}}let xv=0;class yt{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=xv++,this.disposeRunner=new he("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Fe.ELEMENT_ARRAY_BUFFER:Fe.ARRAY_BUFFER}get index(){return this.type===Fe.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new yt(t)}}class qs{constructor(t,e=0,i=!1,s=X.FLOAT,n,o,a,h=1){this.buffer=t,this.size=e,this.normalized=i,this.type=s,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,i,s,n){return new qs(t,e,i,s,n)}}const bv={Float32Array,Uint32Array,Int32Array,Uint8Array};function Tv(r,t){let e=0,i=0;const s={};for(let h=0;h<r.length;h++)i+=t[h],e+=r[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<r.length;h++){const l=t[h],u=r[h],c=na(u);s[c]||(s[c]=new bv[c](n)),o=s[c];for(let d=0;d<u.length;d++){const f=(d/l|0)*i+a,p=d%l;o[f+p]=u[d]}a+=l}return new Float32Array(n)}const Bc={5126:4,5123:2,5121:1};let wv=0;const Sv={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class mi{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=wv++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new he("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,s=!1,n,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof yt||(e instanceof Array&&(e=new Float32Array(e)),e=new yt(e));const l=t.split("|");if(l.length>1){for(let c=0;c<l.length;c++)this.addAttribute(l[c],e,i,s,n);return this}let u=this.buffers.indexOf(e);return u===-1&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new qs(u,i,s,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof yt||(t instanceof Array&&(t=new Uint16Array(t)),t=new yt(t)),t.type=Fe.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new yt;let s;for(s in this.attributes){const n=this.attributes[s],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*Bc[n.type]/4),n.buffer=0}for(i.data=Tv(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new mi;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new yt(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new qs(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Fe.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new mi,i=[],s=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h]=s[h]||0,s[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new Sv[na(o.buffers[a].data)](s[a]),e.buffers[a]=new yt(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)i[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=Fe.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,u=0;for(let c=0;c<o.buffers.length;c++)if(o.buffers[c]!==o.indexBuffer){u=c;break}for(const c in o.attributes){const d=o.attributes[c];(d.buffer|0)===u&&(h+=d.size*Bc[d.type]/4)}for(let c=0;c<t.length;c++){const d=t[c].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+l]+=a;a+=t[c].buffers[u].data.length/h,l+=d.length}}return e}}class Ul extends mi{constructor(t=!1){super(),this._buffer=new yt(null,t,!1),this._indexBuffer=new yt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,X.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,X.FLOAT).addAttribute("aColor",this._buffer,4,!0,X.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,X.FLOAT).addIndex(this._indexBuffer)}}const Ks=Math.PI*2,Cf=180/Math.PI,is=Math.PI/180;var Lt=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(Lt||{});class j{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new j(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}j.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Un=[new j,new j,new j,new j];class Z{constructor(t=0,e=0,i=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s),this.type=Lt.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Z(0,0,0,0)}clone(){return new Z(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const A=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>A}const i=this.left,s=this.right,n=this.top,o=this.bottom;if(s<=i||o<=n)return!1;const a=Un[0].set(t.left,t.top),h=Un[1].set(t.left,t.bottom),l=Un[2].set(t.right,t.top),u=Un[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(c===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(u,u),Math.max(a.x,h.x,l.x,u.x)<=i||Math.min(a.x,h.x,l.x,u.x)>=s||Math.max(a.y,h.y,l.y,u.y)<=n||Math.min(a.y,h.y,l.y,u.y)>=o))return!1;const d=c*(h.y-a.y),f=c*(a.x-h.x),p=d*i+f*n,m=d*s+f*n,g=d*i+f*o,y=d*s+f*o;if(Math.max(p,m,g,y)<=d*a.x+f*a.y||Math.min(p,m,g,y)>=d*u.x+f*u.y)return!1;const v=c*(a.y-l.y),_=c*(l.x-a.x),x=v*i+_*n,b=v*s+_*n,C=v*i+_*o,w=v*s+_*o;return!(Math.max(x,b,C,w)<=v*a.x+_*a.y||Math.min(x,b,C,w)>=v*u.x+_*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=n-s,this}}Z.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class gr{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=Lt.CIRC}clone(){return new gr(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-t,n=this.y-e;return s*=s,n*=n,s+n<=i}getBounds(){return new Z(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}gr.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class bn{constructor(t=0,e=0,i=0,s=0){this.x=t,this.y=e,this.width=i,this.height=s,this.type=Lt.ELIP}clone(){return new bn(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,s=(e-this.y)/this.height;return i*=i,s*=s,i+s<=1}getBounds(){return new Z(this.x-this.width,this.y-this.height,this.width,this.height)}}bn.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Fi{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let s=0,n=e.length;s<n;s++)i.push(e[s].x,e[s].y);e=i}this.points=e,this.type=Lt.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Fi(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1;const s=this.points.length/2;for(let n=0,o=s-1;n<s;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],u=this.points[o*2+1];h>e!=u>e&&t<(l-a)*((e-h)/(u-h))+a&&(i=!i)}return i}}Fi.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,t)=>`${r}, ${t}`,"")}]`};class Tn{constructor(t=0,e=0,i=0,s=0,n=20){this.x=t,this.y=e,this.width=i,this.height=s,this.radius=n,this.type=Lt.RREC}clone(){return new Tn(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let s=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(s*s+n*n<=o||(s=t-(this.x+this.width-i),s*s+n*n<=o)||(n=e-(this.y+this.height-i),s*s+n*n<=o)||(s=t-(this.x+i),s*s+n*n<=o))return!0}return!1}}Tn.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class ut{constructor(t=1,e=0,i=0,s=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,s,n,o){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new j;const i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e}applyInverse(t,e){e=e||new j;const i=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*i*s+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.a,n=this.c,o=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,s,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,s=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-s,n),h=Math.atan2(i,e),l=Math.abs(a+h);return l<1e-5||Math.abs(Ks-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(o.x*e+o.y*s),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,s=this.d,n=this.tx,o=t*s-e*i;return this.a=s/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-s*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new ut;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new ut}static get TEMP_MATRIX(){return new ut}}ut.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const qi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ki=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Zi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Qi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Oh=[],Ef=[],Gn=Math.sign;function Av(){for(let r=0;r<16;r++){const t=[];Oh.push(t);for(let e=0;e<16;e++){const i=Gn(qi[r]*qi[e]+Zi[r]*Ki[e]),s=Gn(Ki[r]*qi[e]+Qi[r]*Ki[e]),n=Gn(qi[r]*Zi[e]+Zi[r]*Qi[e]),o=Gn(Ki[r]*Zi[e]+Qi[r]*Qi[e]);for(let a=0;a<16;a++)if(qi[a]===i&&Ki[a]===s&&Zi[a]===n&&Qi[a]===o){t.push(a);break}}}for(let r=0;r<16;r++){const t=new ut;t.set(qi[r],Ki[r],Zi[r],Qi[r],0,0),Ef.push(t)}}Av();const ft={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>qi[r],uY:r=>Ki[r],vX:r=>Zi[r],vY:r=>Qi[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>Oh[r][t],sub:(r,t)=>Oh[r][ft.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?ft.S:ft.N:Math.abs(t)*2<=Math.abs(r)?r>0?ft.E:ft.W:t>0?r>0?ft.SE:ft.SW:r>0?ft.NE:ft.NW,matrixAppendRotationInv:(r,t,e=0,i=0)=>{const s=Ef[ft.inv(t)];s.tx=e,s.ty=i,r.append(s)}};class Me{constructor(t,e,i=0,s=0){this._x=i,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Me(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}Me.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Lh=class{constructor(){this.worldTransform=new ut,this.localTransform=new ut,this.position=new Me(this.onChange,this,0,0),this.scale=new Me(this.onChange,this,1,1),this.pivot=new Me(this.onChange,this,0,0),this.skew=new Me(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const e=r.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};Lh.IDENTITY=new Lh;let wn=Lh;wn.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var Cv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Ev=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Oc(r,t,e){const i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}function Va(r){const t=new Array(r);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Pf(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Va(2*t);case"bvec3":return Va(3*t);case"bvec4":return Va(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const lr=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,t)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,t)=>r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,t)=>r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,t)=>r.type==="vec3"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],Pv={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},Rv={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Iv(r,t){var i;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in r.uniforms){const n=t[s];if(!n){((i=r.uniforms[s])==null?void 0:i.group)===!0&&(r.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const o=r.uniforms[s];let a=!1;for(let h=0;h<lr.length;h++)if(lr[h].test(n,o)){e.push(lr[h].code(s,o)),a=!0;break}if(!a){const h=(n.size===1&&!n.isArray?Pv:Rv)[n.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Rf={};let Cr=Rf;function If(){if(Cr===Rf||Cr!=null&&Cr.isContextLost()){const r=U.ADAPTER.createCanvas();let t;U.PREFER_ENV>=zi.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Cr=t}return Cr}let zn;function Mv(){if(!zn){zn=oe.MEDIUM;const r=If();if(r&&r.getShaderPrecisionFormat){const t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);t&&(zn=t.precision?oe.HIGH:oe.MEDIUM)}}return zn}function Lc(r,t){const e=r.getShaderSource(t).split(`
`).map((l,u)=>`${u}: ${l}`),i=r.getShaderInfoLog(t),s=i.split(`
`),n={},o=s.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Fv(r,t,e,i){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||Lc(r,e),r.getShaderParameter(i,r.COMPILE_STATUS)||Lc(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}const Dv={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Mf(r){return Dv[r]}let Hn=null;const kc={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Ff(r,t){if(!Hn){const e=Object.keys(kc);Hn={};for(let i=0;i<e.length;++i){const s=e[i];Hn[r[s]]=kc[s]}}return Hn[t]}function Nc(r,t,e){if(r.substring(0,9)!=="precision"){let i=t;return t===oe.HIGH&&e!==oe.HIGH&&(i=oe.MEDIUM),`precision ${i} float;
${r}`}else if(e!==oe.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let vs;function Df(){if(typeof vs=="boolean")return vs;try{vs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{vs=!1}return vs}let Bv=0;const $n={},kh=class Dr{constructor(t,e,i="pixi-shader",s={}){this.extra={},this.id=Bv++,this.vertexSrc=t||Dr.defaultVertexSrc,this.fragmentSrc=e||Dr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),$n[i]?($n[i]++,i+=`-${$n[i]}`):$n[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=Nc(this.vertexSrc,Dr.defaultVertexPrecision,oe.HIGH),this.fragmentSrc=Nc(this.fragmentSrc,Dr.defaultFragmentPrecision,Mv())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Ev}static get defaultFragmentSrc(){return Cv}static from(t,e,i){const s=t+e;let n=Fh[s];return n||(Fh[s]=n=new Dr(t,e,i)),n}};kh.defaultVertexPrecision=oe.HIGH,kh.defaultFragmentPrecision=Ie.apple.device?oe.HIGH:oe.MEDIUM;let Qe=kh,Ov=0;class ye{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Ov++,this.static=!!e,this.ubo=!!i,t instanceof yt?(this.buffer=t,this.buffer.type=Fe.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new yt(new Float32Array(1)),this.buffer.type=Fe.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new ye(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new ye(t,e,i)}static uboFrom(t,e){return new ye(t,e??!0,!0)}}class Be{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ye?this.uniformGroup=e:this.uniformGroup=new ye(e):this.uniformGroup=new ye({}),this.disposeRunner=new he("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const s=e.uniforms[i];if(s.group===!0&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const s=Qe.from(t,e);return new Be(s,i)}}class Bf{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=ye.from({uSamplers:i},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Qe(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new ut,default:this.defaultGroupCache[t]};return new Be(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Fo{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Lv(){return!Ie.apple.device}function kv(r){let t=!0;const e=U.ADAPTER.getNavigator();if(Ie.tablet||Ie.phone){if(Ie.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Ie.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?r:4}class Sn{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Nv=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Uv=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const As=class we extends Sn{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Ul,this.vertexSize=6,this.state=Le.for2d(),this.size=we.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??kv(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Lv(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return Y("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Uv}static get defaultFragmentTemplate(){return Nv}setShaderGenerator({vertex:t=we.defaultVertexSrc,fragment:e=we.defaultFragmentTemplate}={}){this.shaderGenerator=new Bf(t,e)}contextChange(){const t=this.renderer.gl;U.PREFER_ENV===zi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),we.defaultMaxTextures),this.maxTextures=Af(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=we,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new Mo);for(;e.length<s;)e.push(new Fo);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,i=we._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++K._globalBatch,h=0,l=i[0],u=0;s.copyBoundTextures(n,e);for(let c=0;c<this._bufferSize;++c){const d=t[c];t[c]=null,d._batchEnabled!==a&&(l.count>=e&&(s.boundArray(l,n,a,e),this.buildDrawCalls(l,u,c),u=c,l=i[++h],++a),d._batchEnabled=a,d.touched=o,l.elements[l.count++]=d)}l.count>0&&(s.boundArray(l,n,a,e),this.buildDrawCalls(l,u,this._bufferSize),++h,++a);for(let c=0;c<n.length;c++)n[c]=null;K._globalBatch=a}buildDrawCalls(t,e,i){const{_bufferedElements:s,_attributeBuffer:n,_indexBuffer:o,vertexSize:a}=this,h=we._drawCallPool;let l=this._dcIndex,u=this._aIndex,c=this._iIndex,d=h[l];d.start=this._iIndex,d.texArray=t;for(let f=e;f<i;++f){const p=s[f],m=p._texture.baseTexture,g=Ll[m.alphaMode?1:0][p.blendMode];s[f]=null,e<f&&d.blend!==g&&(d.size=c-d.start,e=f,d=h[++l],d.texArray=t,d.start=c),this.packInterleavedGeometry(p,n,o,u,c),u+=p.vertexData.length/2*a,c+=p.indices.length,d.blend=g}e<i&&(d.size=c-d.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;we.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,s=we._drawCallPool;let n=null;for(let o=0;o<t;o++){const{texArray:a,type:h,size:l,start:u,blend:c}=s[o];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,i.set(this.state),e.drawElements(h,l,e.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),we.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Ys(Math.ceil(t/8)),i=Rh(e),s=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._aBuffers[s];return n||(this._aBuffers[s]=n=new Ro(s*this.vertexSize*4)),n}getIndexBuffer(t){const e=Ys(Math.ceil(t/12)),i=Rh(e),s=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(s)),n}packInterleavedGeometry(t,e,i,s,n){const{uint32View:o,float32View:a}=e,h=s/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,d=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),p=st.shared.setValue(t._tintRGB).toPremultiplied(f,t._texture.baseTexture.alphaMode>0);for(let m=0;m<c.length;m+=2)a[s++]=c[m],a[s++]=c[m+1],a[s++]=l[m],a[s++]=l[m+1],o[s++]=p,a[s++]=d;for(let m=0;m<u.length;m++)i[n++]=h+u[m]}};As.defaultBatchSize=4096,As.extension={name:"batch",type:N.RendererPlugin},As._drawCallPool=[],As._textureArrayPool=[];let Ti=As;$.add(Ti);var Gv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,zv=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Nh=class Cs extends Be{constructor(t,e,i){const s=Qe.from(t||Cs.defaultVertexSrc,e||Cs.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=Cs.defaultResolution,this.multisample=Cs.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Le}apply(t,e,i,s,n){t.applyFilter(this,e,i,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return zv}static get defaultFragmentSrc(){return Gv}};Nh.defaultResolution=1,Nh.defaultMultisample=Tt.NONE;let tt=Nh;class Zs{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new st(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:i,backgroundAlpha:s}=t,n=i??e;n!==void 0&&(this.color=n),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Zs.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Zs.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"background"};$.add(Zs);class Gl{constructor(t){this.renderer=t,this.emptyRenderer=new Sn(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=i[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,i,s){const{elements:n,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const u=n[l],c=u._batchLocation;if(c>=0&&c<s&&e[c]===u){o[l]=c;continue}for(;h<s;){const d=e[h];if(d&&d._batchEnabled===i&&d._batchLocation===h){h++;continue}o[l]=h,u._batchLocation=h,e[h]=u;break}}}destroy(){this.renderer=null}}Gl.extension={type:N.RendererSystem,name:"batch"};$.add(Gl);let Uc=0;class Qs{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Uc++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Uc++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(U.PREFER_ENV>=zi.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc"),bptc:t.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Qs.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Qs.extension={type:N.RendererSystem,name:"context"};$.add(Qs);class Do{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new he("disposeFramebuffer"),this.multisample=Tt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new K(null,{scaleMode:Re.NEAREST,resolution:1,mipmap:Oe.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new K(null,{scaleMode:Re.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Oe.OFF,format:F.DEPTH_COMPONENT,type:X.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const s=this.colorTextures[i],n=s.resolution;s.setSize(t/n,e/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class zl extends K{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],s=arguments[2],n=arguments[3];t={width:e,height:i,scaleMode:s,resolution:n}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=Tt.NONE),super(null,t),this.mipmap=Oe.OFF,this.valid=!0,this._clear=new st([0,0,0,0]),this.framebuffer=new Do(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class ri extends es{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.displayWidth||e.width,s=e.naturalHeight||e.videoHeight||e.displayHeight||e.height;super(i,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=Sf(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,s){const n=t.gl,o=e.realWidth,a=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===jt.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&i.width===o&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,i.type,s):(i.width=o,i.height=a,n.texImage2D(e.target,0,i.internalFormat,e.format,i.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class Hl extends ri{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;ri.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??U.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const s=this.source;this.url=s.src;const n=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?n():(s.onload=n,s.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===jt.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let s=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==i&&a.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class oa{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const s=e.width,n=e.height;if(i){const o=t.width/2/s,a=t.height/2/n,h=t.x/s+o,l=t.y/n+a;i=ft.add(i,ft.NW),this.x0=h+o*ft.uX(i),this.y0=l+a*ft.uY(i),i=ft.add(i,2),this.x1=h+o*ft.uX(i),this.y1=l+a*ft.uY(i),i=ft.add(i,2),this.x2=h+o*ft.uX(i),this.y2=l+a*ft.uY(i),i=ft.add(i,2),this.x3=h+o*ft.uX(i),this.y3=l+a*ft.uY(i)}else this.x0=t.x/s,this.y0=t.y/n,this.x1=(t.x+t.width)/s,this.y1=t.y/n,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/n,this.x3=t.x/s,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}oa.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Gc=new oa;function Vn(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class k extends vr{constructor(t,e,i,s,n,o,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Z(0,0,1,1)),t instanceof k&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=Gc,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new j(o.x,o.y):new j(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Gt[e.url]&&k.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,k.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new k(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Gc&&(this._uvs=new oa),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=U.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else if(t instanceof K){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Li()}`,K.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Li()}`}n=t._pixiId}let o=Gt[n];if(s&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof K)?(e.resolution||(e.resolution=ii(t)),o=new k(new K(t,e)),o.baseTexture.cacheId=n,K.addToCache(o.baseTexture,n),k.addToCache(o,n)):!o&&t instanceof K&&(o=new k(t),k.addToCache(o,n)),o}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=k.from(t,Object.assign({resourceOptions:i},e),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,i,s){return new k(K.fromBuffer(t,e,i,s))}static fromLoader(t,e,i,s){const n=new K(t,Object.assign({scaleMode:K.defaultOptions.scaleMode,resolution:ii(e)},s)),{resource:o}=n;o instanceof Hl&&(o.url=e);const a=new k(n);return i||(i=e),K.addToCache(a.baseTexture,i),k.addToCache(a,i),i!==e&&(K.addToCache(a.baseTexture,e),k.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Gt[e]&&Gt[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Gt[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Gt[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Gt[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Gt[t.textureCacheIds[e]]===t&&delete Gt[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:s,height:n}=t,o=e+s>this.baseTexture.width,a=i+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,u=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${u}`)}this.valid=s&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return k._EMPTY||(k._EMPTY=new k(new K),Vn(k._EMPTY),Vn(k._EMPTY.baseTexture)),k._EMPTY}static get WHITE(){if(!k._WHITE){const t=U.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),k._WHITE=new k(K.from(t)),Vn(k._WHITE),Vn(k._WHITE.baseTexture)}return k._WHITE}}class $i extends k{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const s=this.baseTexture.resolution,n=Math.round(t*s)/s,o=Math.round(e*s)/s;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new $i(new zl(t))}}class $l{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=Tt.NONE){const s=new zl(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new $i(s)}getOptimalTexture(t,e,i=1,s=Tt.NONE){let n;t=Math.max(Math.ceil(t*i-1e-6),1),e=Math.max(Math.ceil(e*i-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Ys(t),e=Ys(e),n=((t&65535)<<16|e&65535)>>>0,s>1&&(n+=s*4294967296)):n=s>1?-s:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,s)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,e,i){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||Tt.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}$l.SCREEN_KEY=-1;class Of extends mi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Vl extends mi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new yt(this.vertices),this.uvBuffer=new yt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,s=0;return this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+e.width/t.width,this.uvs[3]=s,this.uvs[4]=i+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=i,this.uvs[7]=s+e.height/t.height,i=e.x,s=e.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+e.width,this.vertices[3]=s,this.vertices[4]=i+e.width,this.vertices[5]=s+e.height,this.vertices[6]=i,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Lf{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Tt.NONE,this.sourceFrame=new Z,this.destinationFrame=new Z,this.bindingSourceFrame=new Z,this.bindingDestinationFrame=new Z,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Xn=[new j,new j,new j,new j],Xa=new ut;class Xl{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new $l,this.statePool=[],this.quad=new Of,this.quadUv=new Vl,this.tempRect=new Z,this.activeState={},this.globalUniforms=new ye({outputFrame:new Z,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,s=this.defaultFilterStack,n=this.statePool.pop()||new Lf,o=i.renderTexture;let a,h;if(o.current){const g=o.current;a=g.resolution,h=g.multisample}else a=i.resolution,h=i.multisample;let l=e[0].resolution||a,u=e[0].multisample??h,c=e[0].padding,d=e[0].autoFit,f=e[0].legacy??!0;for(let g=1;g<e.length;g++){const y=e[g];l=Math.min(l,y.resolution||a),u=Math.min(u,y.multisample??h),c=this.useMaxPadding?Math.max(c,y.padding):c+y.padding,d=d&&y.autoFit,f=f||(y.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),s.push(n),n.resolution=l,n.multisample=u,n.legacy=f,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(c);const p=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Xa.copyFrom(i.projection.transform).invert(),p),d?(n.sourceFrame.fit(p),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(p)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,l,u),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const m=this.tempRect;m.x=0,m.y=0,m.width=n.sourceFrame.width,m.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,m),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const n=s.inputSize,o=s.inputPixel,a=s.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const l=s.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,h.renderTexture,Ce.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,e.resolution);u.filterFrame=l.filterFrame;let c=0;for(c=0;c<i.length-1;++c){c===1&&e.multisample>1&&(u=this.getOptimalFilterTexture(l.width,l.height,e.resolution),u.filterFrame=l.filterFrame),i[c].apply(this,l,u,Ce.CLEAR,e);const d=l;l=u,u=d}i[c].apply(this,l,h.renderTexture,Ce.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Ce.CLEAR){const{renderTexture:i,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=s.stateId&1||this.forceClear;(e===Ce.CLEAR||e===Ce.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,s){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Pe.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Pe.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:s}=this.activeState,{orig:n}=e._texture,o=t.set(s.width,0,0,s.height,i.x,i.y),a=e.worldTransform.copyTo(ut.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,s=Tt.NONE){return this.texturePool.getOptimalTexture(t,e,i,s)}getFilterTexture(t,e,i){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||Tt.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=Xn[0],s=Xn[1],n=Xn[2],o=Xn[3];i.set(e.left,e.top),s.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(i,i),t.apply(s,s),t.apply(n,n),t.apply(o,o);const a=Math.min(i.x,s.x,n.x,o.x),h=Math.min(i.y,s.y,n.y,o.y),l=Math.max(i.x,s.x,n.x,o.x),u=Math.max(i.y,s.y,n.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=u-h}roundFrame(t,e,i,s,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?Xa.copyFrom(n):Xa.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}Xl.extension={type:N.RendererSystem,name:"filter"};$.add(Xl);class kf{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Tt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Hv=new Z;class Wl{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Do(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Z,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;U.PREFER_ENV===zi.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:s}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>i,a=e.height>>i,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,s){const n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),s=Math.round(s),(n.width!==i||n.height!==s||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=i,n.height=s,this.gl.viewport(t,e,i,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,s,n=wo.COLOR|wo.DEPTH){const{gl:o}=this;o.clearColor(t,e,i,s),o.clear(n)}initFramebuffer(t){const{gl:e}=this,i=new kf(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){e.bindRenderbuffer(e.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=e.DEPTH_STENCIL:t.depth&&t.stencil?o=e.DEPTH24_STENCIL8:t.depth?o=e.DEPTH_COMPONENT24:o=e.STENCIL_INDEX8,i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,o,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,o,t.width,t.height)}const s=t.colorTextures;let n=s.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=s[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,s=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;i.drawBuffers||(o=Math.min(o,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||i.createRenderbuffer():s.msaaBuffer&&(i.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=n[h],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),h===0&&s.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,s.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,l.target,u._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+h))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||i.createRenderbuffer();let h,l;this.renderer.context.webGLVersion===1?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH_STENCIL):t.depth&&t.stencil?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH24_STENCIL8):t.depth?(h=i.DEPTH_ATTACHMENT,l=i.DEPTH_COMPONENT24):(h=i.STENCIL_ATTACHMENT,l=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,l,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,l,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,h,i.RENDERBUFFER,s.stencil)}else s.stencil&&(i.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=Tt.NONE;if(t<=1||e===null)return i;for(let s=0;s<e.length;s++)if(e[s]<=t){i=e[s];break}return i===1&&(i=Tt.NONE),i}blit(t,e,i){const{current:s,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!s)return;const h=s.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const u=s.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new Do(s.width,s.height),h.blitFramebuffer.addColorTexture(0,u)),t=h.blitFramebuffer,t.colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=Hv,e.width=s.width,e.height=s.height),i||(i=e);const l=e.width===i.width&&e.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&s.deleteRenderbuffer(i.msaaBuffer),i.stencil&&s.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const i=t.width,s=t.height,n=this.gl,o=e.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o);let a,h;this.renderer.context.webGLVersion===1?(a=n.DEPTH_STENCIL_ATTACHMENT,h=n.DEPTH_STENCIL):t.depth?(a=n.DEPTH_STENCIL_ATTACHMENT,h=n.DEPTH24_STENCIL8):(a=n.STENCIL_ATTACHMENT,h=n.STENCIL_INDEX8),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,h,i,s):n.renderbufferStorage(n.RENDERBUFFER,h,i,s),n.framebufferRenderbuffer(n.FRAMEBUFFER,a,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Z}destroy(){this.renderer=null}}Wl.extension={type:N.RendererSystem,name:"framebuffer"};$.add(Wl);const Wa={5126:4,5123:2,5121:1};class jl{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;U.PREFER_ENV===zi.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=s=>i.bindVertexArrayOES(s),t.deleteVertexArray=s=>i.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(s,n)=>i.vertexAttribDivisorANGLE(s,n),t.drawElementsInstanced=(s,n,o,a,h)=>i.drawElementsInstancedANGLE(s,n,o,a,h),t.drawArraysInstanced=(s,n,o,a)=>i.drawArraysInstancedANGLE(s,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},n=!0);const o=s[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const s=t.buffers[i];e.update(s)}}checkCompatibility(t,e){const i=t.attributes,s=e.attributeData;for(const n in s)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const i=t.attributes,s=e.attributeData,n=["g",t.id];for(const o in i)s[o]&&n.push(o,s[o].location);return n.join("-")}initGeometryVao(t,e,i=!0){const s=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let u=l[h];if(u)return l[a.id]=u,u;const c=t.buffers,d=t.attributes,f={},p={};for(const m in c)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*Wa[d[m].type];for(const m in d){const g=d[m],y=g.size;g.stride===void 0&&(f[g.buffer]===y*Wa[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=p[g.buffer],p[g.buffer]+=y*Wa[g.type])}u=s.createVertexArray(),s.bindVertexArray(u);for(let m=0;m<c.length;m++){const g=c[m];o.bind(g),i&&g._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=u,l[h]=u,s.bindVertexArray(null),o.unbind(Fe.ARRAY_BUFFER),u}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(n[h],e))}if(!e){for(const h in i)if(h[0]==="g"){const l=i[h];this._activeVao===l&&this.unbind(),s.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,s=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in a){const u=a[l],c=o[u.buffer],d=c._glBuffers[s];if(e.attributeData[l]){h!==d&&(n.bind(c),h=d);const f=e.attributeData[l].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,s){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(i||0)*a,s||1):n.drawElements(t,e||o.indexBuffer.data.length,h,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,e||o.getSize(),s||1):n.drawArrays(t,i,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}jl.extension={type:N.RendererSystem,name:"geometry"};$.add(jl);const zc=new ut;class aa{constructor(t,e){this._texture=t,this.mapCoord=new ut,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let s=0;s<t.length;s+=2){const n=t[s],o=t[s+1];e[s]=n*i.a+o*i.c+i.tx,e[s+1]=n*i.b+o*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const s=e.orig,n=e.trim;n&&(zc.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(zc));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var $v=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Vv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Nf extends tt{constructor(t,e,i){let s=null;typeof t!="string"&&e===void 0&&i===void 0&&(s=t,t=void 0,e=void 0,i=void 0),super(t||Vv,e||$v,i),this.maskSprite=s,this.maskMatrix=new ut}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,s){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new aa(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,i,s))}}class Uf{constructor(t=null){this.type=Ct.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=tt.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Ct.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Yl{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const n=this.maskDataPool.pop()||new Uf;n.pooled=!0,n.maskObject=e,i=n}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==Ct.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Ct.SCISSOR:this.renderer.scissor.push(i);break;case Ct.STENCIL:this.renderer.stencil.push(i);break;case Ct.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Ct.COLOR:this.pushColorMask(i);break}i.type===Ct.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Ct.SCISSOR:this.renderer.scissor.pop(e);break;case Ct.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ct.SPRITE:this.popSpriteMask(e);break;case Ct.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Ct.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Ct.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Ct.SCISSOR:t.type=Ct.STENCIL:t.type=Ct.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new Nf])),s[0].resolution=t.resolution,s[0].multisample=t.multisample,s[0].maskSprite=e;const n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,s),i.filterArea=n,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}Yl.extension={type:N.RendererSystem,name:"mask"};$.add(Yl);class Gf{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==i&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Hc=new ut,$c=[],zf=class ho extends Gf{constructor(t){super(t),this.glConst=U.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:s}=this,n=s.renderTexture,o=i.getBounds(!0,$c.pop()??new Z);this.roundFrameToPixels(o,n.current?n.current.resolution:s.resolution,n.sourceFrame,n.destinationFrame,s.projection.transform),e&&o.fit(e),t._scissorRectLocal=o}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:s,d:n}=t;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||ho.isMatrixRotated(e.worldTransform)||ho.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,s,n){ho.isMatrixRotated(n)||(n=n?Hc.copyFrom(n):Hc.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(n,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&$c.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};zf.extension={type:N.RendererSystem,name:"scissor"};let Hf=zf;$.add(Hf);class ql extends Gf{constructor(t){super(t),this.glConst=U.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,s,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=i?i._colorMask:15;s!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(i._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}ql.extension={type:N.RendererSystem,name:"stencil"};$.add(ql);class Kl{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Y("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return Y("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return Y("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Kl.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"_plugin"};$.add(Kl);class Zl{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ut,this.transform=null}update(t,e,i,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,s),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,s){const n=this.projectionMatrix,o=s?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Zl.extension={type:N.RendererSystem,name:"projection"};$.add(Zl);const Xv=new wn,Vc=new Z;class Ql{constructor(t){this.renderer=t,this._tempMatrix=new ut}generateTexture(t,e){const{region:i,...s}=e||{},n=(i==null?void 0:i.copyTo(Vc))||t.getLocalBounds(Vc,!0),o=s.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/o),n.height=Math.max(n.height,1/o),s.width=n.width,s.height=n.height,s.resolution=o,s.multisample??(s.multisample=this.renderer.multisample);const a=$i.create(s);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const h=t.transform;return t.transform=Xv,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=h,a}destroy(){}}Ql.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"textureGenerator"};$.add(Ql);const Xi=new Z,xs=new Z;class Jl{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Z,this.destinationFrame=new Z,this.viewportFrame=new Z}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){const s=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(Xi.width=t.frame.width,Xi.height=t.frame.height,e=Xi),i||(xs.x=t.frame.x,xs.y=t.frame.y,xs.width=e.width,xs.height=e.height,i=xs),o=n.framebuffer):(a=s.resolution,e||(Xi.width=s._view.screen.width,Xi.height=s._view.screen.height,e=Xi),i||(i=Xi,i.width=e.width,i.height=e.height));const h=this.viewportFrame;h.x=i.x*a,h.y=i.y*a,h.width=i.width*a,h.height=i.height*a,t||(h.y=s.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=st.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:h,y:l,width:u,height:c}=this.viewportFrame;h=Math.round(h),l=Math.round(l),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,u,c)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Jl.extension={type:N.RendererSystem,name:"renderTexture"};$.add(Jl);class Wv{}class $f{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function jv(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const n=t.getActiveAttrib(r,s);if(n.name.startsWith("gl_"))continue;const o=Ff(t,n.type),a={type:o,name:n.name,size:Mf(o),location:t.getAttribLocation(r,n.name)};e[n.name]=a}return e}function Yv(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let s=0;s<i;s++){const n=t.getActiveUniform(r,s),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=Ff(t,n.type);e[o]={name:o,index:s,type:h,size:n.size,isArray:a,value:Pf(h,n.size)}}return e}function Vf(r,t){var a;const e=Oc(r,r.VERTEX_SHADER,t.vertexSrc),i=Oc(r,r.FRAGMENT_SHADER,t.fragmentSrc),s=r.createProgram();r.attachShader(s,e),r.attachShader(s,i);const n=(a=t.extra)==null?void 0:a.transformFeedbackVaryings;if(n&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(s,n.names,n.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||Fv(r,s,e,i),t.attributeData=jv(s,r),t.uniformData=Yv(s,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((l,u)=>l>u?1:-1);for(let l=0;l<h.length;l++)t.attributeData[h[l]].location=l,r.bindAttribLocation(s,l,h[l]);r.linkProgram(s)}r.deleteShader(e),r.deleteShader(i);const o={};for(const h in t.uniformData){const l=t.uniformData[h];o[h]={location:r.getUniformLocation(s,h),value:Pf(l.type,l.size)}}return new $f(s,o)}function qv(r,t,e,i,s){e.buffer.update(s)}const Kv={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Xf={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Wf(r){const t=r.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,i=0,s=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=Xf[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,i%e!==0&&i<16){const a=i%e%16;i+=a,s+=a}i+e>16?(s=Math.ceil(s/16)*16,o.offset=s,s+=e,i=e):(o.offset=s,i+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function jf(r,t){const e=[];for(const i in r)t[i]&&e.push(t[i]);return e.sort((i,s)=>i.index-s.index),e}function Yf(r,t){if(!r.autoManage)return{size:0,syncFunc:qv};const e=jf(r.uniforms,t),{uboElements:i,size:s}=Wf(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],h=r.uniforms[a.data.name],l=a.data.name;let u=!1;for(let c=0;c<lr.length;c++){const d=lr[c];if(d.codeUbo&&d.test(a.data,h)){n.push(`offset = ${a.offset/4};`,lr[c].codeUbo(a.data.name,h)),u=!0;break}}if(!u)if(a.data.size>1){const c=Mf(a.data.type),d=Math.max(Xf[a.data.type]/16,1),f=c/d,p=(4-f%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const c=Kv[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${c};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let Zv=0;const Wn={textureCount:0,uboCount:0};class tu{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Zv++}systemCheck(){if(!Df())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,s=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(s.program)),e||(Wn.textureCount=0,Wn.uboCount=0,this.syncUniformGroup(t.uniformGroup,Wn)),s}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Iv(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const s=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),s(i.uniformData,t.uniforms,this.renderer,Wn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=Yf(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const s=t.uniforms,n=[`${i}-`];for(const o in s)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,s=Vf(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}tu.extension={type:N.RendererSystem,name:"shader"};$.add(tu);class Js{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.4.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Js.defaultOptions={hello:!1},Js.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"startup"};$.add(Js);function Qv(r,t=[]){return t[W.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.ADD]=[r.ONE,r.ONE],t[W.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.NONE]=[0,0],t[W.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[W.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[W.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[W.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[W.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[W.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[W.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[W.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[W.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[W.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[W.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}const Jv=0,tx=1,ex=2,ix=3,rx=4,sx=5,qf=class Uh{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=W.NONE,this._blendEq=!1,this.map=[],this.map[Jv]=this.setBlend,this.map[tx]=this.setOffset,this.map[ex]=this.setCullFace,this.map[ix]=this.setDepthTest,this.map[rx]=this.setFrontFace,this.map[sx]=this.setDepthMask,this.checks=[],this.defaultState=new Le,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=Qv(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Uh.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Uh.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};qf.extension={type:N.RendererSystem,name:"state"};let Kf=qf;$.add(Kf);class Zf extends vr{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),i=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of i)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new he(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const s in this.runners)this.runners[s].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(s=>{const n=i.find(o=>this._systemsHash[o]===s);s[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Es=class lo{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=lo.defaultMaxIdle,this.checkCountMax=lo.defaultCheckCountMax,this.mode=lo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==ea.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let s=0;s<e.length;s++){const n=e[s];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[s]=null,i=!0)}if(i){let s=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[s++]=e[n]);e.length=s}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};Es.defaultMode=ea.AUTO,Es.defaultMaxIdle=60*60,Es.defaultCheckCountMax=60*10,Es.extension={type:N.RendererSystem,name:"textureGC"};let wi=Es;$.add(wi);class uo{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=X.UNSIGNED_BYTE,this.internalFormat=F.RGBA,this.samplerType=0}}function nx(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[r.RGB]:G.FLOAT,[r.RGBA]:G.FLOAT,[r.ALPHA]:G.FLOAT,[r.LUMINANCE]:G.FLOAT,[r.LUMINANCE_ALPHA]:G.FLOAT,[r.R8]:G.FLOAT,[r.R8_SNORM]:G.FLOAT,[r.RG8]:G.FLOAT,[r.RG8_SNORM]:G.FLOAT,[r.RGB8]:G.FLOAT,[r.RGB8_SNORM]:G.FLOAT,[r.RGB565]:G.FLOAT,[r.RGBA4]:G.FLOAT,[r.RGB5_A1]:G.FLOAT,[r.RGBA8]:G.FLOAT,[r.RGBA8_SNORM]:G.FLOAT,[r.RGB10_A2]:G.FLOAT,[r.RGB10_A2UI]:G.FLOAT,[r.SRGB8]:G.FLOAT,[r.SRGB8_ALPHA8]:G.FLOAT,[r.R16F]:G.FLOAT,[r.RG16F]:G.FLOAT,[r.RGB16F]:G.FLOAT,[r.RGBA16F]:G.FLOAT,[r.R32F]:G.FLOAT,[r.RG32F]:G.FLOAT,[r.RGB32F]:G.FLOAT,[r.RGBA32F]:G.FLOAT,[r.R11F_G11F_B10F]:G.FLOAT,[r.RGB9_E5]:G.FLOAT,[r.R8I]:G.INT,[r.R8UI]:G.UINT,[r.R16I]:G.INT,[r.R16UI]:G.UINT,[r.R32I]:G.INT,[r.R32UI]:G.UINT,[r.RG8I]:G.INT,[r.RG8UI]:G.UINT,[r.RG16I]:G.INT,[r.RG16UI]:G.UINT,[r.RG32I]:G.INT,[r.RG32UI]:G.UINT,[r.RGB8I]:G.INT,[r.RGB8UI]:G.UINT,[r.RGB16I]:G.INT,[r.RGB16UI]:G.UINT,[r.RGB32I]:G.INT,[r.RGB32UI]:G.UINT,[r.RGBA8I]:G.INT,[r.RGBA8UI]:G.UINT,[r.RGBA16I]:G.INT,[r.RGBA16UI]:G.UINT,[r.RGBA32I]:G.INT,[r.RGBA32UI]:G.UINT,[r.DEPTH_COMPONENT16]:G.FLOAT,[r.DEPTH_COMPONENT24]:G.FLOAT,[r.DEPTH_COMPONENT32F]:G.FLOAT,[r.DEPTH_STENCIL]:G.FLOAT,[r.DEPTH24_STENCIL8]:G.FLOAT,[r.DEPTH32F_STENCIL8]:G.FLOAT}:t={[r.RGB]:G.FLOAT,[r.RGBA]:G.FLOAT,[r.ALPHA]:G.FLOAT,[r.LUMINANCE]:G.FLOAT,[r.LUMINANCE_ALPHA]:G.FLOAT,[r.DEPTH_STENCIL]:G.FLOAT},t}function ox(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[X.UNSIGNED_BYTE]:{[F.RGBA]:r.RGBA8,[F.RGB]:r.RGB8,[F.RG]:r.RG8,[F.RED]:r.R8,[F.RGBA_INTEGER]:r.RGBA8UI,[F.RGB_INTEGER]:r.RGB8UI,[F.RG_INTEGER]:r.RG8UI,[F.RED_INTEGER]:r.R8UI,[F.ALPHA]:r.ALPHA,[F.LUMINANCE]:r.LUMINANCE,[F.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[X.BYTE]:{[F.RGBA]:r.RGBA8_SNORM,[F.RGB]:r.RGB8_SNORM,[F.RG]:r.RG8_SNORM,[F.RED]:r.R8_SNORM,[F.RGBA_INTEGER]:r.RGBA8I,[F.RGB_INTEGER]:r.RGB8I,[F.RG_INTEGER]:r.RG8I,[F.RED_INTEGER]:r.R8I},[X.UNSIGNED_SHORT]:{[F.RGBA_INTEGER]:r.RGBA16UI,[F.RGB_INTEGER]:r.RGB16UI,[F.RG_INTEGER]:r.RG16UI,[F.RED_INTEGER]:r.R16UI,[F.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[X.SHORT]:{[F.RGBA_INTEGER]:r.RGBA16I,[F.RGB_INTEGER]:r.RGB16I,[F.RG_INTEGER]:r.RG16I,[F.RED_INTEGER]:r.R16I},[X.UNSIGNED_INT]:{[F.RGBA_INTEGER]:r.RGBA32UI,[F.RGB_INTEGER]:r.RGB32UI,[F.RG_INTEGER]:r.RG32UI,[F.RED_INTEGER]:r.R32UI,[F.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[X.INT]:{[F.RGBA_INTEGER]:r.RGBA32I,[F.RGB_INTEGER]:r.RGB32I,[F.RG_INTEGER]:r.RG32I,[F.RED_INTEGER]:r.R32I},[X.FLOAT]:{[F.RGBA]:r.RGBA32F,[F.RGB]:r.RGB32F,[F.RG]:r.RG32F,[F.RED]:r.R32F,[F.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[X.HALF_FLOAT]:{[F.RGBA]:r.RGBA16F,[F.RGB]:r.RGB16F,[F.RG]:r.RG16F,[F.RED]:r.R16F},[X.UNSIGNED_SHORT_5_6_5]:{[F.RGB]:r.RGB565},[X.UNSIGNED_SHORT_4_4_4_4]:{[F.RGBA]:r.RGBA4},[X.UNSIGNED_SHORT_5_5_5_1]:{[F.RGBA]:r.RGB5_A1},[X.UNSIGNED_INT_2_10_10_10_REV]:{[F.RGBA]:r.RGB10_A2,[F.RGBA_INTEGER]:r.RGB10_A2UI},[X.UNSIGNED_INT_10F_11F_11F_REV]:{[F.RGB]:r.R11F_G11F_B10F},[X.UNSIGNED_INT_5_9_9_9_REV]:{[F.RGB]:r.RGB9_E5},[X.UNSIGNED_INT_24_8]:{[F.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[X.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[F.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:t={[X.UNSIGNED_BYTE]:{[F.RGBA]:r.RGBA,[F.RGB]:r.RGB,[F.ALPHA]:r.ALPHA,[F.LUMINANCE]:r.LUMINANCE,[F.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[X.UNSIGNED_SHORT_5_6_5]:{[F.RGB]:r.RGB},[X.UNSIGNED_SHORT_4_4_4_4]:{[F.RGBA]:r.RGBA},[X.UNSIGNED_SHORT_5_5_5_1]:{[F.RGBA]:r.RGBA}},t}class eu{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new K,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=ox(t),this.samplerTypes=nx(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const i=new uo(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new uo(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<i.length;s++)i[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<i.length;s++)i[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:s}=this;if(i)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[s].samplerType!==G.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new uo(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i;e.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??G.FLOAT,this.webGLVersion===2&&t.type===X.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),(s=t.resource)==null?void 0:s.upload(i,t,e))e.samplerType!==G.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=i.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&hr(this.managedTextures,s,1)}}updateTextureStyle(t){var i;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Oe.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=ti.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==Oe.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Re.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Re.LINEAR){const n=Math.min(t.anisotropicLevel,i.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Re.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Re.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}eu.extension={type:N.RendererSystem,name:"texture"};$.add(eu);class iu{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:s}=this;e&&s.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:s}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[s]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(a,e))}i&&(e||s.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}iu.extension={type:N.RendererSystem,name:"transformFeedback"};$.add(iu);class tn{constructor(t){this.renderer=t}init(t){this.screen=new Z(0,0,t.width,t.height),this.element=t.view||U.ADAPTER.createCanvas(),this.resolution=t.resolution||U.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=i,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",i,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}tn.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},tn.extension={type:[N.RendererSystem,N.CanvasRendererSystem],name:"_view"};$.add(tn);U.PREFER_ENV=zi.WEBGL2;U.STRICT_TEXTURE_CACHE=!1;U.RENDER_OPTIONS={...Qs.defaultOptions,...Zs.defaultOptions,...tn.defaultOptions,...Js.defaultOptions};Object.defineProperties(U,{WRAP_MODE:{get(){return K.defaultOptions.wrapMode},set(r){Y("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),K.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return K.defaultOptions.scaleMode},set(r){Y("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),K.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return K.defaultOptions.mipmap},set(r){Y("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),K.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return K.defaultOptions.anisotropicLevel},set(r){Y("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),K.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return Y("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),tt.defaultResolution},set(r){tt.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return Y("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),tt.defaultMultisample},set(r){tt.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return Ti.defaultMaxTextures},set(r){Y("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Ti.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return Ti.defaultBatchSize},set(r){Y("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Ti.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return Ti.canUploadSameBuffer},set(r){Y("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Ti.canUploadSameBuffer=r}},GC_MODE:{get(){return wi.defaultMode},set(r){Y("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),wi.defaultMode=r}},GC_MAX_IDLE:{get(){return wi.defaultMaxIdle},set(r){Y("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),wi.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return wi.defaultCheckCountMax},set(r){Y("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),wi.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return Qe.defaultVertexPrecision},set(r){Y("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Qe.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return Qe.defaultFragmentPrecision},set(r){Y("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Qe.defaultFragmentPrecision=r}}});var gi=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(gi||{});class ja{constructor(t,e=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Qf=class te{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ja(null,null,1/0),this.deltaMS=1/te.targetFPMS,this.elapsedMS=1/te.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=gi.NORMAL){return this._addListener(new ja(t,e,i))}addOnce(t,e,i=gi.NORMAL){return this._addListener(new ja(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*te.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,te.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!te._shared){const t=te._shared=new te;t.autoStart=!0,t._protected=!0}return te._shared}static get system(){if(!te._system){const t=te._system=new te;t.autoStart=!0,t._protected=!0}return te._system}};Qf.targetFPMS=.06;let wt=Qf;Object.defineProperties(U,{TARGET_FPMS:{get(){return wt.targetFPMS},set(r){Y("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),wt.targetFPMS=r}}});class ru{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,gi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?wt.shared:new wt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}ru.extension=N.Application;$.add(ru);const Jf=[];$.handleByList(N.Renderer,Jf);function tp(r){for(const t of Jf)if(t.test(r))return new t(r);throw new Error("Unable to auto-detect a suitable renderer.")}var ax=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,hx=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const ep=ax,su=hx;class nu{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=Tt.HIGH?this.multisample=Tt.HIGH:e>=Tt.MEDIUM?this.multisample=Tt.MEDIUM:e>=Tt.LOW?this.multisample=Tt.LOW:this.multisample=Tt.NONE}destroy(){}}nu.extension={type:N.RendererSystem,name:"_multisample"};$.add(nu);class lx{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class ou{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){const{gl:s,CONTEXT_UID:n}=this;i=i||0;const o=t._glBuffers[n]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,o.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),i&&(e||s.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new lx(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}ou.extension={type:N.RendererSystem,name:"buffer"};$.add(ou);class au{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let s,n,o,a;if(e&&(s=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!s,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(s||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}i.renderTexture.bind(s),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),s&&(e.blit&&i.framebuffer.blit(),s.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}au.extension={type:N.RendererSystem,name:"objectRenderer"};$.add(au);const co=class Gh extends Zf{constructor(t){super(),this.type=El.WEBGL,t=Object.assign({},U.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ye({projectionMatrix:new ut},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Gh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(Y("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=Gh.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:pf()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Y("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Y("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Y("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Y("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Y("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Y("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Y("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return Y("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};co.extension={type:N.Renderer,priority:1},co.__plugins={},co.__systems={};let ha=co;$.handleByMap(N.RendererPlugin,ha.__plugins);$.handleByMap(N.RendererSystem,ha.__systems);$.add(ha);class hu extends es{constructor(t,e){const{width:i,height:s}=e||{};super(i,s),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new K;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof es?this.addResourceAt(t[i],i):this.addResourceAt(Nl(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:i}=this.items[0];return this.resize(e,i),this.update(),Promise.resolve(this)}),this._load}}class ip extends hu{constructor(t,e){const{width:i,height:s}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:i,height:s}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=nr.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:s,itemDirtyIds:n,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,e.format,i.type,null);for(let h=0;h<s;h++){const l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,i.type,l.resource.source))}return!0}}class rp extends ri{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const sp=class Ps extends hu{constructor(t,e){const{width:i,height:s,autoLoad:n,linkBaseTexture:o}=e||{};if(t&&t.length!==Ps.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:s});for(let a=0;a<Ps.SIDES;a++)this.items[a].target=nr.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=nr.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=nr.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const s=this.itemDirtyIds;for(let n=0;n<Ps.SIDES;n++){const o=this.items[n];(s[n]<o.dirtyId||i.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,i),s[n]=o.dirtyId):s[n]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),s[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Ps.SIDES}};sp.SIDES=6;let np=sp;class ir extends ri{constructor(t,e){e=e||{};let i,s,n;typeof t=="string"?(i=ir.EMPTY,s=t,n=!0):(i=t,s=null,n=!1),super(i),this.url=s,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??n,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await U.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await i.blob();if(this.destroyed)return;const n=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===jt.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return ir._EMPTY=ir._EMPTY??U.ADAPTER.createCanvas(0,0),ir._EMPTY}}const zh=class fo extends ri{constructor(t,e){e=e||{},super(U.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},fo.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;ri.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,n=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*e,n=this._overrideHeight||this._overrideWidth/e*i),s=Math.round(s),n=Math.round(n);const o=this.source;o.width=s,o.height=n,o._pixiId=`canvas_${Li()}`,o.getContext("2d").drawImage(t,0,0,e,i,0,0,s,n),this._resolve(),this._resolve=null}}static getSize(t){const e=fo.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&fo.SVG_XML.test(t)}};zh.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,zh.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Bo=zh;class ux extends ri{constructor(t){super(t)}static test(t){return!!globalThis.VideoFrame&&t instanceof globalThis.VideoFrame}}const Hh=class $h extends ri{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");e.autoLoad!==!1&&i.setAttribute("preload","auto"),e.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),e.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),e.loop===!0&&i.setAttribute("loop",""),e.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const s=t[0].src||t[0];ri.crossOrigin(i,s,e.crossorigin);for(let n=0;n<t.length;++n){const o=document.createElement("source");let{src:a,mime:h}=t[n];if(a=a||t[n],a.startsWith("data:"))h=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const l=a.split("?").shift().toLowerCase(),u=l.slice(l.lastIndexOf(".")+1);h=h||$h.MIME_TYPES[u]||`video/${u}`}o.src=a,h&&(o.type=h),i.appendChild(o)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=wt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,i)=>{this.valid?e(this):(this._resolve=e,this._reject=i,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(wt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(wt.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(wt.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||$h.TYPES.includes(e)}};Hh.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Hh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let lu=Hh;Io.push(ir,Hl,rp,lu,ux,Bo,xn,np,ip);class cx{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new he("disposeTransformFeedback")}bindBuffer(t,e){this.buffers[t]=e}destroy(){this.disposeRunner.emit(this,!1)}}const uu="7.4.2";class en{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Z.EMPTY:(t=t||new Z(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:s,c:n,d:o,tx:a,ty:h}=t,l=i*e.x+n*e.y+a,u=s*e.x+o*e.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(t){let e=this.minX,i=this.minY,s=this.maxX,n=this.maxY,o=t[0],a=t[1];e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[2],a=t[3],e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[4],a=t[5],e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[6],a=t[7],e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,this.minX=e,this.minY=i,this.maxX=s,this.maxY=n}addFrame(t,e,i,s,n){this.addFrameMatrix(t.worldTransform,e,i,s,n)}addFrameMatrix(t,e,i,s,n){const o=t.a,a=t.b,h=t.c,l=t.d,u=t.tx,c=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=o*e+h*i+u,y=a*e+l*i+c;d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*s+h*i+u,y=a*s+l*i+c,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*e+h*n+u,y=a*e+l*n+c,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*s+h*n+u,y=a*s+l*n+c,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(t,e,i){let s=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let h=e;h<i;h+=2){const l=t[h],u=t[h+1];s=l<s?l:s,n=u<n?u:n,o=l>o?l:o,a=u>a?u:a}this.minX=s,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,e,i,s){this.addVerticesMatrix(t.worldTransform,e,i,s)}addVerticesMatrix(t,e,i,s,n=0,o=n){const a=t.a,h=t.b,l=t.c,u=t.d,c=t.tx,d=t.ty;let f=this.minX,p=this.minY,m=this.maxX,g=this.maxY;for(let y=i;y<s;y+=2){const v=e[y],_=e[y+1],x=a*v+l*_+c,b=u*_+h*v+d;f=Math.min(f,x-n),m=Math.max(m,x+n),p=Math.min(p,b-o),g=Math.max(g,b+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=g}addBounds(t){const e=this.minX,i=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&s<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=s<h?s:h,this.maxX=n>l?n:l,this.maxY=o>u?o:u}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&s<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=s<h?s:h,this.maxX=n>l?n:l,this.maxY=o>u?o:u}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,s,n,o){t-=n,e-=o,i+=n,s+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class ct extends vr{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new wn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new en,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const s=e[i];Object.defineProperty(ct.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Z),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Z),t=this._localBoundsRect),this._localBounds||(this._localBounds=new en);const e=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,s){return e&&(t=e.toGlobal(t,i,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,i=1,s=1,n=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=s||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new op),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Cf}set angle(t){this.transform.rotation=t*is}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class op extends ct{constructor(){super(...arguments),this.sortDirty=null}}ct.prototype.displayObjectUpdateTransform=ct.prototype.updateTransform;const dx=new ut;function fx(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}const ap=class Vh extends ct{constructor(){super(),this.children=[],this.sortableChildren=Vh.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),s=this.getChildIndex(e);this.children[i]=e,this.children[s]=t,this.onChildrenChange(i<s?i:s)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);hr(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,hr(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,hr(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,s=e,n=s-i;let o;if(n>0&&n<=s){o=this.children.splice(i,n);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(fx),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let s=0,n=this.children.length;s<n;++s){const o=this.children[s];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==Vh.prototype._render&&(i=this.getBounds(!0));const n=t.projection.transform;if(n&&(s?(s=dx.copyFrom(s),s.prepend(n)):s=n),i&&e.intersects(i,s))this._render(t);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const h=this.children[o],l=h.cullable;h.cullable=l||!this.cullArea,h.render(t),h.cullable=l}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(t)}}renderAdvanced(t){var n,o,a;const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let h=0;h<e.length;h++)e[h].enabled&&this._enabledFilters.push(e[h])}const s=e&&((n=this._enabledFilters)==null?void 0:n.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Ct.NONE));if(s&&t.batch.flush(),e&&((o=this._enabledFilters)!=null&&o.length)&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let h=0,l=this.children.length;h<l;++h)this.children[h].render(t)}s&&t.batch.flush(),i&&t.mask.pop(this),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<i.length;++s)i[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};ap.defaultSortableChildren=!1;let Wt=ap;Wt.prototype.containerUpdateTransform=Wt.prototype.updateTransform;Object.defineProperties(U,{SORTABLE_CHILDREN:{get(){return Wt.defaultSortableChildren},set(r){Y("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Wt.defaultSortableChildren=r}}});const bs=new j,px=new Uint16Array([0,1,2,0,2,3]);let ke=class hp extends Wt{constructor(t){super(),this._anchor=new Me(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new st(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=W.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||k.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=px,this.pluginName="batch",this.isSprite=!0,this._roundPixels=U.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=fi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=fi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,s=e.b,n=e.c,o=e.d,a=e.tx,h=e.ty,l=this.vertexData,u=t.trim,c=t.orig,d=this._anchor;let f=0,p=0,m=0,g=0;if(u?(p=u.x-d._x*c.width,f=p+u.width,g=u.y-d._y*c.height,m=g+u.height):(p=-d._x*c.width,f=p+c.width,g=-d._y*c.height,m=g+c.height),l[0]=i*p+n*g+a,l[1]=o*g+s*p+h,l[2]=i*f+n*g+a,l[3]=o*g+s*f+h,l[4]=i*f+n*m+a,l[5]=o*m+s*f+h,l[6]=i*p+n*m+a,l[7]=o*m+s*p+h,this._roundPixels){const y=U.RESOLUTION;for(let v=0;v<l.length;++v)l[v]=Math.round(l[v]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,s=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,h=n.c,l=n.d,u=n.tx,c=n.ty,d=-s._x*i.width,f=d+i.width,p=-s._y*i.height,m=p+i.height;if(e[0]=o*d+h*p+u,e[1]=l*p+a*d+c,e[2]=o*f+h*p+u,e[3]=l*p+a*f+c,e[4]=o*f+h*m+u,e[5]=l*m+a*f+c,e[6]=o*d+h*m+u,e[7]=l*m+a*d+c,this._roundPixels){const g=U.RESOLUTION;for(let y=0;y<e.length;++y)e[y]=Math.round(e[y]*g)/g}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new en),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Z),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,bs);const e=this._texture.orig.width,i=this._texture.orig.height,s=-e*this.anchor.x;let n=0;return bs.x>=s&&bs.x<s+e&&(n=-i*this.anchor.y,bs.y>=n&&bs.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const i=t instanceof k?t:k.from(t,e);return new hp(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=fi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=fi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||k.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};const lp=new ut;ct.prototype._cacheAsBitmap=!1;ct.prototype._cacheData=null;ct.prototype._cacheAsBitmapResolution=null;ct.prototype._cacheAsBitmapMultisample=null;class mx{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(ct.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let t;r?(this._cacheData||(this._cacheData=new mx),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});ct.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))};ct.prototype._initCachedDisplayObject=function(r){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const t=this.alpha;this.alpha=1,r.batch.flush();const e=this.getLocalBounds(new Z,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;e.pad(p)}const i=this.cacheAsBitmapResolution||r.resolution;e.ceil(i),e.width=Math.max(e.width,1/i),e.height=Math.max(e.height,1/i);const s=r.renderTexture.current,n=r.renderTexture.sourceFrame.clone(),o=r.renderTexture.destinationFrame.clone(),a=r.projection.transform,h=$i.create({width:e.width,height:e.height,resolution:i,multisample:this.cacheAsBitmapMultisample??r.multisample}),l=`cacheAsBitmap_${Li()}`;this._cacheData.textureCacheId=l,K.addToCache(h.baseTexture,l),k.addToCache(h,l);const u=this.transform.localTransform.copyTo(lp).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:h,clear:!0,transform:u,skipUpdateTransform:!1}),r.framebuffer.blit(),r.projection.transform=a,r.renderTexture.bind(s,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const c=new ke(h);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(e.x/e.width),c.anchor.y=-(e.y/e.height),c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)};ct.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))};ct.prototype._initCachedDisplayObjectCanvas=function(r){var u;if((u=this._cacheData)!=null&&u.sprite)return;const t=this.getLocalBounds(new Z,!0),e=this.alpha;this.alpha=1;const i=r.canvasContext.activeContext,s=r._projTransform,n=this.cacheAsBitmapResolution||r.resolution;t.ceil(n),t.width=Math.max(t.width,1/n),t.height=Math.max(t.height,1/n);const o=$i.create({width:t.width,height:t.height,resolution:n}),a=`cacheAsBitmap_${Li()}`;this._cacheData.textureCacheId=a,K.addToCache(o.baseTexture,a),k.addToCache(o,a);const h=lp;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=t.x,h.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:o,clear:!0,transform:h,skipUpdateTransform:!1}),r.canvasContext.activeContext=i,r._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const l=new ke(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(t.x/t.width),l.anchor.y=-(t.y/t.height),l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)};ct.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};ct.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};ct.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,K.removeFromCache(this._cacheData.textureCacheId),k.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};ct.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)};ct.prototype.name=null;Wt.prototype.getChildByName=function(r,t){for(let e=0,i=this.children.length;e<i;e++)if(this.children[e].name===r)return this.children[e];if(t)for(let e=0,i=this.children.length;e<i;e++){const s=this.children[e];if(!s.getChildByName)continue;const n=s.getChildByName(r,!0);if(n)return n}return null};ct.prototype.getGlobalPosition=function(r=new j,t=!1){return this.parent?this.parent.toGlobal(this.position,r,t):(r.x=this.position.x,r.y=this.position.y),r};var gx=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class up extends tt{constructor(t=1){super(ep,gx,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const _x={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},yx=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function vx(r){const t=_x[r],e=t.length;let i=yx,s="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<r;a++){let h=n.replace("%index%",a.toString());o=a,a>=e&&(o=r-a-1),h=h.replace("%value%",t[o].toString()),s+=h,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",r.toString()),i}const xx=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function bx(r,t){const e=Math.ceil(r/2);let i=xx,s="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<r;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(e-1)}.0`),s+=a,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",r.toString()),i}class Oo extends tt{constructor(t,e=8,i=4,s=tt.defaultResolution,n=5){const o=bx(n,t),a=vx(n);super(o,a),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=i,this.blur=e}apply(t,e,i,s){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,i,s);else{const n=t.getFilterTexture(),o=t.renderer;let a=e,h=n;this.state.blend=!1,t.applyFilter(this,a,h,Ce.CLEAR);for(let l=1;l<this.passes-1;l++){t.bindAndClear(a,Ce.BLIT),this.uniforms.uSampler=h;const u=h;h=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,i,s),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class cp extends tt{constructor(t=8,e=4,i=tt.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Oo(!0,t,e,i,s),this.blurYFilter=new Oo(!1,t,e,i,s),this.resolution=i,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,i,s){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,e,a,Ce.CLEAR),this.blurYFilter.apply(t,a,i,s),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,e,i,s):this.blurXFilter.apply(t,e,i,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var Tx=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Lo extends tt{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(su,Tx,t),this.alpha=1}_loadMatrix(t,e=!1){let i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}tint(t,e){const[i,s,n]=st.shared.setValue(t).toArray(),o=[i,0,0,0,0,0,s,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,e)}greyscale(t,e){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const i=Math.cos(t),s=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),h=i+(1-i)*o,l=o*(1-i)-a*s,u=o*(1-i)+a*s,c=o*(1-i)+a*s,d=i+o*(1-i),f=o*(1-i)-a*s,p=o*(1-i)-a*s,m=o*(1-i)+a*s,g=i+o*(1-i),y=[h,l,u,0,0,c,d,f,0,0,p,m,g,0,0,0,0,0,1,0];this._loadMatrix(y,e)}contrast(t,e){const i=(t||0)+1,s=-.5*(i-1),n=[i,0,0,0,s,0,i,0,0,s,0,0,i,0,s,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const i=t*2/3+1,s=(i-1)*-.5,n=[i,s,s,0,0,s,i,s,0,0,s,s,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,i,s,n){t=t||.2,e=e||.15,i=i||16770432,s=s||3375104;const o=st.shared,[a,h,l]=o.setValue(i).toArray(),[u,c,d]=o.setValue(s).toArray(),f=[.3,.59,.11,0,0,a,h,l,t,0,u,c,d,e,0,a-u,h-c,l-d,0,0];this._loadMatrix(f,n)}night(t,e){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,e)}predator(t,e){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Lo.prototype.grayscale=Lo.prototype.greyscale;var wx=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,Sx=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class dp extends tt{constructor(t,e){const i=new ut;t.renderable=!1,super(Sx,wx,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,e==null&&(e=20),this.scale=new j(e,e)}apply(t,e,i,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,i,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var Ax=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,Cx=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class fp extends tt{constructor(){super(Cx,Ax)}}var Ex=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class pp extends tt{constructor(t=.5,e=Math.random()){super(su,Ex,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Xh={AlphaFilter:up,BlurFilter:cp,BlurFilterPass:Oo,ColorMatrixFilter:Lo,DisplacementFilter:dp,FXAAFilter:fp,NoiseFilter:pp};Object.entries(Xh).forEach(([r,t])=>{Object.defineProperty(Xh,r,{get(){return Y("7.1.0",`filters.${r} has moved to ${r}`),t}})});class Px{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(wt.system.add(this.tickerUpdate,this,gi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(wt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Ai=new Px;class ps{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ps.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new j,this.page=new j,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,s,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class rn extends ps{constructor(){super(...arguments),this.client=new j,this.movement=new j,this.offset=new j,this.global=new j,this.screen=new j}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,s,n,o,a,h,l,u,c,d,f,p,m){throw new Error("Method not implemented.")}}class ce extends rn{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class ur extends rn{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}ur.DOM_DELTA_PIXEL=0,ur.DOM_DELTA_LINE=1,ur.DOM_DELTA_PAGE=2;const Rx=2048,Ix=new j,Ya=new j;class mp{constructor(t){this.dispatch=new vr,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,s)=>i.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let i=0,s=e.length;i<s;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Ai.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,Ix.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,n=i.length-1;s<n;s++)if(t.currentTarget=i[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=i.length-2;s>=0;s--)if(t.currentTarget=i[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const s=Array.isArray(e)?e:[e];for(let n=i.length-1;n>=0;n--)s.forEach(o=>{t.currentTarget=i[n],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let i=0;i<Rx&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,i,s,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Ai.pauseUpdate=!1),t.interactiveChildren&&t.children){const u=t.children;for(let c=u.length-1;c>=0;c--){const d=u[c],f=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,i,s,n,o||n(t,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const h=this._isInteractive(e),l=t.isInteractive();return h&&l&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!n(t,i)&&s(t,i)?l?[t]:[]:null}hitTestRecursive(t,e,i,s,n){if(this._interactivePrune(t)||n(t,i))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Ai.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const u=h[l],c=this.hitTestRecursive(u,this._isInteractive(e)?e:u.eventMode,i,s,n);if(c){if(c.length>0&&!c[c.length-1].parent)continue;const d=t.isInteractive();return(c.length>0||d)&&c.push(t),c}}}const o=this._isInteractive(e),a=t.isInteractive();return o&&s(t,i)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var i;if(t.hitArea&&(t.worldTransform.applyInverse(e,Ya),!t.hitArea.contains(Ya.x,Ya.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!((i=s.containsPoint)!=null&&i.call(s,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,o;e=e??t.type;const i=`on${e}`;(o=(n=t.currentTarget)[i])==null||o.call(n,t);const s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var h,l;if(!(t instanceof ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const i=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.overTargets);if(((h=s.overTargets)==null?void 0:h.length)>0&&n!==e.target){const u=t.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(t,u,n);if(this.dispatchEvent(c,"pointerout"),i&&this.dispatchEvent(c,"mouseout"),!e.composedPath().includes(n)){const d=this.createPointerEvent(t,"pointerleave",n);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(c)}if(n!==e.target){const u=t.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(e,u);this.dispatchEvent(c,"pointerover"),i&&this.dispatchEvent(c,"mouseover");let d=n==null?void 0:n.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==n&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),i&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var o;if(!(t instanceof ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),s=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(i,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),s&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(n),i&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",s);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.pressTargetsByButton[t.button]);let o=n;if(n&&!i.composedPath().includes(n)){let a=n;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const h=i.button===2;this.notifyTarget(i,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete s.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const h=s.clicksByButton[t.button];if(h.target===a.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=e,a.detail=h.clickCount,a.pointerType==="mouse"){const l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(i){let n=i;for(;n;)s.currentTarget=n,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){const s=this.allocateEvent(ce);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof e=="string"&&(s.type=e),s}createWheelEvent(t){const e=this.allocateEvent(ur);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const i=this.allocateEvent(ce);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof ce&&e instanceof ce&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof rn&&e instanceof rn&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(e,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let s=0,n=i.length;s<n&&!t.propagationImmediatelyStopped;s++)i[s].once&&t.currentTarget.removeListener(e,i[s].fn,void 0,!0),i[s].fn.call(i[s].context,t)}}const Mx=1,Fx={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Wh=class jh{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new mp(null),Ai.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ce(null),this.rootWheelEvent=new ur(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...jh.defaultEventFeatures},{set:(e,i,s)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),e[i]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:i}=this.renderer;this.setTargetElement(e),this.resolution=i,jh._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,s=e.length;i<s;i++){const n=e[i],o=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Ai.pointerMoved();const e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){const n=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const i=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let n=0,o=s.length;n<o;n++){const a=this.bootstrapEvent(this.rootPointerEvent,s[n]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){const n=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Ai.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Ai.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Ai.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){const s=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*n,t.y=(i-s.top)*(this.domElement.height/s.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,s=t.changedTouches.length;i<s;i++){const n=t.changedTouches[i];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,e.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=Mx),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Fx[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Wh.extension={name:"events",type:[N.RendererSystem,N.CanvasRendererSystem]},Wh.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let ko=Wh;$.add(ko);function Xc(r){return r==="dynamic"||r==="static"}const gp={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Xc(ko.defaultEventMode)},set interactive(r){Y("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??ko.defaultEventMode},set eventMode(r){this._internalInteractive=Xc(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof e=="object"?e.signal:void 0,n=typeof e=="object"?e.once===!0:!1,o=typeof t=="function"?void 0:t;r=i?`${r}capture`:r;const a=typeof t=="function"?t:t.handleEvent,h=this;s&&s.addEventListener("abort",()=>{h.off(r,a,o)}),n?h.once(r,a,o):h.on(r,a,o)},removeEventListener(r,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.off(r,t,s)},dispatchEvent(r){if(!(r instanceof ps))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};ct.mixin(gp);const _p={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};ct.mixin(_p);const Dx=9,jn=100,Bx=0,Ox=0,Wc=2,jc=1,Lx=-1e3,kx=-1e3,Nx=2;class cu{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Ie.tablet||Ie.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${jn}px`,e.style.height=`${jn}px`,e.style.position="absolute",e.style.top=`${Bx}px`,e.style.left=`${Ox}px`,e.style.zIndex=Wc.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${jc}px`,t.style.height=`${jc}px`,t.style.position="absolute",t.style.top=`${Lx}px`,t.style.left=`${kx}px`,t.style.zIndex=Nx.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}update(){const t=performance.now();if(Ie.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:i,width:s,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,l=s/o*h,u=n/a*h;let c=this.div;c.style.left=`${e}px`,c.style.top=`${i}px`,c.style.width=`${o}px`,c.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,hr(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{c=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(c.style.left=`${(m.tx+p.x*m.a)*l}px`,c.style.top=`${(m.ty+p.y*m.d)*u}px`,c.style.width=`${p.width*m.a*l}px`,c.style.height=`${p.height*m.d*u}px`):(p=f.getBounds(),this.capHitArea(p),c.style.left=`${p.x*l}px`,c.style.top=`${p.y*u}px`,c.style.width=`${p.width*l}px`,c.style.height=`${p.height*u}px`,c.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(c.title=f.accessibleTitle),c.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&c.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==c.title||f.tabIndex!==c.tabIndex)&&(c.title=f.accessibleTitle,c.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:i}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${jn}px`,e.style.height=`${jn}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Wc.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:i}=t.target,s=this.renderer.events.rootBoundary,n=Object.assign(new ps(s),{target:i});s.rootTarget=this.renderer.lastObjectRendered,e.forEach(o=>s.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Dx&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}cu.extension={name:"accessibility",type:[N.RendererPlugin,N.CanvasRendererPlugin]};$.add(cu);const yp=class Yh{constructor(t){this.stage=new Wt,t=Object.assign({forceCanvas:!1},t),this.renderer=tp(t),Yh._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,e){const i=Yh._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};yp._plugins=[];let du=yp;$.handleByList(N.Application,du._plugins);class fu{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:n}=this._resizeTo;e=s,i=n}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}fu.extension=N.Application;$.add(fu);const Yc={loader:N.LoadParser,resolver:N.ResolveParser,cache:N.CacheParser,detection:N.DetectionParser};$.handle(N.Asset,r=>{const t=r.ref;Object.entries(Yc).filter(([e])=>!!t[e]).forEach(([e,i])=>$.add(Object.assign(t[e],{extension:t[e].extension??i})))},r=>{const t=r.ref;Object.keys(Yc).filter(e=>!!t[e]).forEach(e=>$.remove(t[e]))});class Ux{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function xr(r,t){if(Array.isArray(t)){for(const e of t)if(r.startsWith(`data:${e}`))return!0;return!1}return r.startsWith(`data:${t}`)}function vi(r,t){const e=r.split("?")[0],i=It.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const pe=(r,t,e=!1)=>(Array.isArray(r)||(r=[r]),t?r.map(i=>typeof i=="string"||e?t(i):i):r),No=(r,t)=>{const e=t.split("?")[1];return e&&(r+=`?${e}`),r};function vp(r,t,e,i,s){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?vp(r.replace(i[e],a),t,e+1,i,s):s.push(r.replace(i[e],a))}}function xp(r){const t=/\{(.*?)\}/g,e=r.match(t),i=[];if(e){const s=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");s.push(o)}),vp(r,s,0,e,i)}else i.push(r);return i}const sn=r=>!Array.isArray(r);class Gx{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=pe(t);let s;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){s=h.getCacheableAssets(i,e);break}}s||(s={},i.forEach(a=>{s[a]=e}));const n=Object.keys(s),o={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,s[a])}),e instanceof k){const a=e;i.forEach(h=>{a.baseTexture!==k.EMPTY.baseTexture&&K.addToCache(a.baseTexture,h),k.addToCache(a,h)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Ci=new Gx;class zx{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let s=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,e,this))){n=l;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(t,e,this),i.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,s,e,this))&&(s=await l.parse(s,e,this)||s,i.parser=l)}return s})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const s={},n=sn(t),o=pe(t,l=>({alias:[l],src:l})),a=o.length,h=o.map(async l=>{const u=It.toAbsolute(l.src);if(!s[l.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,l)),s[l.src]=await this.promiseCache[u].promise,e&&e(++i/a)}catch(c){throw delete this.promiseCache[u],delete s[l.src],new Error(`[Loader.load] Failed to load ${u}.
${c}`)}});return await Promise.all(h),n?s[o[0].src]:s}async unload(t){const e=pe(t,i=>({alias:[i],src:i})).map(async i=>{var o,a;const s=It.toAbsolute(i.src),n=this.promiseCache[s];if(n){const h=await n.promise;delete this.promiseCache[s],(a=(o=n.parser)==null?void 0:o.unload)==null||a.call(o,h,i,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var xe=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(xe||{});const Hx=".json",$x="application/json",bp={extension:{type:N.LoadParser,priority:xe.Low},name:"loadJson",test(r){return xr(r,$x)||vi(r,Hx)},async load(r){return await(await U.ADAPTER.fetch(r)).json()}};$.add(bp);const Vx=".txt",Xx="text/plain",Tp={name:"loadTxt",extension:{type:N.LoadParser,priority:xe.Low},test(r){return xr(r,Xx)||vi(r,Vx)},async load(r){return await(await U.ADAPTER.fetch(r)).text()}};$.add(Tp);const Wx=["normal","bold","100","200","300","400","500","600","700","800","900"],jx=[".ttf",".otf",".woff",".woff2"],Yx=["font/ttf","font/otf","font/woff","font/woff2"],qx=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function wp(r){const t=It.extname(r),e=It.basename(r,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let i=e.length>0;for(const n of e)if(!n.match(qx)){i=!1;break}let s=e.join(" ");return i||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}const Kx=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Zx(r){return Kx.test(r)?r:encodeURI(r)}const Sp={extension:{type:N.LoadParser,priority:xe.Low},name:"loadWebFont",test(r){return xr(r,Yx)||vi(r,jx)},async load(r,t){var i,s,n;const e=U.ADAPTER.getFontFaceSet();if(e){const o=[],a=((i=t.data)==null?void 0:i.family)??wp(r),h=((n=(s=t.data)==null?void 0:s.weights)==null?void 0:n.filter(u=>Wx.includes(u)))??["normal"],l=t.data??{};for(let u=0;u<h.length;u++){const c=h[u],d=new FontFace(a,`url(${Zx(r)})`,{...l,weight:c});await d.load(),e.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(t=>U.ADAPTER.getFontFaceSet().delete(t))}};$.add(Sp);const Qx=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let Wr=null,qh=class{constructor(){Wr||(Wr=URL.createObjectURL(new Blob([Qx],{type:"application/javascript"}))),this.worker=new Worker(Wr)}};qh.revokeObjectURL=function(){Wr&&(URL.revokeObjectURL(Wr),Wr=null)};const Jx=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let jr=null;class Ap{constructor(){jr||(jr=URL.createObjectURL(new Blob([Jx],{type:"application/javascript"}))),this.worker=new Worker(jr)}}Ap.revokeObjectURL=function(){jr&&(URL.revokeObjectURL(jr),jr=null)};let qc=0,qa;class t1{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new qh;e.addEventListener("message",i=>{e.terminate(),qh.revokeObjectURL(),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){qa===void 0&&(qa=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<qa&&(this._createdWorkers++,t=new Ap().worker,t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((s,n)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[qc]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:qc++,id:i})}}const Kc=new t1;function ms(r,t,e){r.resource.internal=!0;const i=new k(r),s=()=>{delete t.promiseCache[e],Ci.has(e)&&Ci.remove(e)};return i.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),s())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}const e1=[".jpeg",".jpg",".png",".webp",".avif"],i1=["image/jpeg","image/png","image/webp","image/avif"];async function Cp(r){const t=await U.ADAPTER.fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const An={name:"loadTextures",extension:{type:N.LoadParser,priority:xe.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return xr(r,i1)||vi(r,e1)},async load(r,t,e){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let s;i?this.config.preferWorkers&&await Kc.isImageBitmapSupported()?s=await Kc.loadImageBitmap(r):s=await Cp(r):s=await new Promise((h,l)=>{const u=new Image;u.crossOrigin=this.config.crossOrigin,u.src=r,u.complete?h(u):(u.onload=()=>h(u),u.onerror=c=>l(c))});const n={...t.data};n.resolution??(n.resolution=ii(r)),i&&((a=n.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(n.resourceOptions={...n.resourceOptions},n.resourceOptions.ownsImageBitmap=!0);const o=new K(s,n);return o.resource.src=r,ms(o,e,r)},unload(r){r.destroy(!0)}};$.add(An);const r1=".svg",s1="image/svg+xml",Ep={extension:{type:N.LoadParser,priority:xe.High},name:"loadSVG",test(r){return xr(r,s1)||vi(r,r1)},async testParse(r){return Bo.test(r)},async parse(r,t,e){var n;const i=new Bo(r,(n=t==null?void 0:t.data)==null?void 0:n.resourceOptions);await i.load();const s=new K(i,{resolution:ii(r),...t==null?void 0:t.data});return s.resource.src=t.src,ms(s,e,t.src)},async load(r,t){return(await U.ADAPTER.fetch(r)).text()},unload:An.unload};$.add(Ep);const n1=[".mp4",".m4v",".webm",".ogv"],o1=["video/mp4","video/webm","video/ogg"],Pp={name:"loadVideo",extension:{type:N.LoadParser,priority:xe.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(r){return xr(r,o1)||vi(r,n1)},async load(r,t,e){var o;let i;const s=await(await U.ADAPTER.fetch(r)).blob(),n=URL.createObjectURL(s);try{const a={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions,autoLoad:!0},h=new lu(n,a);await h.load();const l=new K(h,{alphaMode:await ff(),resolution:ii(r),...t==null?void 0:t.data});l.resource.src=r,i=ms(l,e,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(n)})}catch(a){throw URL.revokeObjectURL(n),a}return i},unload(r){r.destroy(!0)}};$.add(Pp);class a1{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,name:i,src:s,srcs:n}=t;return pe(e||i||s||n,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(s=>{const n=s.src??s.srcs,o=s.alias??s.name;let a;if(typeof o=="string"){const h=this._createBundleAssetId(t,o);i.push(h),a=[o,h]}else{const h=o.map(l=>this._createBundleAssetId(t,l));i.push(...h),a=[...o,...h]}this.add({...s,alias:a,src:n})}):Object.keys(e).forEach(s=>{const n=[s,this._createBundleAssetId(t,s)];if(typeof e[s]=="string")this.add({alias:n,src:e[s]});else if(Array.isArray(e[s]))this.add({alias:n,src:e[s]});else{const o=e[s],a=o.src??o.srcs;this.add({...o,alias:n,src:Array.isArray(a)?a:[a]})}i.push(...n)}),this._bundles[t]=i}add(t,e,i,s,n){const o=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(Y("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:t,src:e,data:i,format:s,loadParser:n})):Array.isArray(t)?o.push(...t):o.push(t);let a;a=h=>{this.hasKey(h)&&console.warn(`[Resolver] already has key: ${h} overwriting`)},pe(o).forEach(h=>{const{src:l,srcs:u}=h;let{data:c,format:d,loadParser:f}=h;const p=pe(l||u).map(y=>typeof y=="string"?xp(y):Array.isArray(y)?y:[y]),m=this.getAlias(h);Array.isArray(m)?m.forEach(a):a(m);const g=[];p.forEach(y=>{y.forEach(v=>{let _={};if(typeof v!="object"){_.src=v;for(let x=0;x<this._parsers.length;x++){const b=this._parsers[x];if(b.test(v)){_=b.parse(v);break}}}else c=v.data??c,d=v.format??d,f=v.loadParser??f,_={..._,...v};if(!m)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this.buildResolvedAsset(_,{aliases:m,data:c,format:d,loadParser:f}),g.push(_)})}),m.forEach(y=>{this._assetMap[y]=g})})}resolveBundle(t){const e=sn(t);t=pe(t);const i={};return t.forEach(s=>{const n=this._bundles[s];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(s,h)]=l}i[s]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const s in e)i[s]=e[s].src;return i}return e.src}resolve(t){const e=sn(t);t=pe(t);const i={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s];const o=n[0],a=this._getPreferredOrder(n);a==null||a.priority.forEach(h=>{a.params[h].forEach(l=>{const u=n.filter(c=>c[h]?c[h]===l:!1);u.length&&(n=u)})}),this._resolverHash[s]=n[0]??o}else this._resolverHash[s]=this.buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],s=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:i,data:s,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=It.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??t.format??It.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class Rp{constructor(){this._detections=[],this._initialized=!1,this.resolver=new a1,this.loader=new zx,this.cache=Ci,this._backgroundLoader=new Ux(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,i,s,n){this.resolver.add(t,e,i,s,n)}async load(t,e){this._initialized||await this.init();const i=sn(t),s=pe(t).map(a=>{if(typeof a!="string"){const h=this.resolver.getAlias(a);return h.some(l=>!this.resolver.hasKey(l))&&this.add(a),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(s),o=await this._mapLoadToResolve(n,e);return i?o[s[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const s=this.resolver.resolveBundle(t),n={},o=Object.keys(s);let a=0,h=0;const l=()=>{e==null||e(++a/h)},u=o.map(c=>{const d=s[c];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[c]=f})});return await Promise.all(u),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ci.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=Ci.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const o={};return i.forEach((a,h)=>{const l=n[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[s[h]]=l,Ci.set(u,l)}),o}async unload(t){this._initialized||await this.init();const e=pe(t).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=pe(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{Ci.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,s)=>e.indexOf(i)===s),e}get detections(){return this._detections}get preferWorkers(){return An.config.preferWorkers}set preferWorkers(t){Y("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const rr=new Rp;$.handleByList(N.LoadParser,rr.loader.parsers).handleByList(N.ResolveParser,rr.resolver.parsers).handleByList(N.CacheParser,rr.cache.parsers).handleByList(N.DetectionParser,rr.detections);const Ip={extension:N.CacheParser,test:r=>Array.isArray(r)&&r.every(t=>t instanceof k),getCacheableAssets:(r,t)=>{const e={};return r.forEach(i=>{t.forEach((s,n)=>{e[i+(n===0?"":n+1)]=s})}),e}};$.add(Ip);async function Mp(r){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(r)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Fp={extension:{type:N.DetectionParser,priority:1},test:async()=>Mp("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(t=>t!=="avif")};$.add(Fp);const Dp={extension:{type:N.DetectionParser,priority:0},test:async()=>Mp("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(t=>t!=="webp")};$.add(Dp);const Zc=["png","jpg","jpeg"],Bp={extension:{type:N.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Zc],remove:async r=>r.filter(t=>!Zc.includes(t))};$.add(Bp);const h1="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function pu(r){return h1?!1:document.createElement("video").canPlayType(r)!==""}const Op={extension:{type:N.DetectionParser,priority:0},test:async()=>pu("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(t=>t!=="webm")};$.add(Op);const Lp={extension:{type:N.DetectionParser,priority:0},test:async()=>pu("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(t=>t!=="mp4"&&t!=="m4v")};$.add(Lp);const kp={extension:{type:N.DetectionParser,priority:0},test:async()=>pu("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(t=>t!=="ogv")};$.add(kp);const Np={extension:N.ResolveParser,test:An.test,parse:r=>{var t;return{resolution:parseFloat(((t=U.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:It.extname(r).slice(1),src:r}}};$.add(Np);var Ft=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r[r.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",r[r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",r[r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",r[r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",r))(Ft||{});const nn={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let He,Br;function Qc(){Br={bptc:He.getExtension("EXT_texture_compression_bptc"),astc:He.getExtension("WEBGL_compressed_texture_astc"),etc:He.getExtension("WEBGL_compressed_texture_etc"),s3tc:He.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:He.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:He.getExtension("WEBGL_compressed_texture_pvrtc")||He.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:He.getExtension("WEBGL_compressed_texture_etc1"),atc:He.getExtension("WEBGL_compressed_texture_atc")}}const Up={extension:{type:N.DetectionParser,priority:2},test:async()=>{const r=U.ADAPTER.createCanvas().getContext("webgl");return r?(He=r,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{Br||Qc();const t=[];for(const e in Br)Br[e]&&t.push(e);return[...t,...r]},remove:async r=>(Br||Qc(),r.filter(t=>!(t in Br)))};$.add(Up);class Gp extends xn{constructor(t,e={width:1,height:1,autoLoad:!0}){let i,s;typeof t=="string"?(i=t,s=new Uint8Array):(i=null,s=t),super(s,e),this.origin=i,this.buffer=s?new Ro(s):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Ro(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Di extends Gp{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Di._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Di._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,i){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;s.pixelStorei(s.UNPACK_ALIGNMENT,4);for(let n=0,o=this.levels;n<o;n++){const{levelID:a,levelWidth:h,levelHeight:l,levelBuffer:u}=this._levelBuffers[n];s.compressedTexImage2D(s.TEXTURE_2D,a,this.format,h,l,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Di._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=35916&&t<=35919)return"s3tc_sRGB";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t===36196)return"etc1";if(t===35986||t===35987||t===34798)return"atc";if(t>=36492&&t<=36495)return"bptc";if(t===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${t}`)}static _createLevelBuffers(t,e,i,s,n,o,a){const h=new Array(i);let l=t.byteOffset,u=o,c=a,d=u+s-1&~(s-1),f=c+n-1&~(n-1),p=d*f*nn[e];for(let m=0;m<i;m++)h[m]={levelID:m,levelWidth:i>1?u:d,levelHeight:i>1?c:f,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,u=u>>1||1,c=c>>1||1,d=u+s-1&~(s-1),f=c+n-1&~(n-1),p=d*f*nn[e];return h}}const Ka=4,Yn=124,l1=32,Jc=20,u1=542327876,qn={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},c1={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Kn={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},d1=1,f1=2,p1=4,m1=64,g1=512,_1=131072,y1=827611204,v1=861165636,x1=894720068,b1=808540228,T1=4,w1={[y1]:Ft.COMPRESSED_RGBA_S3TC_DXT1_EXT,[v1]:Ft.COMPRESSED_RGBA_S3TC_DXT3_EXT,[x1]:Ft.COMPRESSED_RGBA_S3TC_DXT5_EXT},S1={70:Ft.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ft.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ft.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ft.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ft.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ft.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ft.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ft.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ft.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:Ft.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:Ft.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:Ft.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:Ft.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function zp(r){const t=new Uint32Array(r);if(t[0]!==u1)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(r,0,Yn/Uint32Array.BYTES_PER_ELEMENT),i=e[qn.HEIGHT],s=e[qn.WIDTH],n=e[qn.MIPMAP_COUNT],o=new Uint32Array(r,qn.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,l1/Uint32Array.BYTES_PER_ELEMENT),a=o[d1];if(a&p1){const h=o[c1.FOURCC];if(h!==b1){const v=w1[h],_=Ka+Yn,x=new Uint8Array(r,_);return[new Di(x,{format:v,width:s,height:i,levels:n})]}const l=Ka+Yn,u=new Uint32Array(t.buffer,l,Jc/Uint32Array.BYTES_PER_ELEMENT),c=u[Kn.DXGI_FORMAT],d=u[Kn.RESOURCE_DIMENSION],f=u[Kn.MISC_FLAG],p=u[Kn.ARRAY_SIZE],m=S1[c];if(m===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${c}`);if(f===T1)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const g=new Array,y=Ka+Yn+Jc;if(p===1)g.push(new Uint8Array(r,y));else{const v=nn[m];let _=0,x=s,b=i;for(let w=0;w<n;w++){const T=Math.max(1,x+3&-4),A=Math.max(1,b+3&-4),I=T*A*v;_+=I,x=x>>>1,b=b>>>1}let C=y;for(let w=0;w<p;w++)g.push(new Uint8Array(r,C,_)),C+=_}return g.map(v=>new Di(v,{format:m,width:s,height:i,levels:n}))}throw a&m1?new Error("DDSParser does not support uncompressed texture data."):a&g1?new Error("DDSParser does not supported YUV uncompressed texture data."):a&_1?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&f1?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const td=[171,75,84,88,32,49,49,187,13,10,26,10],A1=67305985,Te={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Kh=64,Zh={[X.UNSIGNED_BYTE]:1,[X.UNSIGNED_SHORT]:2,[X.INT]:4,[X.UNSIGNED_INT]:4,[X.FLOAT]:4,[X.HALF_FLOAT]:8},Hp={[F.RGBA]:4,[F.RGB]:3,[F.RG]:2,[F.RED]:1,[F.LUMINANCE]:1,[F.LUMINANCE_ALPHA]:2,[F.ALPHA]:1},$p={[X.UNSIGNED_SHORT_4_4_4_4]:2,[X.UNSIGNED_SHORT_5_5_5_1]:2,[X.UNSIGNED_SHORT_5_6_5]:2};function Vp(r,t,e=!1){const i=new DataView(t);if(!C1(r,i))return null;const s=i.getUint32(Te.ENDIANNESS,!0)===A1,n=i.getUint32(Te.GL_TYPE,s),o=i.getUint32(Te.GL_FORMAT,s),a=i.getUint32(Te.GL_INTERNAL_FORMAT,s),h=i.getUint32(Te.PIXEL_WIDTH,s),l=i.getUint32(Te.PIXEL_HEIGHT,s)||1,u=i.getUint32(Te.PIXEL_DEPTH,s)||1,c=i.getUint32(Te.NUMBER_OF_ARRAY_ELEMENTS,s)||1,d=i.getUint32(Te.NUMBER_OF_FACES,s),f=i.getUint32(Te.NUMBER_OF_MIPMAP_LEVELS,s),p=i.getUint32(Te.BYTES_OF_KEY_VALUE_DATA,s);if(l===0||u!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");const m=4,g=4,y=h+3&-4,v=l+3&-4,_=new Array(c);let x=h*l;n===0&&(x=y*v);let b;if(n!==0?Zh[n]?b=Zh[n]*Hp[o]:b=$p[n]:b=nn[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const C=e?P1(i,p,s):null;let w=x*b,T=h,A=l,I=y,z=v,R=Kh+p;for(let S=0;S<f;S++){const P=i.getUint32(R,s);let D=R+4;for(let H=0;H<c;H++){let E=_[H];E||(E=_[H]=new Array(f)),E[S]={levelID:S,levelWidth:f>1||n!==0?T:I,levelHeight:f>1||n!==0?A:z,levelBuffer:new Uint8Array(t,D,w)},D+=w}R+=P+4,R=R%4!==0?R+4-R%4:R,T=T>>1||1,A=A>>1||1,I=T+m-1&~(m-1),z=A+g-1&~(g-1),w=I*z*b}return n!==0?{uncompressed:_.map(S=>{let P=S[0].levelBuffer,D=!1;return n===X.FLOAT?P=new Float32Array(S[0].levelBuffer.buffer,S[0].levelBuffer.byteOffset,S[0].levelBuffer.byteLength/4):n===X.UNSIGNED_INT?(D=!0,P=new Uint32Array(S[0].levelBuffer.buffer,S[0].levelBuffer.byteOffset,S[0].levelBuffer.byteLength/4)):n===X.INT&&(D=!0,P=new Int32Array(S[0].levelBuffer.buffer,S[0].levelBuffer.byteOffset,S[0].levelBuffer.byteLength/4)),{resource:new xn(P,{width:S[0].levelWidth,height:S[0].levelHeight}),type:n,format:D?E1(o):o}}),kvData:C}:{compressed:_.map(S=>new Di(null,{format:a,width:h,height:l,levels:f,levelBuffers:S})),kvData:C}}function C1(r,t){for(let e=0;e<td.length;e++)if(t.getUint8(e)!==td[e])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function E1(r){switch(r){case F.RGBA:return F.RGBA_INTEGER;case F.RGB:return F.RGB_INTEGER;case F.RG:return F.RG_INTEGER;case F.RED:return F.RED_INTEGER;default:return r}}function P1(r,t,e){const i=new Map;let s=0;for(;s<t;){const n=r.getUint32(Kh+s,e),o=Kh+s+4,a=3-(n+3)%4;if(n===0||n>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<n&&r.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=new TextDecoder().decode(new Uint8Array(r.buffer,o,h)),u=new DataView(r.buffer,o+h+1,n-h-1);i.set(l,u),s+=4+n+a}return i}const Xp={extension:{type:N.LoadParser,priority:xe.High},name:"loadDDS",test(r){return vi(r,".dds")},async load(r,t,e){const i=await(await U.ADAPTER.fetch(r)).arrayBuffer(),s=zp(i).map(n=>{const o=new K(n,{mipmap:Oe.OFF,alphaMode:jt.NO_PREMULTIPLIED_ALPHA,resolution:ii(r),...t.data});return ms(o,e,r)});return s.length===1?s[0]:s},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};$.add(Xp);const Wp={extension:{type:N.LoadParser,priority:xe.High},name:"loadKTX",test(r){return vi(r,".ktx")},async load(r,t,e){const i=await(await U.ADAPTER.fetch(r)).arrayBuffer(),{compressed:s,uncompressed:n,kvData:o}=Vp(r,i),a=s??n,h={mipmap:Oe.OFF,alphaMode:jt.NO_PREMULTIPLIED_ALPHA,resolution:ii(r),...t.data},l=a.map(u=>{a===n&&Object.assign(h,{type:u.type,format:u.format});const c=u.resource??u,d=new K(c,h);return d.ktxKeyValueData=o,ms(d,e,r)});return l.length===1?l[0]:l},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};$.add(Wp);const R1=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],jp={extension:N.ResolveParser,test:r=>{const t=It.extname(r).slice(1);return["basis","ktx","dds"].includes(t)},parse:r=>{var i,s;const t=r.split("."),e=t.pop();if(["ktx","dds"].includes(e)){const n=t.pop();if(R1.includes(n))return{resolution:parseFloat(((i=U.RETINA_PREFIX.exec(r))==null?void 0:i[1])??"1"),format:n,src:r}}return{resolution:parseFloat(((s=U.RETINA_PREFIX.exec(r))==null?void 0:s[1])??"1"),format:e,src:r}}};$.add(jp);const Zn=new Z,I1=4,Yp=class Rs{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,i,s){const n=new Image;return n.src=await this.base64(t,e,i,s),n}async base64(t,e,i,s){const n=this.canvas(t,s);if(n.toBlob!==void 0)return new Promise((o,a)=>{n.toBlob(h=>{if(!h){a(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>o(l.result),l.onerror=a,l.readAsDataURL(h)},e,i)});if(n.toDataURL!==void 0)return n.toDataURL(e,i);if(n.convertToBlob!==void 0){const o=await n.convertToBlob({type:e,quality:i});return new Promise((a,h)=>{const l=new FileReader;l.onload=()=>a(l.result),l.onerror=h,l.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:i,width:s,height:n,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);o&&Rs._flipY(i,s,n),a&&Rs._unpremultiplyAlpha(i);const h=new bf(s,n,1),l=new ImageData(new Uint8ClampedArray(i.buffer),s,n);return h.context.putImageData(l,0,0),h.canvas}pixels(t,e){const{pixels:i,width:s,height:n,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);return o&&Rs._flipY(i,s,n),a&&Rs._unpremultiplyAlpha(i),i}_rawPixels(t,e){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let s,n=!1,o=!1,a,h=!1;t&&(t instanceof $i?a=t:(a=i.generateTexture(t,{region:e,resolution:i.resolution,multisample:i.multisample}),h=!0,e&&(Zn.width=e.width,Zn.height=e.height,e=Zn)));const l=i.gl;if(a){if(s=a.baseTexture.resolution,e=e??a.frame,n=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===F.RGBA,!h){i.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else s=i.resolution,e||(e=Zn,e.width=i.width/s,e.height=i.height/s),n=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const u=Math.max(Math.round(e.width*s),1),c=Math.max(Math.round(e.height*s),1),d=new Uint8Array(I1*u*c);return l.readPixels(Math.round(e.x*s),Math.round(e.y*s),u,c,l.RGBA,l.UNSIGNED_BYTE,d),h&&(a==null||a.destroy(!0)),{pixels:d,width:u,height:c,flipY:n,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,i){const s=e<<2,n=i>>1,o=new Uint8Array(s);for(let a=0;a<n;a++){const h=a*s,l=(i-a-1)*s;o.set(t.subarray(h,h+s)),t.copyWithin(h,l,l+s),t.set(o,l)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let i=0;i<e;i+=4){const s=t[i+3];if(s!==0){const n=255.001/s;t[i]=t[i]*n+.5,t[i+1]=t[i+1]*n+.5,t[i+2]=t[i+2]*n+.5}}}};Yp.extension={name:"extract",type:N.RendererSystem};let qp=Yp;$.add(qp);const on={build(r){const t=r.points;let e,i,s,n,o,a;if(r.type===Lt.CIRC){const p=r.shape;e=p.x,i=p.y,o=a=p.radius,s=n=0}else if(r.type===Lt.ELIP){const p=r.shape;e=p.x,i=p.y,o=p.width,a=p.height,s=n=0}else{const p=r.shape,m=p.width/2,g=p.height/2;e=p.x+m,i=p.y+g,o=a=Math.max(0,Math.min(p.radius,Math.min(m,g))),s=m-o,n=g-a}if(!(o>=0&&a>=0&&s>=0&&n>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(s?4:0)+(n?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=i+n,t[2]=t[4]=e-s,t[5]=t[7]=i-n;return}let u=0,c=h*4+(s?2:0)+2,d=c,f=l;{const p=s+o,m=n,g=e+p,y=e-p,v=i+m;if(t[u++]=g,t[u++]=v,t[--c]=v,t[--c]=y,n){const _=i-m;t[d++]=y,t[d++]=_,t[--f]=_,t[--f]=g}}for(let p=1;p<h;p++){const m=Math.PI/2*(p/h),g=s+Math.cos(m)*o,y=n+Math.sin(m)*a,v=e+g,_=e-g,x=i+y,b=i-y;t[u++]=v,t[u++]=x,t[--c]=x,t[--c]=_,t[d++]=_,t[d++]=b,t[--f]=b,t[--f]=v}{const p=s,m=n+a,g=e+p,y=e-p,v=i+m,_=i-m;t[u++]=g,t[u++]=v,t[--f]=_,t[--f]=g,s&&(t[u++]=y,t[u++]=v,t[--f]=_,t[--f]=y)}},triangulate(r,t){const e=r.points,i=t.points,s=t.indices;if(e.length===0)return;let n=i.length/2;const o=n;let a,h;if(r.type!==Lt.RREC){const u=r.shape;a=u.x,h=u.y}else{const u=r.shape;a=u.x+u.width/2,h=u.y+u.height/2}const l=r.matrix;i.push(r.matrix?l.a*a+l.c*h+l.tx:a,r.matrix?l.b*a+l.d*h+l.ty:h),n++,i.push(e[0],e[1]);for(let u=2;u<e.length;u+=2)i.push(e[u],e[u+1]),s.push(n++,o,n);s.push(o+1,o,n)}};function ed(r,t=!1){const e=r.length;if(e<6)return;let i=0;for(let s=0,n=r[e-2],o=r[e-1];s<e;s+=2){const a=r[s],h=r[s+1];i+=(a-n)*(h+o),n=a,o=h}if(!t&&i>0||t&&i<=0){const s=e/2;for(let n=s+s%2;n<e;n+=2){const o=e-n-2,a=e-n-1,h=n,l=n+1;[r[o],r[h]]=[r[h],r[o]],[r[a],r[l]]=[r[l],r[a]]}}}const mu={build(r){r.points=r.shape.points.slice()},triangulate(r,t){let e=r.points;const i=r.holes,s=t.points,n=t.indices;if(e.length>=6){ed(e,!1);const o=[];for(let l=0;l<i.length;l++){const u=i[l];ed(u.points,!0),o.push(e.length/2),e=e.concat(u.points)}const a=Xd(e,o,2);if(!a)return;const h=s.length/2;for(let l=0;l<a.length;l+=3)n.push(a[l]+h),n.push(a[l+1]+h),n.push(a[l+2]+h);for(let l=0;l<e.length;l++)s.push(e[l])}}},Kp={build(r){const t=r.shape,e=t.x,i=t.y,s=t.width,n=t.height,o=r.points;o.length=0,s>=0&&n>=0&&o.push(e,i,e+s,i,e+s,i+n,e,i+n)},triangulate(r,t){const e=r.points,i=t.points;if(e.length===0)return;const s=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},Zp={build(r){on.build(r)},triangulate(r,t){on.triangulate(r,t)}};var re=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(re||{}),pi=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(pi||{});const ki={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,t=20){if(!this.adaptive||!r||isNaN(r))return t;let e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},M1=ki;class Qh{static curveTo(t,e,i,s,n,o){const a=o[o.length-2],h=o[o.length-1]-e,l=a-t,u=s-e,c=i-t,d=Math.abs(h*c-l*u);if(d<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const f=h*h+l*l,p=u*u+c*c,m=h*u+l*c,g=n*Math.sqrt(f)/d,y=n*Math.sqrt(p)/d,v=g*m/f,_=y*m/p,x=g*c+y*l,b=g*u+y*h,C=l*(y+v),w=h*(y+v),T=c*(g+_),A=u*(g+_),I=Math.atan2(w-b,C-x),z=Math.atan2(A-b,T-x);return{cx:x+t,cy:b+e,radius:n,startAngle:I,endAngle:z,anticlockwise:l*u>c*h}}static arc(t,e,i,s,n,o,a,h,l){const u=a-o,c=ki._segmentsCount(Math.abs(u)*n,Math.ceil(Math.abs(u)/Ks)*40),d=u/(c*2),f=d*2,p=Math.cos(d),m=Math.sin(d),g=c-1,y=g%1/g;for(let v=0;v<=g;++v){const _=v+y*v,x=d+o+f*_,b=Math.cos(x),C=-Math.sin(x);l.push((p*b+m*C)*n+i,(p*-C+m*b)*n+s)}}}class Qp{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class la{static curveLength(t,e,i,s,n,o,a,h){let l=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,y=0,v=0,_=0,x=t,b=e;for(let C=1;C<=10;++C)u=C/10,c=u*u,d=c*u,f=1-u,p=f*f,m=p*f,g=m*t+3*p*u*i+3*f*c*n+d*a,y=m*e+3*p*u*s+3*f*c*o+d*h,v=x-g,_=b-y,x=g,b=y,l+=Math.sqrt(v*v+_*_);return l}static curveTo(t,e,i,s,n,o,a){const h=a[a.length-2],l=a[a.length-1];a.length-=2;const u=ki._segmentsCount(la.curveLength(h,l,t,e,i,s,n,o));let c=0,d=0,f=0,p=0,m=0;a.push(h,l);for(let g=1,y=0;g<=u;++g)y=g/u,c=1-y,d=c*c,f=d*c,p=y*y,m=p*y,a.push(f*h+3*d*y*t+3*c*p*i+m*n,f*l+3*d*y*e+3*c*p*s+m*o)}}function id(r,t,e,i,s,n,o,a){const h=r-e*s,l=t-i*s,u=r+e*n,c=t+i*n;let d,f;o?(d=i,f=-e):(d=-i,f=e);const p=h+d,m=l+f,g=u+d,y=c+f;return a.push(p,m,g,y),2}function Wi(r,t,e,i,s,n,o,a){const h=e-r,l=i-t;let u=Math.atan2(h,l),c=Math.atan2(s-r,n-t);a&&u<c?u+=Math.PI*2:!a&&u>c&&(c+=Math.PI*2);let d=u;const f=c-u,p=Math.abs(f),m=Math.sqrt(h*h+l*l),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(r,t,e,i);for(let v=1,_=d;v<g;v++,_+=y)o.push(r,t,r+Math.sin(_)*m,t+Math.cos(_)*m);o.push(r,t,s,n)}else{o.push(e,i,r,t);for(let v=1,_=d;v<g;v++,_+=y)o.push(r+Math.sin(_)*m,t+Math.cos(_)*m,r,t);o.push(s,n,r,t)}return g*2}function F1(r,t){const e=r.shape;let i=r.points||e.points.slice();const s=t.closePointEps;if(i.length===0)return;const n=r.lineStyle,o=new j(i[0],i[1]),a=new j(i[i.length-2],i[i.length-1]),h=e.type!==Lt.POLY||e.closeStroke,l=Math.abs(o.x-a.x)<s&&Math.abs(o.y-a.y)<s;if(h){i=i.slice(),l&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const E=(o.x+a.x)*.5,B=(a.y+o.y)*.5;i.unshift(E,B),i.push(E,B)}const u=t.points,c=i.length/2;let d=i.length;const f=u.length/2,p=n.width/2,m=p*p,g=n.miterLimit*n.miterLimit;let y=i[0],v=i[1],_=i[2],x=i[3],b=0,C=0,w=-(v-x),T=y-_,A=0,I=0,z=Math.sqrt(w*w+T*T);w/=z,T/=z,w*=p,T*=p;const R=n.alignment,S=(1-R)*2,P=R*2;h||(n.cap===pi.ROUND?d+=Wi(y-w*(S-P)*.5,v-T*(S-P)*.5,y-w*S,v-T*S,y+w*P,v+T*P,u,!0)+2:n.cap===pi.SQUARE&&(d+=id(y,v,w,T,S,P,!0,u))),u.push(y-w*S,v-T*S,y+w*P,v+T*P);for(let E=1;E<c-1;++E){y=i[(E-1)*2],v=i[(E-1)*2+1],_=i[E*2],x=i[E*2+1],b=i[(E+1)*2],C=i[(E+1)*2+1],w=-(v-x),T=y-_,z=Math.sqrt(w*w+T*T),w/=z,T/=z,w*=p,T*=p,A=-(x-C),I=_-b,z=Math.sqrt(A*A+I*I),A/=z,I/=z,A*=p,I*=p;const B=_-y,q=v-x,M=_-b,O=C-x,Q=B*M+q*O,nt=q*M-O*B,J=nt<0;if(Math.abs(nt)<.001*Math.abs(Q)){u.push(_-w*S,x-T*S,_+w*P,x+T*P),Q>=0&&(n.join===re.ROUND?d+=Wi(_,x,_-w*S,x-T*S,_-A*S,x-I*S,u,!1)+4:d+=2,u.push(_-A*P,x-I*P,_+A*S,x+I*S));continue}const at=(-w+y)*(-T+x)-(-w+_)*(-T+v),St=(-A+b)*(-I+x)-(-A+_)*(-I+C),Mt=(B*St-M*at)/nt,Ut=(O*at-q*St)/nt,Jt=(Mt-_)*(Mt-_)+(Ut-x)*(Ut-x),Nt=_+(Mt-_)*S,dt=x+(Ut-x)*S,At=_-(Mt-_)*P,Pt=x-(Ut-x)*P,Ne=Math.min(B*B+q*q,M*M+O*O),Ue=J?S:P,gs=Ne+Ue*Ue*m,Ug=Jt<=gs;let Mn=n.join;if(Mn===re.MITER&&Jt/m>g&&(Mn=re.BEVEL),Ug)switch(Mn){case re.MITER:{u.push(Nt,dt,At,Pt);break}case re.BEVEL:{J?u.push(Nt,dt,_+w*P,x+T*P,Nt,dt,_+A*P,x+I*P):u.push(_-w*S,x-T*S,At,Pt,_-A*S,x-I*S,At,Pt),d+=2;break}case re.ROUND:{J?(u.push(Nt,dt,_+w*P,x+T*P),d+=Wi(_,x,_+w*P,x+T*P,_+A*P,x+I*P,u,!0)+4,u.push(Nt,dt,_+A*P,x+I*P)):(u.push(_-w*S,x-T*S,At,Pt),d+=Wi(_,x,_-w*S,x-T*S,_-A*S,x-I*S,u,!1)+4,u.push(_-A*S,x-I*S,At,Pt));break}}else{switch(u.push(_-w*S,x-T*S,_+w*P,x+T*P),Mn){case re.MITER:{J?u.push(At,Pt,At,Pt):u.push(Nt,dt,Nt,dt),d+=2;break}case re.ROUND:{J?d+=Wi(_,x,_+w*P,x+T*P,_+A*P,x+I*P,u,!0)+2:d+=Wi(_,x,_-w*S,x-T*S,_-A*S,x-I*S,u,!1)+2;break}}u.push(_-A*S,x-I*S,_+A*P,x+I*P),d+=2}}y=i[(c-2)*2],v=i[(c-2)*2+1],_=i[(c-1)*2],x=i[(c-1)*2+1],w=-(v-x),T=y-_,z=Math.sqrt(w*w+T*T),w/=z,T/=z,w*=p,T*=p,u.push(_-w*S,x-T*S,_+w*P,x+T*P),h||(n.cap===pi.ROUND?d+=Wi(_-w*(S-P)*.5,x-T*(S-P)*.5,_-w*S,x-T*S,_+w*P,x+T*P,u,!1)+2:n.cap===pi.SQUARE&&(d+=id(_,x,w,T,S,P,!1,u)));const D=t.indices,H=ki.epsilon*ki.epsilon;for(let E=f;E<d+f-2;++E)y=u[E*2],v=u[E*2+1],_=u[(E+1)*2],x=u[(E+1)*2+1],b=u[(E+2)*2],C=u[(E+2)*2+1],!(Math.abs(y*(x-C)+_*(C-v)+b*(v-x))<H)&&D.push(E,E+1,E+2)}function D1(r,t){let e=0;const i=r.shape,s=r.points||i.points,n=i.type!==Lt.POLY||i.closeStroke;if(s.length===0)return;const o=t.points,a=t.indices,h=s.length/2,l=o.length/2;let u=l;for(o.push(s[0],s[1]),e=1;e<h;e++)o.push(s[e*2],s[e*2+1]),a.push(u,u+1),u++;n&&a.push(u,l)}function Jh(r,t){r.lineStyle.native?D1(r,t):F1(r,t)}class ua{static curveLength(t,e,i,s,n,o){const a=t-2*i+n,h=e-2*s+o,l=2*i-2*t,u=2*s-2*e,c=4*(a*a+h*h),d=4*(a*l+h*u),f=l*l+u*u,p=2*Math.sqrt(c+d+f),m=Math.sqrt(c),g=2*c*m,y=2*Math.sqrt(f),v=d/m;return(g*p+m*d*(p-y)+(4*f*c-d*d)*Math.log((2*m+v+p)/(v+y)))/(4*g)}static curveTo(t,e,i,s,n){const o=n[n.length-2],a=n[n.length-1],h=ki._segmentsCount(ua.curveLength(o,a,t,e,i,s));let l=0,u=0;for(let c=1;c<=h;++c){const d=c/h;l=o+(t-o)*d,u=a+(e-a)*d,n.push(l+(t+(i-t)*d-l)*d,u+(e+(s-e)*d-u)*d)}}}const po={[Lt.POLY]:mu,[Lt.CIRC]:on,[Lt.ELIP]:on,[Lt.RECT]:Kp,[Lt.RREC]:Zp},tl=[],Is=[];class an{constructor(t,e=null,i=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new an(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Er=new j,Jp=class tm extends Ul{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new en,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Is.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),tl.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,s=null){const n=new an(t,e,i,s);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new an(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=s.lineStyle,s.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const s=e[i];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Er):Er.copyFrom(t),s.shape.contains(Er.x,Er.y))){let n=!1;if(s.holes){for(let o=0;o<s.holes.length;o++)if(s.holes[o].shape.contains(Er.x,Er.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let h=this.shapeIndex;h<e.length;h++){this.shapeIndex++;const l=e[h],u=l.fillStyle,c=l.lineStyle;po[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(u.visible||c.visible)&&this.processHoles(l.holes);for(let d=0;d<2;d++){const f=d===0?u:c;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,g=this.points.length/2;p.wrapMode=ti.REPEAT,d===0?this.processFill(l):this.processLine(l);const y=this.points.length/2-g;y!==0&&(i&&!this._compareStyles(s,f)&&(i.end(m,g),i=null),i||(i=tl.pop()||new Qp,i.begin(f,m,g),this.batches.push(i),s=f),this.addUvs(this.points,t,f.texture,g,y,f.matrix))}}const n=this.indices.length,o=this.points.length/2;if(i&&i.end(n,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const i=this.graphicsData[t],s=i.fillStyle,n=i.lineStyle;if(s&&!s.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,i=t.length;e<i;e++){const s=t[e];for(let n=0;n<s.size;n++){const o=s.start+n;this.indicesUint16[o]=this.indicesUint16[o]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<tm.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++K._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),Is.push(this.drawCalls[c]);this.drawCalls.length=0;const e=this.colors,i=this.textureIds;let s=Is.pop();s||(s=new Mo,s.texArray=new Fo),s.texArray.count=0,s.start=0,s.size=0,s.type=Pe.TRIANGLES;let n=0,o=null,a=0,h=!1,l=Pe.TRIANGLES,u=0;this.drawCalls.push(s);for(let c=0;c<this.batches.length;c++){const d=this.batches[c],f=8,p=d.style,m=p.texture.baseTexture;h!==!!p.native&&(h=!!p.native,l=h?Pe.LINES:Pe.TRIANGLES,o=null,n=f,t++),o!==m&&(o=m,m._batchEnabled!==t&&(n===f&&(t++,n=0,s.size>0&&(s=Is.pop(),s||(s=new Mo,s.texArray=new Fo),this.drawCalls.push(s)),s.start=u,s.size=0,s.texArray.count=0,s.type=l),m.touched=1,m._batchEnabled=t,m._batchLocation=n,m.wrapMode=ti.REPEAT,s.texArray.elements[s.texArray.count++]=m,n++)),s.size+=d.size,u+=d.size,a=m._batchLocation,this.addColors(e,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(i,a,d.attribSize,d.attribStart)}K._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,i=this.colors,s=this.textureIds,n=new ArrayBuffer(t.length*3*4),o=new Float32Array(n),a=new Uint32Array(n);let h=0;for(let l=0;l<t.length/2;l++)o[h++]=t[l*2],o[h++]=t[l*2+1],o[h++]=e[l*2],o[h++]=e[l*2+1],a[h++]=i[l],o[h++]=s[l];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?mu.triangulate(t,this):po[t.type].triangulate(t,this)}processLine(t){Jh(t,this);for(let e=0;e<t.holes.length;e++)Jh(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];po[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const s=t[i*2],n=t[i*2+1];t[i*2]=e.a*s+e.c*n+e.tx,t[i*2+1]=e.b*s+e.d*n+e.ty}}addColors(t,e,i,s,n=0){const o=st.shared.setValue(e).toLittleEndianNumber(),a=st.shared.setValue(o).toPremultiplied(i);t.length=Math.max(t.length,n+s);for(let h=0;h<s;h++)t[n+h]=a}addTextureIds(t,e,i,s=0){t.length=Math.max(t.length,s+i);for(let n=0;n<i;n++)t[s+n]=e}addUvs(t,e,i,s,n,o=null){let a=0;const h=e.length,l=i.frame;for(;a<n;){let c=t[(s+a)*2],d=t[(s+a)*2+1];if(o){const f=o.a*c+o.c*d+o.tx;d=o.b*c+o.d*d+o.ty,c=f}a++,e.push(c/l.width,d/l.height)}const u=i.baseTexture;(l.width<u.width||l.height<u.height)&&this.adjustUvs(e,i,h,n)}adjustUvs(t,e,i,s){const n=e.baseTexture,o=1e-6,a=i+s*2,h=e.frame,l=h.width/n.width,u=h.height/n.height;let c=h.x/h.width,d=h.y/h.height,f=Math.floor(t[i]+o),p=Math.floor(t[i+1]+o);for(let m=i+2;m<a;m+=2)f=Math.min(f,Math.floor(t[m]+o)),p=Math.min(p,Math.floor(t[m+1]+o));c-=f,d-=p;for(let m=i;m<a;m+=2)t[m]=(t[m]+c)*l,t[m+1]=(t[m+1]+d)*u}};Jp.BATCHABLE_SIZE=100;let em=Jp;class Cn{constructor(){this.color=16777215,this.alpha=1,this.texture=k.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Cn;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=k.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ca extends Cn{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=pi.BUTT,this.join=re.MITER,this.miterLimit=10}clone(){const t=new ca;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=pi.BUTT,this.join=re.MITER,this.miterLimit=10}}const Za={},el=class mo extends Wt{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Cn,this._lineStyle=new ca,this._matrix=null,this._holeMode=!1,this.state=Le.for2d(),this._geometry=t||new em,this._geometry.refCount++,this._transformID=-1,this._tintColor=new st(16777215),this.blendMode=W.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new mo(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i,s=.5,n=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:i,alignment:s,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:k.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:pi.BUTT,join:re.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Fi,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Fi,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,s=i[i.length-2],n=i[i.length-1];return(s!==t||n!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,s){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),ua.curveTo(t,e,i,s,n),this}bezierCurveTo(t,e,i,s,n,o){return this._initCurve(),la.curveTo(t,e,i,s,n,o,this.currentPath.points),this}arcTo(t,e,i,s,n){this._initCurve(t,e);const o=this.currentPath.points,a=Qh.curveTo(t,e,i,s,n,o);if(a){const{cx:h,cy:l,radius:u,startAngle:c,endAngle:d,anticlockwise:f}=a;this.arc(h,l,u,c,d,f)}return this}arc(t,e,i,s,n,o=!1){if(s===n)return this;if(!o&&n<=s?n+=Ks:o&&s<=n&&(s+=Ks),n-s===0)return this;const a=t+Math.cos(s)*i,h=e+Math.sin(s)*i,l=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const c=Math.abs(u[u.length-2]-a),d=Math.abs(u[u.length-1]-h);c<l&&d<l||u.push(a,h)}else this.moveTo(a,h),u=this.currentPath.points;return Qh.arc(a,h,t,e,i,s,n,o,u),this}beginFill(t=0,e){return this.beginTextureFill({texture:k.WHITE,color:t,alpha:e})}normalizeColor(t){const e=st.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:k.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,s){return this.drawShape(new Z(t,e,i,s))}drawRoundedRect(t,e,i,s,n){return this.drawShape(new Tn(t,e,i,s,n))}drawCircle(t,e,i){return this.drawShape(new gr(t,e,i))}drawEllipse(t,e,i,s){return this.drawShape(new bn(t,e,i,s))}drawPolygon(...t){let e,i=!0;const s=t[0];s.points?(i=s.closeStroke,e=s.points):Array.isArray(t[0])?e=t[0]:e=t;const n=new Fi(e);return n.closeStroke=i,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===Lt.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let s=0;s<i;s++){const n=t.batches[s],o=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),h=new Float32Array(t.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),l=new Uint16Array(t.indicesUint16.buffer,n.start*2,n.size),u={vertexData:a,blendMode:e,indices:l,uvs:h,_batchRGB:st.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[s]=u}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}}_renderDirect(t){const e=this._resolveDirectShader(t),i=this._geometry,s=this.worldAlpha,n=e.uniforms,o=i.drawCalls;n.translationMatrix=this.transform.worldTransform,st.shared.setValue(this._tintColor).premultiply(s).toArray(n.tint),t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,i.drawCalls[a])}_renderDrawCallDirect(t,e){const{texArray:i,type:s,size:n,start:o}=e,a=i.count;for(let h=0;h<a;h++)t.texture.bind(i.elements[h],h);t.geometry.draw(s,n,o)}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;if(!e){if(!Za[i]){const{maxTextures:s}=t.plugins[i],n=new Int32Array(s);for(let h=0;h<s;h++)n[h]=h;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new ut,default:ye.from({uSamplers:n},!0)},a=t.plugins[i]._shader.program;Za[i]=new Be(a,o)}e=Za[i]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:s,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,i,s,n)}containsPoint(t){return this.worldTransform.applyInverse(t,mo._TEMP_POINT),this._geometry.containsPoint(mo._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=st.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,s=e.b,n=e.c,o=e.d,a=e.tx,h=e.ty,l=this._geometry.points,u=this.vertexData;let c=0;for(let d=0;d<l.length;d+=2){const f=l[d],p=l[d+1];u[c++]=i*f+n*p+a,u[c++]=o*p+s*f+h}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};el.curves=ki,el._TEMP_POINT=new j;let gu=el;const B1={buildPoly:mu,buildCircle:on,buildRectangle:Kp,buildRoundedRectangle:Zp,buildLine:Jh,ArcUtils:Qh,BezierUtils:la,QuadraticUtils:ua,BatchPart:Qp,FILL_COMMANDS:po,BATCH_POOL:tl,DRAW_CALL_POOL:Is};class im{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Qa=new j,rd=new Fi,rm=class sm extends Wt{constructor(t,e,i,s=Pe.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=i||Le.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=U.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Pe.TRIANGLES&&e.length<sm.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,n=s.a,o=s.b,a=s.c,h=s.d,l=s.tx,u=s.ty,c=this.vertexData;for(let d=0;d<c.length/2;d++){const f=e[d*2],p=e[d*2+1];c[d*2]=n*f+a*p+l,c[d*2+1]=o*f+h*p+u}if(this._roundPixels){const d=U.RESOLUTION;for(let f=0;f<c.length;++f)c[f]=Math.round(c[f]*d)/d}this.vertexDirty=i}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new im(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Qa);const e=this.geometry.getBuffer("aVertexPosition").data,i=rd.points,s=this.geometry.getIndex().data,n=s.length,o=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=o){const h=s[a]*2,l=s[a+1]*2,u=s[a+2]*2;if(i[0]=e[h],i[1]=e[h+1],i[2]=e[l],i[3]=e[l+1],i[4]=e[u],i[5]=e[u+1],rd.contains(Qa.x,Qa.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};rm.BATCHABLE_SIZE=100;let rs=rm;class En extends mi{constructor(t,e,i){super();const s=new yt(t),n=new yt(e,!0),o=new yt(i,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,X.FLOAT).addAttribute("aTextureCoord",n,2,!1,X.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var O1=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,L1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class ss extends Be{constructor(t,e){const i={uSampler:t,alpha:1,uTextureMatrix:ut.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(i,e.uniforms),super(e.program||Qe.from(L1,O1),i),this._colorDirty=!1,this.uvMatrix=new aa(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new st(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;st.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class nm extends En{constructor(t=100,e=100,i=10,s=10){super(),this.segWidth=i,this.segHeight=s,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],i=[],s=[],n=this.segWidth-1,o=this.segHeight-1,a=this.width/n,h=this.height/o;for(let u=0;u<t;u++){const c=u%this.segWidth,d=u/this.segWidth|0;e.push(c*a,d*h),i.push(c/n,d/o)}const l=n*o;for(let u=0;u<l;u++){const c=u%n,d=u/n|0,f=d*this.segWidth+c,p=d*this.segWidth+c+1,m=(d+1)*this.segWidth+c,g=(d+1)*this.segWidth+c+1;s.push(f,p,m,p,g,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(s),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class om extends En{constructor(t=200,e,i=0){super(new Float32Array(e.length*4),new Float32Array(e.length*4),new Uint16Array((e.length-1)*6)),this.points=e,this._width=t,this.textureScale=i,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),s=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),i.data=new Float32Array(t.length*4),s.data=new Uint16Array((t.length-1)*6));const n=i.data,o=s.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;let a=0,h=t[0];const l=this._width*this.textureScale,u=t.length;for(let d=0;d<u;d++){const f=d*4;if(this.textureScale>0){const p=h.x-t[d].x,m=h.y-t[d].y,g=Math.sqrt(p*p+m*m);h=t[d],a+=g/l}else a=d/(u-1);n[f]=a,n[f+1]=0,n[f+2]=a,n[f+3]=1}let c=0;for(let d=0;d<u-1;d++){const f=d*2;o[c++]=f,o[c++]=f+1,o[c++]=f+2,o[c++]=f+2,o[c++]=f+1,o[c++]=f+3}i.update(),s.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],i,s=0,n=0;const o=this.buffers[0].data,a=t.length,h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let l=0;l<a;l++){const u=t[l],c=l*4;l<t.length-1?i=t[l+1]:i=u,n=-(i.x-e.x),s=i.y-e.y;const d=Math.sqrt(s*s+n*n);d<1e-6?(s=0,n=0):(s/=d,n/=d,s*=h,n*=h),o[c]=u.x+s,o[c+1]=u.y+n,o[c+2]=u.x-s,o[c+3]=u.y-n,e=u}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class am extends rs{constructor(t,e,i){const s=new nm(t.width,t.height,e,i),n=new ss(k.WHITE);super(s,n),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:i}=this.shader.texture;this.autoResize&&(t.width!==e||t.height!==i)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}const Qn=10;class k1 extends am{constructor(t,e,i,s,n){var o,a,h,l;super(k.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e??((o=t.defaultBorders)==null?void 0:o.left)??Qn,this._rightWidth=s??((a=t.defaultBorders)==null?void 0:a.right)??Qn,this._topHeight=i??((h=t.defaultBorders)==null?void 0:h.top)??Qn,this._bottomHeight=n??((l=t.defaultBorders)==null?void 0:l.bottom)??Qn,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,s=this._height>i?1:this._height/i;return Math.min(e,s)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const i=1/this._origWidth,s=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=s*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class N1 extends rs{constructor(t=k.EMPTY,e,i,s,n){const o=new En(e,i,s);o.getBuffer("aVertexPosition").static=!1;const a=new ss(t);super(o,a,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class U1 extends rs{constructor(t,e,i=0){const s=new om(t.height,e,i),n=new ss(t);i>0&&(t.baseTexture.wrapMode=ti.REPEAT),super(s,n),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}class G1 extends Wt{constructor(t=1500,e,i=16384,s=!1){super();const n=16384;i>n&&(i=n),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=W.NORMAL,this.autoResize=s,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new st(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class sd{constructor(t,e,i){this.geometry=new mi,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let n=t[s];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||X.FLOAT,offset:n.offset},e[s]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new yt(xf(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=e,e+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new yt(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new yt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===X.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===X.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,e,i){for(let s=0;s<this.dynamicProperties.length;s++){const n=this.dynamicProperties[s];n.uploadFunction(t,e,i,n.type===X.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,i){for(let s=0;s<this.staticProperties.length;s++){const n=this.staticProperties[s];n.uploadFunction(t,e,i,n.type===X.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var z1=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,H1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class _u extends Sn{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new ut,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:X.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Be.from(H1,z1,{}),this.state=Le.for2d()}render(t){const e=t.children,i=t._maxSize,s=t._batchSize,n=this.renderer;let o=e.length;if(o===0)return;o>i&&!t.autoResize&&(o=i);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const h=e[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=kl(t.blendMode,l),n.state.set(this.state);const u=n.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=st.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=s,p+=1){let m=o-f;m>s&&(m=s),p>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[p];g.uploadDynamic(e,f,m);const y=t._bufferUpdateIDs[p]||0;d=d||g._updateID<y,d&&(g._updateID=t._updateID,g.uploadStatic(e,f,m)),n.geometry.bind(g.geometry),u.drawElements(u.TRIANGLES,m*6,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],i=t._maxSize,s=t._batchSize,n=t._properties;for(let o=0;o<i;o+=s)e.push(new sd(this.properties,n,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,i=t._properties;return new sd(this.properties,i,e)}uploadVertices(t,e,i,s,n,o){let a=0,h=0,l=0,u=0;for(let c=0;c<i;++c){const d=t[e+c],f=d._texture,p=d.scale.x,m=d.scale.y,g=f.trim,y=f.orig;g?(h=g.x-d.anchor.x*y.width,a=h+g.width,u=g.y-d.anchor.y*y.height,l=u+g.height):(a=y.width*(1-d.anchor.x),h=y.width*-d.anchor.x,l=y.height*(1-d.anchor.y),u=y.height*-d.anchor.y),s[o]=h*p,s[o+1]=u*m,s[o+n]=a*p,s[o+n+1]=u*m,s[o+n*2]=a*p,s[o+n*2+1]=l*m,s[o+n*3]=h*p,s[o+n*3+1]=l*m,o+=n*4}}uploadPosition(t,e,i,s,n,o){for(let a=0;a<i;a++){const h=t[e+a].position;s[o]=h.x,s[o+1]=h.y,s[o+n]=h.x,s[o+n+1]=h.y,s[o+n*2]=h.x,s[o+n*2+1]=h.y,s[o+n*3]=h.x,s[o+n*3+1]=h.y,o+=n*4}}uploadRotation(t,e,i,s,n,o){for(let a=0;a<i;a++){const h=t[e+a].rotation;s[o]=h,s[o+n]=h,s[o+n*2]=h,s[o+n*3]=h,o+=n*4}}uploadUvs(t,e,i,s,n,o){for(let a=0;a<i;++a){const h=t[e+a]._texture._uvs;h?(s[o]=h.x0,s[o+1]=h.y0,s[o+n]=h.x1,s[o+n+1]=h.y1,s[o+n*2]=h.x2,s[o+n*2+1]=h.y2,s[o+n*3]=h.x3,s[o+n*3+1]=h.y3,o+=n*4):(s[o]=0,s[o+1]=0,s[o+n]=0,s[o+n+1]=0,s[o+n*2]=0,s[o+n*2+1]=0,s[o+n*3]=0,s[o+n*3+1]=0,o+=n*4)}}uploadTint(t,e,i,s,n,o){for(let a=0;a<i;++a){const h=t[e+a],l=st.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);s[o]=l,s[o+n]=l,s[o+n*2]=l,s[o+n*3]=l,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}_u.extension={name:"particle",type:N.RendererPlugin};$.add(_u);var Pn=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(Pn||{});const Jn={willReadFrequently:!0},$e=class V{static get experimentalLetterSpacingSupported(){let t=V._experimentalLetterSpacingSupported;if(t!==void 0){const e=U.ADAPTER.getCanvasRenderingContext2D().prototype;t=V._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,s,n,o,a,h,l){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=l}static measureText(t,e,i,s=V._canvas){i=i??e.wordWrap;const n=e.toFontString(),o=V.measureFont(n);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=s.getContext("2d",Jn);a.font=n;const h=(i?V.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let u=0;for(let p=0;p<h.length;p++){const m=V._measureText(h[p],e.letterSpacing,a);l[p]=m,u=Math.max(u,m)}let c=u+e.strokeThickness;e.dropShadow&&(c+=e.dropShadowDistance);const d=e.lineHeight||o.fontSize+e.strokeThickness;let f=Math.max(d,o.fontSize+e.strokeThickness*2)+e.leading+(h.length-1)*(d+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new V(t,e,c,f,h,l,d+e.leading,u,o)}static _measureText(t,e,i){let s=!1;V.experimentalLetterSpacingSupported&&(V.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(t).width;return n>0&&(s?n-=e:n+=(V.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,i=V._canvas){const s=i.getContext("2d",Jn);let n=0,o="",a="";const h=Object.create(null),{letterSpacing:l,whiteSpace:u}=e,c=V.collapseSpaces(u),d=V.collapseNewlines(u);let f=!c;const p=e.wordWrapWidth+l,m=V.tokenize(t);for(let g=0;g<m.length;g++){let y=m[g];if(V.isNewline(y)){if(!d){a+=V.addLine(o),f=!c,o="",n=0;continue}y=" "}if(c){const _=V.isBreakingSpace(y),x=V.isBreakingSpace(o[o.length-1]);if(_&&x)continue}const v=V.getFromCache(y,l,h,s);if(v>p)if(o!==""&&(a+=V.addLine(o),o="",n=0),V.canBreakWords(y,e.breakWords)){const _=V.wordWrapSplit(y);for(let x=0;x<_.length;x++){let b=_[x],C=b,w=1;for(;_[x+w];){const A=_[x+w];if(!V.canBreakChars(C,A,y,x,e.breakWords))b+=A;else break;C=A,w++}x+=w-1;const T=V.getFromCache(b,l,h,s);T+n>p&&(a+=V.addLine(o),f=!1,o="",n=0),o+=b,n+=T}}else{o.length>0&&(a+=V.addLine(o),o="",n=0);const _=g===m.length-1;a+=V.addLine(y,!_),f=!1,o="",n=0}else v+n>p&&(f=!1,a+=V.addLine(o),o="",n=0),(o.length>0||!V.isBreakingSpace(y)||f)&&(o+=y,n+=v)}return a+=V.addLine(o,!1),a}static addLine(t,e=!0){return t=V.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,s){let n=i[t];return typeof n!="number"&&(n=V._measureText(t,e,s)+e,i[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!V.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:V._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:V._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const n=t[s],o=t[s+1];if(V.isBreakingSpace(n,o)||V.isNewline(n)){i!==""&&(e.push(i),i=""),e.push(n);continue}i+=n}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,n){return!0}static wordWrapSplit(t){return V.graphemeSegmenter(t)}static measureFont(t){if(V._fonts[t])return V._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=V._canvas,s=V._context;s.font=t;const n=V.METRICS_STRING+V.BASELINE_SYMBOL,o=Math.ceil(s.measureText(n).width);let a=Math.ceil(s.measureText(V.BASELINE_SYMBOL).width);const h=Math.ceil(V.HEIGHT_MULTIPLIER*a);if(a=a*V.BASELINE_MULTIPLIER|0,o===0||h===0)return V._fonts[t]=e,e;i.width=o,i.height=h,s.fillStyle="#f00",s.fillRect(0,0,o,h),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(n,0,a);const l=s.getImageData(0,0,o,h).data,u=l.length,c=o*4;let d=0,f=0,p=!1;for(d=0;d<a;++d){for(let m=0;m<c;m+=4)if(l[f+m]!==255){p=!0;break}if(!p)f+=c;else break}for(e.ascent=a-d,f=u-c,p=!1,d=h;d>a;--d){for(let m=0;m<c;m+=4)if(l[f+m]!==255){p=!0;break}if(!p)f-=c;else break}return e.descent=d-a,e.fontSize=e.ascent+e.descent,V._fonts[t]=e,e}static clearMetrics(t=""){t?delete V._fonts[t]:V._fonts={}}static get _canvas(){var t;if(!V.__canvas){let e;try{const i=new OffscreenCanvas(0,0);if((t=i.getContext("2d",Jn))!=null&&t.measureText)return V.__canvas=i,i;e=U.ADAPTER.createCanvas()}catch{e=U.ADAPTER.createCanvas()}e.width=e.height=10,V.__canvas=e}return V.__canvas}static get _context(){return V.__context||(V.__context=V._canvas.getContext("2d",Jn)),V.__context}};$e.METRICS_STRING="|q",$e.BASELINE_SYMBOL="M",$e.BASELINE_MULTIPLIER=1.4,$e.HEIGHT_MULTIPLIER=2,$e.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})(),$e.experimentalLetterSpacing=!1,$e._fonts={},$e._newlines=[10,13],$e._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ci=$e;const $1=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],hm=class Ms{constructor(t){this.styleID=0,this.reset(),th(this,t,t)}clone(){const t={};return th(t,this,Ms.defaultStyle),new Ms(t)}reset(){th(this,Ms.defaultStyle,Ms.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=Ja(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=Ja(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){V1(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=Ja(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let s=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!$1.includes(s)&&(s=`"${s}"`),e[i]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};hm.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Pn.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let si=hm;function Ja(r){const t=st.shared,e=i=>{const s=t.setValue(i);return s.alpha===1?s.toHex():s.toRgbaString()};return Array.isArray(r)?r.map(e):e(r)}function V1(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function th(r,t,e){for(const i in e)Array.isArray(t[i])?r[i]=t[i].slice():r[i]=t[i]}const X1={texture:!0,children:!1,baseTexture:!0},lm=class il extends ke{constructor(t,e,i){let s=!1;i||(i=U.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;const n=k.from(i);n.orig=new Z,n.trim=new Z,super(n),this._ownCanvas=s,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=il.defaultResolution??U.RESOLUTION,this._autoResolution=il.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return ci.experimentalLetterSpacing}static set experimentalLetterSpacing(t){Y("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ci.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const i=this.context,s=ci.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=s.width,o=s.height,a=s.lines,h=s.lineHeight,l=s.lineWidths,u=s.maxLineWidth,c=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;let d,f;const p=e.dropShadow?2:1;for(let m=0;m<p;++m){const g=e.dropShadow&&m===0,y=g?Math.ceil(Math.max(1,o)+e.padding*2):0,v=y*this._resolution;if(g){i.fillStyle="black",i.strokeStyle="black";const x=e.dropShadowColor,b=e.dropShadowBlur*this._resolution,C=e.dropShadowDistance*this._resolution;i.shadowColor=st.shared.setValue(x).setAlpha(e.dropShadowAlpha).toRgbaString(),i.shadowBlur=b,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*C,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*C+v}else i.fillStyle=this._generateFillStyle(e,a,s),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let _=(h-c.fontSize)/2;h-c.fontSize<0&&(_=0);for(let x=0;x<a.length;x++)d=e.strokeThickness/2,f=e.strokeThickness/2+x*h+c.ascent+_,e.align==="right"?d+=u-l[x]:e.align==="center"&&(d+=(u-l[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[x],d+e.padding,f+e.padding-y,!0),e.fill&&this.drawLetterSpacing(a[x],d+e.padding,f+e.padding-y)}this.updateTexture()}drawLetterSpacing(t,e,i,s=!1){const n=this._style.letterSpacing;let o=!1;if(ci.experimentalLetterSpacingSupported&&(ci.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){s?this.context.strokeText(t,e,i):this.context.fillText(t,e,i);return}let a=e;const h=ci.graphemeSegmenter(t);let l=this.context.measureText(t).width,u=0;for(let c=0;c<h.length;++c){const d=h[c];s?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let f="";for(let p=c+1;p<h.length;++p)f+=h[p];u=this.context.measureText(f).width,a+=l-u+n,l=u}}updateTexture(){const t=this.canvas;if(this._style.trim){const o=wf(t);o.data&&(t.width=o.width,t.height=o.height,this.context.putImageData(o.data,0,0))}const e=this._texture,i=this._style,s=i.trim?0:i.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){const s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let n;const o=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,h=this.canvas.width/this._resolution-o-a*2,l=this.canvas.height/this._resolution-o-a*2,u=s.slice(),c=t.fillGradientStops.slice();if(!c.length){const d=u.length+1;for(let f=1;f<d;++f)c.push(f/d)}if(u.unshift(s[0]),c.unshift(0),u.push(s[s.length-1]),c.push(1),t.fillGradientType===Pn.LINEAR_VERTICAL){n=this.context.createLinearGradient(h/2,a,h/2,l+a);const d=i.fontProperties.fontSize+t.strokeThickness;for(let f=0;f<e.length;f++){const p=i.lineHeight*(f-1)+d,m=i.lineHeight*f;let g=m;f>0&&p>m&&(g=(m+p)/2);const y=m+d,v=i.lineHeight*(f+1);let _=y;f+1<e.length&&v<y&&(_=(y+v)/2);const x=(_-g)/l;for(let b=0;b<u.length;b++){let C=0;typeof c[b]=="number"?C=c[b]:C=b/u.length;let w=Math.min(1,Math.max(0,g/l+C*x));w=Number(w.toFixed(5)),n.addColorStop(w,u[b])}}}else{n=this.context.createLinearGradient(a,l/2,h+a,l/2);const d=u.length+1;let f=1;for(let p=0;p<u.length;p++){let m;typeof c[p]=="number"?m=c[p]:m=f/d,n.addColorStop(m,u[p]),f++}}return n}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},X1,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=fi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=fi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof si?this._style=t:this._style=new si(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};lm.defaultAutoResolution=!0;let Rn=lm;class um{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function W1(r,t){var i;let e=!1;if((i=r==null?void 0:r._textures)!=null&&i.length){for(let s=0;s<r._textures.length;s++)if(r._textures[s]instanceof k){const n=r._textures[s].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function j1(r,t){if(r.baseTexture instanceof K){const e=r.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Y1(r,t){if(r._texture&&r._texture instanceof k){const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function q1(r,t){return t instanceof Rn?(t.updateText(!0),!0):!1}function K1(r,t){if(t instanceof si){const e=t.toFontString();return ci.measureFont(e),!0}return!1}function Z1(r,t){if(r instanceof Rn){t.includes(r.style)||t.push(r.style),t.includes(r)||t.push(r);const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Q1(r,t){return r instanceof si?(t.includes(r)||t.push(r),!0):!1}const cm=class dm{constructor(t){this.limiter=new um(dm.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Z1),this.registerFindHook(Q1),this.registerFindHook(W1),this.registerFindHook(j1),this.registerFindHook(Y1),this.registerUploadHook(q1),this.registerUploadHook(K1)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,wt.system.addOnce(this.tick,this,gi.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let i=0,s=this.uploadHooks.length;i<s;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)wt.system.addOnce(this.tick,this,gi.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,i=t.length;e<i;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Wt)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&wt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};cm.uploadsPerFrame=4;let Uo=cm;Object.defineProperties(U,{UPLOADS_PER_FRAME:{get(){return Uo.uploadsPerFrame},set(r){Y("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Uo.uploadsPerFrame=r}}});function fm(r,t){return t instanceof K?(t._glTextures[r.CONTEXT_UID]||r.texture.bind(t),!0):!1}function J1(r,t){if(!(t instanceof gu))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:i}=e;for(let s=0;s<i.length;s++){const{texture:n}=i[s].style;n&&fm(r,n.baseTexture)}return e.batchable||r.geometry.bind(e,t._resolveDirectShader(r)),!0}function tb(r,t){return r instanceof gu?(t.push(r),!0):!1}class yu extends Uo{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(tb),this.registerUploadHook(fm),this.registerUploadHook(J1)}}yu.extension={name:"prepare",type:N.RendererSystem};$.add(yu);class eb{constructor(t){this.maxMilliseconds=t,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}class Go extends ke{constructor(t,e=!0){super(t[0]instanceof k?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(wt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(wt.shared.add(this.update,this,gi.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,i=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=e/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let i=0;i<t.length;++i)e.push(k.from(t[i]));return new Go(e)}static fromImages(t){const e=[];for(let i=0;i<t.length;++i)e.push(k.from(t[i]));return new Go(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof k)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(wt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(wt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const Ts=new j;class vu extends ke{constructor(t,e=100,i=100){super(t),this.tileTransform=new wn,this._width=e,this._height=i,this.uvMatrix=this.texture.uvMatrix||new aa(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const e=this._texture;!e||!e.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),s=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,s)}getLocalBounds(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Z),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Ts);const e=this._width,i=this._height,s=-e*this.anchor._x;if(Ts.x>=s&&Ts.x<s+e){const n=-i*this.anchor._y;if(Ts.y>=n&&Ts.y<n+i)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,e){const i=t instanceof k?t:k.from(t,e);return new vu(i,e.width,e.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var ib=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,rb=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,sb=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,nd=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,nb=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const to=new ut;class xu extends Sn{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Vl,this.state=Le.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Be.from(nd,nb,e),this.shader=t.context.webGLVersion>1?Be.from(rb,ib,e):Be.from(nd,sb,e)}render(t){const e=this.renderer,i=this.quad;let s=i.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;s=i.uvs,s[0]=s[6]=-n,s[1]=s[3]=-o,s[2]=s[4]=1-n,s[5]=s[7]=1-o,i.invalidate();const a=t._texture,h=a.baseTexture,l=h.alphaMode>0,u=t.tileTransform.localTransform,c=t.uvMatrix;let d=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;d&&(h._glTextures[e.CONTEXT_UID]?d=h.wrapMode!==ti.CLAMP:h.wrapMode===ti.CLAMP&&(h.wrapMode=ti.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,m=a.height,g=t._width,y=t._height;to.set(u.a*p/g,u.b*p/y,u.c*m/g,u.d*m/y,u.tx/g,u.ty/y),to.invert(),d?to.prepend(c.mapCoord):(f.uniforms.uMapCoord=c.mapCoord.toArray(!0),f.uniforms.uClampFrame=c.uClampFrame,f.uniforms.uClampOffset=c.uClampOffset),f.uniforms.uTransform=to.toArray(!0),f.uniforms.uColor=st.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,e.shader.bind(f),e.geometry.bind(i),this.state.blendMode=kl(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}xu.extension={name:"tilingSprite",type:N.RendererPlugin};$.add(xu);const pm=class Fs{constructor(t,e,i){this.linkedSheets=[],(t instanceof K||t instanceof k)&&(t={texture:t,data:e,resolutionFilename:i});const{texture:s,data:n,resolutionFilename:o=null,cachePrefix:a=""}=t;this.cachePrefix=a,this._texture=s instanceof k?s:null,this.baseTexture=s instanceof K?s:this._texture.baseTexture,this.textures={},this.animations={},this.data=n;const h=this.baseTexture.resource;this.resolution=this._updateResolution(o||(h?h.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let i=ii(t,null);return i===null&&(i=typeof e=="number"?e:parseFloat(e??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Fs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=Fs.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const s=this._frameKeys[e],n=this._frames[s],o=n.frame;if(o){let a=null,h=null;const l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,u=new Z(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?a=new Z(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new Z(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new Z(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[s]=new k(this.baseTexture,a,u,h,n.rotated?2:0,n.anchor,n.borders),k.addToCache(this.textures[s],this.cachePrefix+s.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const s=t[e][i];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Fs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Fs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};pm.BATCH_SIZE=1e3;let rl=pm;const ob=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function mm(r,t,e){const i={};if(r.forEach(s=>{i[s]=t}),Object.keys(t.textures).forEach(s=>{i[`${t.cachePrefix}${s}`]=t.textures[s]}),!e){const s=It.dirname(r[0]);t.linkedSheets.forEach((n,o)=>{Object.assign(i,mm([`${s}/${t.data.meta.related_multi_packs[o]}`],n,!0))})}return i}const gm={extension:N.Asset,cache:{test:r=>r instanceof rl,getCacheableAssets:(r,t)=>mm(r,t,!1)},resolver:{test:r=>{const t=r.split("?")[0].split("."),e=t.pop(),i=t.pop();return e==="json"&&ob.includes(i)},parse:r=>{var e;const t=r.split(".");return{resolution:parseFloat(((e=U.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:t[t.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:N.LoadParser,priority:xe.Normal},async testParse(r,t){return It.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){var u,c;const{texture:i,imageFilename:s,cachePrefix:n}=(t==null?void 0:t.data)??{};let o=It.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let a;if(i&&i.baseTexture)a=i;else{const d=No(o+(s??r.meta.image),t.src);a=(await e.load([d]))[d]}const h=new rl({texture:a.baseTexture,data:r,resolutionFilename:t.src,cachePrefix:n});await h.parse();const l=(u=r==null?void 0:r.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(l)){const d=[];for(const p of l){if(typeof p!="string")continue;let m=o+p;(c=t.data)!=null&&c.ignoreMultiPack||(m=No(m,t.src),d.push(e.load({src:m,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(d);h.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[h].concat(h.linkedSheets.filter(m=>m!==p))})}return h},unload(r){r.destroy(!0)}}};$.add(gm);class hn{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Gs{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in e){const o=e[n].match(/^[a-z]+/gm)[0],a=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const l in a){const u=a[l].split("="),c=u[0],d=u[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;h[c]=p}i[o].push(h)}const s=new hn;return i.info.forEach(n=>s.info.push({face:n.face,size:parseInt(n.size,10)})),i.common.forEach(n=>s.common.push({lineHeight:parseInt(n.lineHeight,10)})),i.page.forEach(n=>s.page.push({id:parseInt(n.id,10),file:n.file})),i.char.forEach(n=>s.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),i.kerning.forEach(n=>s.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),i.distanceField.forEach(n=>s.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),s}}class zo{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new hn,i=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let l=0;l<i.length;l++)e.info.push({face:i[l].getAttribute("face"),size:parseInt(i[l].getAttribute("size"),10)});for(let l=0;l<s.length;l++)e.common.push({lineHeight:parseInt(s[l].getAttribute("lineHeight"),10)});for(let l=0;l<n.length;l++)e.page.push({id:parseInt(n[l].getAttribute("id"),10)||0,file:n[l].getAttribute("file")});for(let l=0;l<o.length;l++){const u=o[l];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)e.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<h.length;l++)e.distanceField.push({fieldType:h[l].getAttribute("fieldType"),distanceRange:parseInt(h[l].getAttribute("distanceRange"),10)});return e}}class Ho{static test(t){return typeof t=="string"&&t.includes("<font>")?zo.test(U.ADAPTER.parseXML(t)):!1}static parse(t){return zo.parse(U.ADAPTER.parseXML(t))}}const eh=[Gs,zo,Ho];function _m(r){for(let t=0;t<eh.length;t++)if(eh[t].test(r))return eh[t];return null}function ab(r,t,e,i,s,n){const o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const h=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,u=r.width/i-h-l*2,c=r.height/i-h-l*2,d=o.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),e.fillGradientType===Pn.LINEAR_VERTICAL){a=t.createLinearGradient(u/2,l,u/2,c+l);let p=0;const m=(n.fontProperties.fontSize+e.strokeThickness)/c;for(let g=0;g<s.length;g++){const y=n.lineHeight*g;for(let v=0;v<d.length;v++){let _=0;typeof f[v]=="number"?_=f[v]:_=v/d.length;const x=y/c+_*m;let b=Math.max(p,x);b=Math.min(b,1),a.addColorStop(b,d[v]),p=b}}}else{a=t.createLinearGradient(l,c/2,u+l,c/2);const p=d.length+1;let m=1;for(let g=0;g<d.length;g++){let y;typeof f[g]=="number"?y=f[g]:y=m/p,a.addColorStop(y,d[g]),m++}}return a}function hb(r,t,e,i,s,n,o){const a=e.text,h=e.fontProperties;t.translate(i,s),t.scale(n,n);const l=o.strokeThickness/2,u=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=ab(r,t,o,n,[a],e),t.strokeStyle=o.stroke,o.dropShadow){const c=o.dropShadowColor,d=o.dropShadowBlur*n,f=o.dropShadowDistance*n;t.shadowColor=st.shared.setValue(c).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,l,u+e.lineHeight-h.descent),o.fill&&t.fillText(a,l,u+e.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function go(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function ym(r){return Array.from?Array.from(r):r.split("")}function lb(r){typeof r=="string"&&(r=[r]);const t=[];for(let e=0,i=r.length;e<i;e++){const s=r[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const n=s[0].charCodeAt(0),o=s[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...ym(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const xi=class Ve{constructor(t,e,i){var u;const[s]=t.info,[n]=t.common,[o]=t.page,[a]=t.distanceField,h=ii(o.file),l={};this._ownsTextures=i,this.font=s.face,this.size=s.size,this.lineHeight=n.lineHeight/h,this.chars={},this.pageTextures=l;for(let c=0;c<t.page.length;c++){const{id:d,file:f}=t.page[c];l[d]=e instanceof Array?e[c]:e[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(l[d].baseTexture.alphaMode=jt.NO_PREMULTIPLIED_ALPHA,l[d].baseTexture.mipmap=Oe.OFF)}for(let c=0;c<t.char.length;c++){const{id:d,page:f}=t.char[c];let{x:p,y:m,width:g,height:y,xoffset:v,yoffset:_,xadvance:x}=t.char[c];p/=h,m/=h,g/=h,y/=h,v/=h,_/=h,x/=h;const b=new Z(p+l[f].frame.x/h,m+l[f].frame.y/h,g,y);this.chars[d]={xOffset:v,yOffset:_,xAdvance:x,kerning:{},texture:new k(l[f].baseTexture,b),page:f}}for(let c=0;c<t.kerning.length;c++){let{first:d,second:f,amount:p}=t.kerning[c];d/=h,f/=h,p/=h,this.chars[f]&&(this.chars[f].kerning[d]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((u=a==null?void 0:a.fieldType)==null?void 0:u.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,i){let s;if(t instanceof hn)s=t;else{const o=_m(t);if(!o)throw new Error("Unrecognized data format for font.");s=o.parse(t)}e instanceof k&&(e=[e]);const n=new Ve(s,e,i);return Ve.available[n.font]=n,n}static uninstall(t){const e=Ve.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete Ve.available[t]}static from(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:n,resolution:o,textureWidth:a,textureHeight:h,...l}=Object.assign({},Ve.defaultOptions,i),u=lb(s),c=e instanceof si?e:new si(e),d=a,f=new hn;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};let p=0,m=0,g,y,v,_=0;const x=[];for(let C=0;C<u.length;C++){g||(g=U.ADAPTER.createCanvas(),g.width=a,g.height=h,y=g.getContext("2d"),v=new K(g,{resolution:o,...l}),x.push(new k(v)),f.page.push({id:x.length-1,file:""}));const w=u[C],T=ci.measureText(w,c,!1,g),A=T.width,I=Math.ceil(T.height),z=Math.ceil((c.fontStyle==="italic"?2:1)*A);if(m>=h-I*o){if(m===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${w}')`);--C,g=null,y=null,v=null,m=0,p=0,_=0;continue}if(_=Math.max(I+T.fontProperties.descent,_),z*o+p>=d){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${w}')`);--C,m+=_*o,m=Math.ceil(m),p=0,_=0;continue}hb(g,y,T,p,m,o,c);const R=go(T.text);f.char.push({id:R,page:x.length-1,x:p/o,y:m/o,width:z,height:I,xoffset:0,yoffset:0,xadvance:A-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),p+=(z+2*n)*o,p=Math.ceil(p)}if(!(i!=null&&i.skipKerning))for(let C=0,w=u.length;C<w;C++){const T=u[C];for(let A=0;A<w;A++){const I=u[A],z=y.measureText(T).width,R=y.measureText(I).width,S=y.measureText(T+I).width-(z+R);S&&f.kerning.push({first:go(T),second:go(I),amount:S})}}const b=new Ve(f,x,!0);return Ve.available[t]!==void 0&&Ve.uninstall(t),Ve.available[t]=b,b}};xi.ALPHA=[["a","z"],["A","Z"]," "],xi.NUMERIC=[["0","9"]],xi.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],xi.ASCII=[[" ","~"]],xi.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:xi.ALPHANUMERIC},xi.available={};let hi=xi;var ub=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,cb=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const od=[],ad=[],hd=[],vm=class xm extends Wt{constructor(t,e={}){super();const{align:i,tint:s,maxWidth:n,letterSpacing:o,fontName:a,fontSize:h}=Object.assign({},xm.styleDefaults,e);if(!hi.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new st(s),this._font=void 0,this._fontName=a,this._fontSize=h,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Me(()=>{this.dirty=!0},this,0,0),this._roundPixels=U.ROUND_PIXELS,this.dirty=!0,this._resolution=U.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var z;const t=hi.available[this._fontName],e=this.fontSize,i=e/t.size,s=new j,n=[],o=[],a=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=ym(h),u=this._maxWidth*t.size/e,c=t.distanceFieldType==="none"?od:ad;let d=null,f=0,p=0,m=0,g=-1,y=0,v=0,_=0,x=0;for(let R=0;R<l.length;R++){const S=l[R],P=go(S);if(/(?:\s)/.test(S)&&(g=R,y=f,x++),S==="\r"||S===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++m,++v,s.x=0,s.y+=t.lineHeight,d=null,x=0;continue}const D=t.chars[P];if(!D)continue;d&&D.kerning[d]&&(s.x+=D.kerning[d]);const H=hd.pop()||{texture:k.EMPTY,line:0,charCode:0,prevSpaces:0,position:new j};H.texture=D.texture,H.line=m,H.charCode=P,H.position.x=Math.round(s.x+D.xOffset+this._letterSpacing/2),H.position.y=Math.round(s.y+D.yOffset),H.prevSpaces=x,n.push(H),f=H.position.x+Math.max(D.xAdvance-D.xOffset,D.texture.orig.width),s.x+=D.xAdvance+this._letterSpacing,_=Math.max(_,D.yOffset+D.texture.height),d=P,g!==-1&&u>0&&s.x>u&&(++v,hr(n,1+g-v,1+R-g),R=g,g=-1,o.push(y),a.push(n.length>0?n[n.length-1].prevSpaces:0),p=Math.max(p,y),m++,s.x=0,s.y+=t.lineHeight,d=null,x=0)}const b=l[l.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(f=y),o.push(f),p=Math.max(p,f),a.push(-1));const C=[];for(let R=0;R<=m;R++){let S=0;this._align==="right"?S=p-o[R]:this._align==="center"?S=(p-o[R])/2:this._align==="justify"&&(S=a[R]<0?0:(p-o[R])/a[R]),C.push(S)}const w=n.length,T={},A=[],I=this._activePagesMeshData;c.push(...I);for(let R=0;R<w;R++){const S=n[R].texture,P=S.baseTexture.uid;if(!T[P]){let D=c.pop();if(!D){const E=new En;let B,q;t.distanceFieldType==="none"?(B=new ss(k.EMPTY),q=W.NORMAL):(B=new ss(k.EMPTY,{program:Qe.from(cb,ub),uniforms:{uFWidth:0}}),q=W.NORMAL_NPM);const M=new rs(E,B);M.blendMode=q,D={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:M,vertices:null,uvs:null,indices:null}}D.index=0,D.indexCount=0,D.vertexCount=0,D.uvsCount=0,D.total=0;const{_textureCache:H}=this;H[P]=H[P]||new k(S.baseTexture),D.mesh.texture=H[P],D.mesh.tint=this._tintColor.value,A.push(D),T[P]=D}T[P].total++}for(let R=0;R<I.length;R++)A.includes(I[R])||this.removeChild(I[R].mesh);for(let R=0;R<A.length;R++)A[R].mesh.parent!==this&&this.addChild(A[R].mesh);this._activePagesMeshData=A;for(const R in T){const S=T[R],P=S.total;if(!(((z=S.indices)==null?void 0:z.length)>6*P)||S.vertices.length<rs.BATCHABLE_SIZE*2)S.vertices=new Float32Array(4*2*P),S.uvs=new Float32Array(4*2*P),S.indices=new Uint16Array(6*P);else{const D=S.total,H=S.vertices;for(let E=D*4*2;E<H.length;E++)H[E]=0}S.mesh.size=6*P}for(let R=0;R<w;R++){const S=n[R];let P=S.position.x+C[S.line]*(this._align==="justify"?S.prevSpaces:1);this._roundPixels&&(P=Math.round(P));const D=P*i,H=S.position.y*i,E=S.texture,B=T[E.baseTexture.uid],q=E.frame,M=E._uvs,O=B.index++;B.indices[O*6+0]=0+O*4,B.indices[O*6+1]=1+O*4,B.indices[O*6+2]=2+O*4,B.indices[O*6+3]=0+O*4,B.indices[O*6+4]=2+O*4,B.indices[O*6+5]=3+O*4,B.vertices[O*8+0]=D,B.vertices[O*8+1]=H,B.vertices[O*8+2]=D+q.width*i,B.vertices[O*8+3]=H,B.vertices[O*8+4]=D+q.width*i,B.vertices[O*8+5]=H+q.height*i,B.vertices[O*8+6]=D,B.vertices[O*8+7]=H+q.height*i,B.uvs[O*8+0]=M.x0,B.uvs[O*8+1]=M.y0,B.uvs[O*8+2]=M.x1,B.uvs[O*8+3]=M.y1,B.uvs[O*8+4]=M.x2,B.uvs[O*8+5]=M.y2,B.uvs[O*8+6]=M.x3,B.uvs[O*8+7]=M.y3}this._textWidth=p*i,this._textHeight=(s.y+t.lineHeight)*i;for(const R in T){const S=T[R];if(this.anchor.x!==0||this.anchor.y!==0){let E=0;const B=this._textWidth*this.anchor.x,q=this._textHeight*this.anchor.y;for(let M=0;M<S.total;M++)S.vertices[E++]-=B,S.vertices[E++]-=q,S.vertices[E++]-=B,S.vertices[E++]-=q,S.vertices[E++]-=B,S.vertices[E++]-=q,S.vertices[E++]-=B,S.vertices[E++]-=q}this._maxLineHeight=_*i;const P=S.mesh.geometry.getBuffer("aVertexPosition"),D=S.mesh.geometry.getBuffer("aTextureCoord"),H=S.mesh.geometry.getIndex();P.data=S.vertices,D.data=S.uvs,H.data=S.indices,P.update(),D.update(),H.update()}for(let R=0;R<n.length;R++)hd.push(n[R]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:i,size:s}=hi.available[this._fontName];if(i!=="none"){const{a:n,b:o,c:a,d:h}=this.worldTransform,l=Math.sqrt(n*n+o*o),u=Math.sqrt(a*a+h*h),c=(Math.abs(l)+Math.abs(u))/2,d=this.fontSize/s,f=t._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=c*e*d*f}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=hi.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!hi.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??hi.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,i=hi.available[this._fontName].distanceFieldType==="none"?od:ad;i.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],i.filter(s=>e[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=k.EMPTY});for(const s in e)e[s].destroy(),delete e[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};vm.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let db=vm;const fb=[".xml",".fnt"],bm={extension:{type:N.LoadParser,priority:xe.Normal},name:"loadBitmapFont",test(r){return fb.includes(It.extname(r).toLowerCase())},async testParse(r){return Gs.test(r)||Ho.test(r)},async parse(r,t,e){const i=Gs.test(r)?Gs.parse(r):Ho.parse(r),{src:s}=t,{page:n}=i,o=[];for(let l=0;l<n.length;++l){const u=n[l].file;let c=It.join(It.dirname(s),u);c=No(c,s),o.push(c)}const a=await e.load(o),h=o.map(l=>a[l]);return hi.install(i,h,!0)},async load(r,t){return(await U.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};$.add(bm);const sl=class Or extends si{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new Or(Object.keys(Or.defaultOptions).reduce((e,i)=>({...e,[i]:t[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete Or.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:i}=Or;if(i[t]){const s=i[t];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return U.ADAPTER.fetch(t).then(s=>s.blob()).then(async s=>new Promise((n,o)=>{const a=URL.createObjectURL(s),h=new FileReader;h.onload=()=>n([a,h.result]),h.onerror=o,h.readAsDataURL(s)})).then(async([s,n])=>{const o=Object.assign({family:It.basename(t,It.extname(t)),weight:"normal",style:"normal",display:"auto",src:s,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);i[t]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(i=>!this._overrides.includes(i));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(i=>this._overrides.includes(i));e.length>0&&(this._overrides=this._overrides.filter(i=>!e.includes(i)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=fs(t)),typeof t=="number"?yf(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const n=`${i}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,Or.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=U.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};sl.availableFonts={},sl.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let _o=sl;const Ds=class Lr extends ke{constructor(t="",e={}){super(k.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,s=k.from(i,{scaleMode:U.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new Z,s.trim=new Z,this.texture=s;const n="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),h=document.createElementNS(n,"foreignObject"),l=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");h.setAttribute("width","10000"),h.setAttribute("height","10000"),h.style.overflow="hidden",a.appendChild(h),this.maxWidth=Lr.defaultMaxWidth,this.maxHeight=Lr.defaultMaxHeight,this._domElement=l,this._styleElement=u,this._svgRoot=a,this._foreignObject=h,this._foreignObject.appendChild(u),this._foreignObject.appendChild(l),this._image=i,this._loadImage=new Image,this._autoResolution=Lr.defaultAutoResolution,this._resolution=Lr.defaultResolution??U.RESOLUTION,this.text=t,this.style=e}measureText(t){var u,c;const{text:e,style:i,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:i.toCSS(s)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=n;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const h=Math.min(this.maxWidth,Math.ceil(o)),l=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",h.toString()),this._svgRoot.setAttribute("height",l.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(u=this._style)==null?void 0:u.toCSS(s)}),this._styleElement.textContent=(c=this._style)==null?void 0:c.toGlobalCSS()),{width:h+i.padding*2,height:l+i.padding*2}}async updateText(t=!0){const{style:e,_image:i,_loadImage:s}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:n,height:o}=this.measureText();i.width=s.width=Math.ceil(Math.max(1,n)),i.height=s.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(h=>{s.onload=async()=>{if(a<this._updateID){h();return}await e.onBeforeDraw(),i.src=s.src,s.onload=null,s.src="",this.updateTexture(),h()};const l=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:i,resolution:s}=this,{padding:n}=t,{baseTexture:o}=e;e.trim.width=e._frame.width=i.width/s,e.trim.height=e._frame.height=i.height/s,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,s),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var i,s,n,o,a;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Lr.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=e,(s=this._svgRoot)==null||s.remove(),this._svgRoot=e,(n=this._domElement)==null||n.remove(),this._domElement=e,(o=this._foreignObject)==null||o.remove(),this._foreignObject=e,(a=this._styleElement)==null||a.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=fi(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=fi(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof _o?(this.ownsStyle=!1,this._style=t):t instanceof si?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=_o.from(t)):(this.ownsStyle=!0,this._style=new _o(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};Ds.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Ds.defaultMaxWidth=2024,Ds.defaultMaxHeight=2024,Ds.defaultAutoResolution=!0;let pb=Ds;const Tm=Object.freeze(Object.defineProperty({__proto__:null,ALPHA_MODES:jt,AbstractMultiResource:hu,AccessibilityManager:cu,AlphaFilter:up,AnimatedSprite:Go,Application:du,ArrayResource:ip,Assets:rr,AssetsClass:Rp,Attribute:qs,BLEND_MODES:W,BUFFER_BITS:wo,BUFFER_TYPE:Fe,BackgroundSystem:Zs,BaseImageResource:ri,BasePrepare:Uo,BaseRenderTexture:zl,BaseTexture:K,BatchDrawCall:Mo,BatchGeometry:Ul,BatchRenderer:Ti,BatchShaderGenerator:Bf,BatchSystem:Gl,BatchTextureArray:Fo,BitmapFont:hi,BitmapFontData:hn,BitmapText:db,BlobResource:Gp,BlurFilter:cp,BlurFilterPass:Oo,Bounds:en,BrowserAdapter:Gd,Buffer:yt,BufferResource:xn,BufferSystem:ou,CLEAR_MODES:Ce,COLOR_MASK_BITS:Ud,Cache:Ci,CanvasResource:rp,Circle:gr,Color:st,ColorMatrixFilter:Lo,CompressedTextureResource:Di,Container:Wt,ContextSystem:Qs,CountLimiter:um,CubeResource:np,DEG_TO_RAD:is,DRAW_MODES:Pe,DisplacementFilter:dp,DisplayObject:ct,ENV:zi,Ellipse:bn,EventBoundary:mp,EventSystem:ko,ExtensionType:N,Extract:qp,FORMATS:F,FORMATS_TO_COMPONENTS:Hp,FXAAFilter:fp,FederatedDisplayObject:gp,FederatedEvent:ps,FederatedMouseEvent:rn,FederatedPointerEvent:ce,FederatedWheelEvent:ur,FillStyle:Cn,Filter:tt,FilterState:Lf,FilterSystem:Xl,Framebuffer:Do,FramebufferSystem:Wl,GC_MODES:ea,GLFramebuffer:kf,GLProgram:$f,GLTexture:uo,GRAPHICS_CURVES:M1,GenerateTextureSystem:Ql,Geometry:mi,GeometrySystem:jl,Graphics:gu,GraphicsData:an,GraphicsGeometry:em,HTMLText:pb,HTMLTextStyle:_o,IGLUniformData:Wv,INSTALLED:Io,INTERNAL_FORMATS:Ft,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:nn,ImageBitmapResource:ir,ImageResource:Hl,LINE_CAP:pi,LINE_JOIN:re,LineStyle:ca,LoaderParserPriority:xe,MASK_TYPES:Ct,MIPMAP_MODES:Oe,MSAA_QUALITY:Tt,MaskData:Uf,MaskSystem:Yl,Matrix:ut,Mesh:rs,MeshBatchUvs:im,MeshGeometry:En,MeshMaterial:ss,MultisampleSystem:nu,NineSlicePlane:k1,NoiseFilter:pp,ObjectRenderer:Sn,ObjectRendererSystem:au,ObservablePoint:Me,PI_2:Ks,PRECISION:oe,ParticleContainer:G1,ParticleRenderer:_u,PlaneGeometry:nm,PluginSystem:Kl,Point:j,Polygon:Fi,Prepare:yu,Program:Qe,ProjectionSystem:Zl,Quad:Of,QuadUv:Vl,RAD_TO_DEG:Cf,RENDERER_TYPE:El,Rectangle:Z,RenderTexture:$i,RenderTexturePool:$l,RenderTextureSystem:Jl,Renderer:ha,ResizePlugin:fu,Resource:es,RopeGeometry:om,RoundedRectangle:Tn,Runner:he,SAMPLER_TYPES:G,SCALE_MODES:Re,SHAPES:Lt,SVGResource:Bo,ScissorSystem:Hf,Shader:Be,ShaderSystem:tu,SimpleMesh:N1,SimplePlane:am,SimpleRope:U1,Sprite:ke,SpriteMaskFilter:Nf,Spritesheet:rl,StartupSystem:Js,State:Le,StateSystem:Kf,StencilSystem:ql,SystemManager:Zf,TARGETS:nr,TEXT_GRADIENT:Pn,TYPES:X,TYPES_TO_BYTES_PER_COMPONENT:Zh,TYPES_TO_BYTES_PER_PIXEL:$p,TemporaryDisplayObject:op,Text:Rn,TextFormat:Gs,TextMetrics:ci,TextStyle:si,Texture:k,TextureGCSystem:wi,TextureMatrix:aa,TextureSystem:eu,TextureUvs:oa,Ticker:wt,TickerPlugin:ru,TilingSprite:vu,TilingSpriteRenderer:xu,TimeLimiter:eb,Transform:wn,TransformFeedback:cx,TransformFeedbackSystem:iu,UPDATE_PRIORITY:gi,UniformGroup:ye,VERSION:uu,VideoResource:lu,ViewSystem:tn,ViewableBuffer:Ro,WRAP_MODES:ti,XMLFormat:zo,XMLStringFormat:Ho,accessibleTarget:_p,autoDetectFormat:_m,autoDetectRenderer:tp,autoDetectResource:Nl,cacheTextureArray:Ip,checkDataUrl:xr,checkExtension:vi,checkMaxIfStatementsInShader:Af,convertToList:pe,copySearchParams:No,createStringVariations:xp,createTexture:ms,createUBOElements:Wf,curves:ki,defaultFilterVertex:su,defaultVertex:ep,detectAvif:Fp,detectCompressedTextures:Up,detectDefaults:Bp,detectMp4:Lp,detectOgv:kp,detectWebm:Op,detectWebp:Dp,extensions:$,filters:Xh,generateProgram:Vf,generateUniformBufferSync:Yf,getFontFamilyName:wp,getTestContext:If,getUBOData:jf,graphicsUtils:B1,groupD8:ft,isMobile:Ie,isSingleItem:sn,loadBitmapFont:bm,loadDDS:Xp,loadImageBitmap:Cp,loadJson:bp,loadKTX:Wp,loadSVG:Ep,loadTextures:An,loadTxt:Tp,loadVideo:Pp,loadWebFont:Sp,parseDDS:zp,parseKTX:Vp,resolveCompressedTextureUrl:jp,resolveTextureUrl:Np,settings:U,spritesheetAsset:gm,uniformParsers:lr,unsafeEvalSupported:Df,utils:gv},Symbol.toStringTag,{value:"Module"})),Jo=class Jo extends vr{constructor(e,i){super();L(this,"renderer");L(this,"rendererContainer");L(this,"currentOrientation");L(this,"width");L(this,"height");L(this,"scaleFactor");Jo.instance=this,this.initProperties(e,i),this.addResizeEvent()}initProperties(e,i){const s=new du({width:e,height:i,backgroundColor:0,resolution:window.devicePixelRatio||1,autoDensity:!0});s.renderer.view.id="videoslot",document.body.appendChild(s.view),this.rendererContainer=s.stage,this.renderer=s.renderer,this.width=e,this.height=i,this.scaleFactor=1,document.body.ontouchend=this.onFullscreenChange.bind(this),document.body.onclick=this.onFullscreenChange.bind(this),this.currentOrientation=Hr.None,this.onResize()}addResizeEvent(){window.addEventListener("resize",this.onResize.bind(this)),this.onResize()}onResize(){const e=window.innerWidth/this.width,i=window.innerHeight/this.height;this.scaleFactor=Math.min(e,i),this.renderer.resize(window.innerWidth,window.innerHeight),this.rendererContainer.scale.set(this.scaleFactor),this.emit("resize",{width:this.width*this.scaleFactor,height:this.height*this.scaleFactor}),this.setOrientationMode()}setOrientationMode(){const e=window.innerWidth,i=window.innerHeight;this.currentOrientation=i>=e?Hr.Portrait:Hr.Landscape}getCurrentOrientation(){return this.currentOrientation}setCurrentOrientation(e){this.currentOrientation=e,this.emit("orientationChanged",e)}onFullscreenChange(){const e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}getRenderer(){return this.renderer}getRendererContainer(){return this.rendererContainer}getWidth(){return this.width}getHeight(){return this.height}getScaleFactor(){return this.scaleFactor}};L(Jo,"instance");let ln=Jo;class Ke extends Wt{constructor(t,e,i,s){super(),s&&(this.name=s),i&&i.addChild(this),t&&(this.position.x=t),e&&(this.position.y=e)}sortChildren(){this.children.sort(function(t,e){return t.zIndex=t.zIndex||0,e.zIndex=e.zIndex||0,t.zIndex-e.zIndex})}}class da extends ke{constructor(e){super();L(this,"frames");L(this,"_state","Out");L(this,"_callback",null);L(this,"_isEnabled",!0);L(this,"_zIndex",0);this.width=e.width,this.height=e.height,this.anchor.set(.5,.5),this.position.set(e.x,e.y),this.interactive=!0,this.frames=e.config.frames,this._callback=e.callback||null,this.name=e.config.name||"button",e.parent&&e.parent.addChild(this),this.state="Out",this.initEvents()}initEvents(){this.on("pointerdown",this.onButtonDown,this),this.on("pointerup",this.onButtonUp,this),this.on("pointerover",this.onButtonOver,this),this.on("pointerout",this.onButtonOut,this),this.on("pointertap",this.onButtonOut,this)}onButtonDown(){this.state="Down"}onButtonUp(){this._callback&&this._callback.call(null,this),this.state="Out"}onButtonOver(){this.state="Over"}onButtonOut(){this.state="Out"}set state(e){this._state=e,this.texture=k.from(this.frames[e.toLowerCase()])}get state(){return this._state}set isEnabled(e){this._isEnabled=e,this.state=e?"Out":"Disabled",this.interactive=e}get isEnabled(){return this._isEnabled}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e}}class mb extends Rn{constructor(t,e,i,s){super(i.text,i.textStyle),i.name&&(this.name=i.name),this.position.set(t,e),this.anchor.set(.5,.5),s&&s.addChild(this)}setTextConfig(t){this.style=new si(t.textStyle),this.text=t.text}}class yo extends da{constructor(e){super(e);L(this,"_text");this._text=new mb(0,0,e.textConfig,this),e.config.name&&(this.name=e.config.name)}get textAsset(){return this._text}}class fa extends Ke{constructor(e,i,s,n){super(e,i,s,n);L(this,"game")}initDisplayEvents(){this.game&&this.game.on("orientationChanged",this.onOrientationChanged.bind(this))}onOrientationChanged(e){switch(e){case Hr.Landscape:this.setVisualLandscape();break;case Hr.Portrait:this.setVisualPortrait();break}}}const ui=class ui{};L(ui,"GeneralButton",{frames:{out:"generalbutton_out",over:"generalbutton_over",down:"generalbutton_down",disabled:"generalbutton_disabled"},name:"generalButton"}),L(ui,"GeneralTextStyle",{fontFamily:"Montserrat, sans-serif",fontSize:"14px",fontWeight:"bold",fill:"#d08f38",stroke:0,strokeThickness:3,align:"center"}),L(ui,"GenericText",{text:"Generic Text",textStyle:ui.GeneralTextStyle,name:"Generic Text"}),L(ui,"MenuText",{text:"Menu",textStyle:ui.GeneralTextStyle,name:"Menu Text"}),L(ui,"MenuButton",{frames:{out:"home_out",over:"home_over",down:"home_down",disabled:"home_disabled"},name:"Menu Button"});let Ee=ui;const Se=class Se{};L(Se,"FirstTaskText",{text:"First Task",textStyle:Ee.GeneralTextStyle,name:"First Text"}),L(Se,"SecondTaskText",{text:"Second Task",textStyle:Ee.GeneralTextStyle,name:"Second Text"}),L(Se,"ThirdTaskText",{text:"Third Task",textStyle:Ee.GeneralTextStyle,name:"Third Text"}),L(Se,"FirstTaskButtonText",{bConfig:Ee.GeneralButton,tConfig:Se.FirstTaskText,name:"First Task Button Text"}),L(Se,"SecondTaskButtonText",{bConfig:Ee.GeneralButton,tConfig:Se.SecondTaskText,name:"First Task Button Text"}),L(Se,"ThirdTaskButtonText",{bConfig:Ee.GeneralButton,tConfig:Se.ThirdTaskText,name:"Third Task Button Text"});let Si=Se;class wm extends ke{constructor(t,e,i,s,n,o){super(Gt[n.frame]),this.width=i,this.height=s,n.name?this.name=n.name:this.name="sprite",this.anchor.set(.5,.5),this.position.set(t,e),o&&o.addChild(this)}}const fe=class fe{};L(fe,"CardSprite",{frame:"card",name:"card"}),L(fe,"CardStackGeneralTextStyle",{fontFamily:"Montserrat, sans-serif",fontSize:"14px",fontWeight:"bold",fill:"#d08f38",stroke:0,strokeThickness:3,align:"center"}),L(fe,"CardStackGeneralButtonStyle",{frames:{out:"generalbutton_out",over:"generalbutton_over",down:"generalbutton_down",disabled:"generalbutton_disabled"},name:"generalButton"}),L(fe,"RestartText",{text:"Restart",textStyle:fe.CardStackGeneralTextStyle,name:"Restart Text"}),L(fe,"PlayText",{text:"Play",textStyle:fe.CardStackGeneralTextStyle,name:"Play Text"}),L(fe,"RestartButton",{bConfig:fe.CardStackGeneralButtonStyle,tConfig:fe.PlayText,name:"Restart Button Text"});let er=fe;class Yr{}L(Yr,"CardCounter",144),L(Yr,"CardAnimationDelay",1),L(Yr,"CardAnimationDuration",2);function li(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Sm(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var le={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ns={duration:.5,overwrite:!1,delay:0},bu,$t,pt,ge=1e8,lt=1/ge,nl=Math.PI*2,gb=nl/4,_b=0,Am=Math.sqrt,yb=Math.cos,vb=Math.sin,kt=function(t){return typeof t=="string"},vt=function(t){return typeof t=="function"},_i=function(t){return typeof t=="number"},Tu=function(t){return typeof t>"u"},ni=function(t){return typeof t=="object"},Yt=function(t){return t!==!1},wu=function(){return typeof window<"u"},eo=function(t){return vt(t)||kt(t)},Cm=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Vt=Array.isArray,ol=/(?:-?\.?\d|\.)+/gi,Em=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Nr=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ih=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Pm=/[+-]=-?[.\d]+/,Rm=/[^,'"\[\]\s]+/gi,xb=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,mt,Ye,al,Su,ue={},$o={},Im,Mm=function(t){return($o=_r(t,ue))&&Qt},Au=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},un=function(t,e){return!e&&console.warn(t)},Fm=function(t,e){return t&&(ue[t]=e)&&$o&&($o[t]=e)||ue},cn=function(){return 0},bb={suppressEvents:!0,isStart:!0,kill:!1},vo={suppressEvents:!0,kill:!1},Tb={suppressEvents:!0},Cu={},Bi=[],hl={},Dm,se={},rh={},ld=30,xo=[],Eu="",Pu=function(t){var e=t[0],i,s;if(ni(e)||vt(e)||(t=[t]),!(i=(e._gsap||{}).harness)){for(s=xo.length;s--&&!xo[s].targetTest(e););i=xo[s]}for(s=t.length;s--;)t[s]&&(t[s]._gsap||(t[s]._gsap=new rg(t[s],i)))||t.splice(s,1);return t},cr=function(t){return t._gsap||Pu(_e(t))[0]._gsap},Bm=function(t,e,i){return(i=t[e])&&vt(i)?t[e]():Tu(i)&&t.getAttribute&&t.getAttribute(e)||i},qt=function(t,e){return(t=t.split(",")).forEach(e)||t},bt=function(t){return Math.round(t*1e5)/1e5||0},Ot=function(t){return Math.round(t*1e7)/1e7||0},qr=function(t,e){var i=e.charAt(0),s=parseFloat(e.substr(2));return t=parseFloat(t),i==="+"?t+s:i==="-"?t-s:i==="*"?t*s:t/s},wb=function(t,e){for(var i=e.length,s=0;t.indexOf(e[s])<0&&++s<i;);return s<i},Vo=function(){var t=Bi.length,e=Bi.slice(0),i,s;for(hl={},Bi.length=0,i=0;i<t;i++)s=e[i],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},Om=function(t,e,i,s){Bi.length&&!$t&&Vo(),t.render(e,i,s||$t&&e<0&&(t._initted||t._startAt)),Bi.length&&!$t&&Vo()},Lm=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(Rm).length<2?e:kt(t)?t.trim():t},km=function(t){return t},ve=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},Sb=function(t){return function(e,i){for(var s in i)s in e||s==="duration"&&t||s==="ease"||(e[s]=i[s])}},_r=function(t,e){for(var i in e)t[i]=e[i];return t},ud=function r(t,e){for(var i in e)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(t[i]=ni(e[i])?r(t[i]||(t[i]={}),e[i]):e[i]);return t},Xo=function(t,e){var i={},s;for(s in t)s in e||(i[s]=t[s]);return i},zs=function(t){var e=t.parent||mt,i=t.keyframes?Sb(Vt(t.keyframes)):ve;if(Yt(t.inherit))for(;e;)i(t,e.vars.defaults),e=e.parent||e._dp;return t},Ab=function(t,e){for(var i=t.length,s=i===e.length;s&&i--&&t[i]===e[i];);return i<0},Nm=function(t,e,i,s,n){i===void 0&&(i="_first"),s===void 0&&(s="_last");var o=t[s],a;if(n)for(a=e[n];o&&o[n]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[s]=e,e._prev=o,e.parent=e._dp=t,e},pa=function(t,e,i,s){i===void 0&&(i="_first"),s===void 0&&(s="_last");var n=e._prev,o=e._next;n?n._next=o:t[i]===e&&(t[i]=o),o?o._prev=n:t[s]===e&&(t[s]=n),e._next=e._prev=e.parent=null},Ni=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},dr=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},Cb=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},ll=function(t,e,i,s){return t._startAt&&($t?t._startAt.revert(vo):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,s))},Eb=function r(t){return!t||t._ts&&r(t.parent)},cd=function(t){return t._repeat?os(t._tTime,t=t.duration()+t._rDelay)*t:0},os=function(t,e){var i=Math.floor(t/=e);return t&&i===t?i-1:i},Wo=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},ma=function(t){return t._end=Ot(t._start+(t._tDur/Math.abs(t._ts||t._rts||lt)||0))},ga=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=Ot(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),ma(t),i._dirty||dr(i,t)),t},Um=function(t,e){var i;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(i=Wo(t.rawTime(),e),(!e._dur||In(0,e.totalDuration(),i)-e._tTime>lt)&&e.render(i,!0)),dr(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-lt}},Ze=function(t,e,i,s){return e.parent&&Ni(e),e._start=Ot((_i(i)?i:i||t!==mt?de(t,i,e):t._time)+e._delay),e._end=Ot(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Nm(t,e,"_first","_last",t._sort?"_start":0),ul(e)||(t._recent=e),s||Um(t,e),t._ts<0&&ga(t,t._tTime),t},Gm=function(t,e){return(ue.ScrollTrigger||Au("scrollTrigger",e))&&ue.ScrollTrigger.create(e,t)},zm=function(t,e,i,s,n){if(Iu(t,e,n),!t._initted)return 1;if(!i&&t._pt&&!$t&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Dm!==ne.frame)return Bi.push(t),t._lazy=[n,s],1},Pb=function r(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||r(e))},ul=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},Rb=function(t,e,i,s){var n=t.ratio,o=e<0||!e&&(!t._start&&Pb(t)&&!(!t._initted&&ul(t))||(t._ts<0||t._dp._ts<0)&&!ul(t))?0:1,a=t._rDelay,h=0,l,u,c;if(a&&t._repeat&&(h=In(0,t._tDur,e),u=os(h,a),t._yoyo&&u&1&&(o=1-o),u!==os(t._tTime,a)&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||$t||s||t._zTime===lt||!e&&t._zTime){if(!t._initted&&zm(t,e,s,i,h))return;for(c=t._zTime,t._zTime=e||(i?lt:0),i||(i=e&&!c),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,l=t._pt;l;)l.r(o,l.d),l=l._next;e<0&&ll(t,e,i,!0),t._onUpdate&&!i&&ae(t,"onUpdate"),h&&t._repeat&&!i&&t.parent&&ae(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&Ni(t,1),!i&&!$t&&(ae(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},Ib=function(t,e,i){var s;if(i>e)for(s=t._first;s&&s._start<=i;){if(s.data==="isPause"&&s._start>e)return s;s=s._next}else for(s=t._last;s&&s._start>=i;){if(s.data==="isPause"&&s._start<e)return s;s=s._prev}},as=function(t,e,i,s){var n=t._repeat,o=Ot(e)||0,a=t._tTime/t._tDur;return a&&!s&&(t._time*=o/t._dur),t._dur=o,t._tDur=n?n<0?1e10:Ot(o*(n+1)+t._rDelay*n):o,a>0&&!s&&ga(t,t._tTime=t._tDur*a),t.parent&&ma(t),i||dr(t.parent,t),t},dd=function(t){return t instanceof Ht?dr(t):as(t,t._dur)},Mb={_start:0,endTime:cn,totalDuration:cn},de=function r(t,e,i){var s=t.labels,n=t._recent||Mb,o=t.duration()>=ge?n.endTime(!1):t._dur,a,h,l;return kt(e)&&(isNaN(e)||e in s)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?n:i).totalDuration()/100:1)):a<0?(e in s||(s[e]=o),s[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&i&&(h=h/100*(Vt(i)?i[0]:i).totalDuration()),a>1?r(t,e.substr(0,a-1),i)+h:o+h)):e==null?o:+e},Hs=function(t,e,i){var s=_i(e[1]),n=(s?2:1)+(t<2?0:1),o=e[n],a,h;if(s&&(o.duration=e[1]),o.parent=i,t){for(a=o,h=i;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=Yt(h.vars.inherit)&&h.parent;o.immediateRender=Yt(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[n-1]}return new Et(e[0],o,e[n+1])},Vi=function(t,e){return t||t===0?e(t):e},In=function(t,e,i){return i<t?t:i>e?e:i},zt=function(t,e){return!kt(t)||!(e=xb.exec(t))?"":e[1]},Fb=function(t,e,i){return Vi(i,function(s){return In(t,e,s)})},cl=[].slice,Hm=function(t,e){return t&&ni(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&ni(t[0]))&&!t.nodeType&&t!==Ye},Db=function(t,e,i){return i===void 0&&(i=[]),t.forEach(function(s){var n;return kt(s)&&!e||Hm(s,1)?(n=i).push.apply(n,_e(s)):i.push(s)})||i},_e=function(t,e,i){return pt&&!e&&pt.selector?pt.selector(t):kt(t)&&!i&&(al||!hs())?cl.call((e||Su).querySelectorAll(t),0):Vt(t)?Db(t,i):Hm(t)?cl.call(t,0):t?[t]:[]},dl=function(t){return t=_e(t)[0]||un("Invalid scope")||{},function(e){var i=t.current||t.nativeElement||t;return _e(e,i.querySelectorAll?i:i===t?un("Invalid scope")||Su.createElement("div"):t)}},$m=function(t){return t.sort(function(){return .5-Math.random()})},Vm=function(t){if(vt(t))return t;var e=ni(t)?t:{each:t},i=fr(e.ease),s=e.from||0,n=parseFloat(e.base)||0,o={},a=s>0&&s<1,h=isNaN(s)||a,l=e.axis,u=s,c=s;return kt(s)?u=c={center:.5,edges:.5,end:1}[s]||0:!a&&h&&(u=s[0],c=s[1]),function(d,f,p){var m=(p||e).length,g=o[m],y,v,_,x,b,C,w,T,A;if(!g){if(A=e.grid==="auto"?0:(e.grid||[1,ge])[1],!A){for(w=-ge;w<(w=p[A++].getBoundingClientRect().left)&&A<m;);A<m&&A--}for(g=o[m]=[],y=h?Math.min(A,m)*u-.5:s%A,v=A===ge?0:h?m*c/A-.5:s/A|0,w=0,T=ge,C=0;C<m;C++)_=C%A-y,x=v-(C/A|0),g[C]=b=l?Math.abs(l==="y"?x:_):Am(_*_+x*x),b>w&&(w=b),b<T&&(T=b);s==="random"&&$m(g),g.max=w-T,g.min=T,g.v=m=(parseFloat(e.amount)||parseFloat(e.each)*(A>m?m-1:l?l==="y"?m/A:A:Math.max(A,m/A))||0)*(s==="edges"?-1:1),g.b=m<0?n-m:n,g.u=zt(e.amount||e.each)||0,i=i&&m<0?tg(i):i}return m=(g[d]-g.min)/g.max||0,Ot(g.b+(i?i(m):m)*g.v)+g.u}},fl=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(i){var s=Ot(Math.round(parseFloat(i)/t)*t*e);return(s-s%1)/e+(_i(i)?0:zt(i))}},Xm=function(t,e){var i=Vt(t),s,n;return!i&&ni(t)&&(s=i=t.radius||ge,t.values?(t=_e(t.values),(n=!_i(t[0]))&&(s*=s)):t=fl(t.increment)),Vi(e,i?vt(t)?function(o){return n=t(o),Math.abs(n-o)<=s?n:o}:function(o){for(var a=parseFloat(n?o.x:o),h=parseFloat(n?o.y:0),l=ge,u=0,c=t.length,d,f;c--;)n?(d=t[c].x-a,f=t[c].y-h,d=d*d+f*f):d=Math.abs(t[c]-a),d<l&&(l=d,u=c);return u=!s||l<=s?t[u]:o,n||u===o||_i(o)?u:u+zt(o)}:fl(t))},Wm=function(t,e,i,s){return Vi(Vt(t)?!e:i===!0?!!(i=0):!s,function(){return Vt(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(s=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+i*.99))/i)*i*s)/s})},Bb=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(s){return e.reduce(function(n,o){return o(n)},s)}},Ob=function(t,e){return function(i){return t(parseFloat(i))+(e||zt(i))}},Lb=function(t,e,i){return Ym(t,e,0,1,i)},jm=function(t,e,i){return Vi(i,function(s){return t[~~e(s)]})},kb=function r(t,e,i){var s=e-t;return Vt(t)?jm(t,r(0,t.length),e):Vi(i,function(n){return(s+(n-t)%s)%s+t})},Nb=function r(t,e,i){var s=e-t,n=s*2;return Vt(t)?jm(t,r(0,t.length-1),e):Vi(i,function(o){return o=(n+(o-t)%n)%n||0,t+(o>s?n-o:o)})},dn=function(t){for(var e=0,i="",s,n,o,a;~(s=t.indexOf("random(",e));)o=t.indexOf(")",s),a=t.charAt(s+7)==="[",n=t.substr(s+7,o-s-7).match(a?Rm:ol),i+=t.substr(e,s-e)+Wm(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),e=o+1;return i+t.substr(e,t.length-e)},Ym=function(t,e,i,s,n){var o=e-t,a=s-i;return Vi(n,function(h){return i+((h-t)/o*a||0)})},Ub=function r(t,e,i,s){var n=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!n){var o=kt(t),a={},h,l,u,c,d;if(i===!0&&(s=1)&&(i=null),o)t={p:t},e={p:e};else if(Vt(t)&&!Vt(e)){for(u=[],c=t.length,d=c-2,l=1;l<c;l++)u.push(r(t[l-1],t[l]));c--,n=function(p){p*=c;var m=Math.min(d,~~p);return u[m](p-m)},i=e}else s||(t=_r(Vt(t)?[]:{},t));if(!u){for(h in e)Ru.call(a,t,h,"get",e[h]);n=function(p){return Du(p,a)||(o?t.p:t)}}}return Vi(i,n)},fd=function(t,e,i){var s=t.labels,n=ge,o,a,h;for(o in s)a=s[o]-e,a<0==!!i&&a&&n>(a=Math.abs(a))&&(h=o,n=a);return h},ae=function(t,e,i){var s=t.vars,n=s[e],o=pt,a=t._ctx,h,l,u;if(n)return h=s[e+"Params"],l=s.callbackScope||t,i&&Bi.length&&Vo(),a&&(pt=a),u=h?n.apply(l,h):n.call(l),pt=o,u},Bs=function(t){return Ni(t),t.scrollTrigger&&t.scrollTrigger.kill(!!$t),t.progress()<1&&ae(t,"onInterrupt"),t},Ur,qm=[],Km=function(t){if(t)if(t=!t.name&&t.default||t,wu()||t.headless){var e=t.name,i=vt(t),s=e&&!i&&t.init?function(){this._props=[]}:t,n={init:cn,render:Du,add:Ru,kill:eT,modifier:tT,rawVars:0},o={targetTest:0,get:0,getSetter:Fu,aliases:{},register:0};if(hs(),t!==s){if(se[e])return;ve(s,ve(Xo(t,n),o)),_r(s.prototype,_r(n,Xo(t,o))),se[s.prop=e]=s,t.targetTest&&(xo.push(s),Cu[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Fm(e,s),t.register&&t.register(Qt,s,Kt)}else qm.push(t)},ot=255,Os={aqua:[0,ot,ot],lime:[0,ot,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ot],navy:[0,0,128],white:[ot,ot,ot],olive:[128,128,0],yellow:[ot,ot,0],orange:[ot,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ot,0,0],pink:[ot,192,203],cyan:[0,ot,ot],transparent:[ot,ot,ot,0]},sh=function(t,e,i){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(i-e)*t*6:t<.5?i:t*3<2?e+(i-e)*(2/3-t)*6:e)*ot+.5|0},Zm=function(t,e,i){var s=t?_i(t)?[t>>16,t>>8&ot,t&ot]:0:Os.black,n,o,a,h,l,u,c,d,f,p;if(!s){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Os[t])s=Os[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+n+n+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return s=parseInt(t.substr(1,6),16),[s>>16,s>>8&ot,s&ot,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),s=[t>>16,t>>8&ot,t&ot]}else if(t.substr(0,3)==="hsl"){if(s=p=t.match(ol),!e)h=+s[0]%360/360,l=+s[1]/100,u=+s[2]/100,o=u<=.5?u*(l+1):u+l-u*l,n=u*2-o,s.length>3&&(s[3]*=1),s[0]=sh(h+1/3,n,o),s[1]=sh(h,n,o),s[2]=sh(h-1/3,n,o);else if(~t.indexOf("="))return s=t.match(Em),i&&s.length<4&&(s[3]=1),s}else s=t.match(ol)||Os.transparent;s=s.map(Number)}return e&&!p&&(n=s[0]/ot,o=s[1]/ot,a=s[2]/ot,c=Math.max(n,o,a),d=Math.min(n,o,a),u=(c+d)/2,c===d?h=l=0:(f=c-d,l=u>.5?f/(2-c-d):f/(c+d),h=c===n?(o-a)/f+(o<a?6:0):c===o?(a-n)/f+2:(n-o)/f+4,h*=60),s[0]=~~(h+.5),s[1]=~~(l*100+.5),s[2]=~~(u*100+.5)),i&&s.length<4&&(s[3]=1),s},Qm=function(t){var e=[],i=[],s=-1;return t.split(Oi).forEach(function(n){var o=n.match(Nr)||[];e.push.apply(e,o),i.push(s+=o.length+1)}),e.c=i,e},pd=function(t,e,i){var s="",n=(t+s).match(Oi),o=e?"hsla(":"rgba(",a=0,h,l,u,c;if(!n)return t;if(n=n.map(function(d){return(d=Zm(d,e,1))&&o+(e?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(u=Qm(t),h=i.c,h.join(s)!==u.c.join(s)))for(l=t.replace(Oi,"1").split(Nr),c=l.length-1;a<c;a++)s+=l[a]+(~h.indexOf(a)?n.shift()||o+"0,0,0,0)":(u.length?u:n.length?n:i).shift());if(!l)for(l=t.split(Oi),c=l.length-1;a<c;a++)s+=l[a]+n[a];return s+l[c]},Oi=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Os)r+="|"+t+"\\b";return new RegExp(r+")","gi")}(),Gb=/hsl[a]?\(/,Jm=function(t){var e=t.join(" "),i;if(Oi.lastIndex=0,Oi.test(e))return i=Gb.test(e),t[1]=pd(t[1],i),t[0]=pd(t[0],i,Qm(t[1])),!0},fn,ne=function(){var r=Date.now,t=500,e=33,i=r(),s=i,n=1e3/240,o=n,a=[],h,l,u,c,d,f,p=function m(g){var y=r()-s,v=g===!0,_,x,b,C;if((y>t||y<0)&&(i+=y-e),s+=y,b=s-i,_=b-o,(_>0||v)&&(C=++c.frame,d=b-c.time*1e3,c.time=b=b/1e3,o+=_+(_>=n?4:n-_),x=1),v||(h=l(m)),x)for(f=0;f<a.length;f++)a[f](b,d,C,g)};return c={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){Im&&(!al&&wu()&&(Ye=al=window,Su=Ye.document||{},ue.gsap=Qt,(Ye.gsapVersions||(Ye.gsapVersions=[])).push(Qt.version),Mm($o||Ye.GreenSockGlobals||!Ye.gsap&&Ye||{}),qm.forEach(Km)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&c.sleep(),l=u||function(g){return setTimeout(g,o-c.time*1e3+1|0)},fn=1,p(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(h),fn=0,l=cn},lagSmoothing:function(g,y){t=g||1/0,e=Math.min(y||33,t)},fps:function(g){n=1e3/(g||240),o=c.time*1e3+n},add:function(g,y,v){var _=y?function(x,b,C,w){g(x,b,C,w),c.remove(_)}:g;return c.remove(g),a[v?"unshift":"push"](_),hs(),_},remove:function(g,y){~(y=a.indexOf(g))&&a.splice(y,1)&&f>=y&&f--},_listeners:a},c}(),hs=function(){return!fn&&ne.wake()},it={},zb=/^[\d.\-M][\d.\-,\s]/,Hb=/["']/g,$b=function(t){for(var e={},i=t.substr(1,t.length-3).split(":"),s=i[0],n=1,o=i.length,a,h,l;n<o;n++)h=i[n],a=n!==o-1?h.lastIndexOf(","):h.length,l=h.substr(0,a),e[s]=isNaN(l)?l.replace(Hb,"").trim():+l,s=h.substr(a+1).trim();return e},Vb=function(t){var e=t.indexOf("(")+1,i=t.indexOf(")"),s=t.indexOf("(",e);return t.substring(e,~s&&s<i?t.indexOf(")",i+1):i)},Xb=function(t){var e=(t+"").split("("),i=it[e[0]];return i&&e.length>1&&i.config?i.config.apply(null,~t.indexOf("{")?[$b(e[1])]:Vb(t).split(",").map(Lm)):it._CE&&zb.test(t)?it._CE("",t):i},tg=function(t){return function(e){return 1-t(1-e)}},eg=function r(t,e){for(var i=t._first,s;i;)i instanceof Ht?r(i,e):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==e&&(i.timeline?r(i.timeline,e):(s=i._ease,i._ease=i._yEase,i._yEase=s,i._yoyo=e)),i=i._next},fr=function(t,e){return t&&(vt(t)?t:it[t]||Xb(t))||e},br=function(t,e,i,s){i===void 0&&(i=function(h){return 1-e(1-h)}),s===void 0&&(s=function(h){return h<.5?e(h*2)/2:1-e((1-h)*2)/2});var n={easeIn:e,easeOut:i,easeInOut:s},o;return qt(t,function(a){it[a]=ue[a]=n,it[o=a.toLowerCase()]=i;for(var h in n)it[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=it[a+"."+h]=n[h]}),n},ig=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},nh=function r(t,e,i){var s=e>=1?e:1,n=(i||(t?.3:.45))/(e<1?e:1),o=n/nl*(Math.asin(1/s)||0),a=function(u){return u===1?1:s*Math.pow(2,-10*u)*vb((u-o)*n)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:ig(a);return n=nl/n,h.config=function(l,u){return r(t,l,u)},h},oh=function r(t,e){e===void 0&&(e=1.70158);var i=function(o){return o?--o*o*((e+1)*o+e)+1:0},s=t==="out"?i:t==="in"?function(n){return 1-i(1-n)}:ig(i);return s.config=function(n){return r(t,n)},s};qt("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,t){var e=t<5?t+1:t;br(r+",Power"+(e-1),t?function(i){return Math.pow(i,e)}:function(i){return i},function(i){return 1-Math.pow(1-i,e)},function(i){return i<.5?Math.pow(i*2,e)/2:1-Math.pow((1-i)*2,e)/2})});it.Linear.easeNone=it.none=it.Linear.easeIn;br("Elastic",nh("in"),nh("out"),nh());(function(r,t){var e=1/t,i=2*e,s=2.5*e,n=function(a){return a<e?r*a*a:a<i?r*Math.pow(a-1.5/t,2)+.75:a<s?r*(a-=2.25/t)*a+.9375:r*Math.pow(a-2.625/t,2)+.984375};br("Bounce",function(o){return 1-n(1-o)},n)})(7.5625,2.75);br("Expo",function(r){return r?Math.pow(2,10*(r-1)):0});br("Circ",function(r){return-(Am(1-r*r)-1)});br("Sine",function(r){return r===1?1:-yb(r*gb)+1});br("Back",oh("in"),oh("out"),oh());it.SteppedEase=it.steps=ue.SteppedEase={config:function(t,e){t===void 0&&(t=1);var i=1/t,s=t+(e?0:1),n=e?1:0,o=1-lt;return function(a){return((s*In(0,o,a)|0)+n)*i}}};ns.ease=it["quad.out"];qt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return Eu+=r+","+r+"Params,"});var rg=function(t,e){this.id=_b++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Bm,this.set=e?e.getSetter:Fu},pn=function(){function r(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,as(this,+e.duration,1,1),this.data=e.data,pt&&(this._ctx=pt,pt.data.push(this)),fn||ne.wake()}var t=r.prototype;return t.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},t.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},t.totalDuration=function(i){return arguments.length?(this._dirty=0,as(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(i,s){if(hs(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(ga(this,i),!n._dp||n.parent||Um(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&Ze(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===lt||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Om(this,i,s)),this},t.time=function(i,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+cd(this))%(this._dur+this._rDelay)||(i?this._dur:0),s):this._time},t.totalProgress=function(i,s){return arguments.length?this.totalTime(this.totalDuration()*i,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},t.progress=function(i,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+cd(this),s):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(i,s){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*n,s):this._repeat?os(this._tTime,n)+1:1},t.timeScale=function(i,s){if(!arguments.length)return this._rts===-lt?0:this._rts;if(this._rts===i)return this;var n=this.parent&&this._ts?Wo(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-lt?0:this._rts,this.totalTime(In(-Math.abs(this._delay),this._tDur,n),s!==!1),ma(this),Cb(this)},t.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(hs(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==lt&&(this._tTime-=lt)))),this):this._ps},t.startTime=function(i){if(arguments.length){this._start=i;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&Ze(s,this,i-this._delay),this}return this._start},t.endTime=function(i){return this._start+(Yt(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(i){var s=this.parent||this._dp;return s?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Wo(s.rawTime(i),this):this._tTime:this._tTime},t.revert=function(i){i===void 0&&(i=Tb);var s=$t;return $t=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),$t=s,this},t.globalTime=function(i){for(var s=this,n=arguments.length?i:s.rawTime();s;)n=s._start+n/(Math.abs(s._ts)||1),s=s._dp;return!this.parent&&this._sat?this._sat.globalTime(i):n},t.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,dd(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(i){if(arguments.length){var s=this._time;return this._rDelay=i,dd(this),s?this.time(s):this}return this._rDelay},t.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},t.seek=function(i,s){return this.totalTime(de(this,i),Yt(s))},t.restart=function(i,s){return this.play().totalTime(i?-this._delay:0,Yt(s))},t.play=function(i,s){return i!=null&&this.seek(i,s),this.reversed(!1).paused(!1)},t.reverse=function(i,s){return i!=null&&this.seek(i||this.totalDuration(),s),this.reversed(!0).paused(!1)},t.pause=function(i,s){return i!=null&&this.seek(i,s),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-lt:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-lt,this},t.isActive=function(){var i=this.parent||this._dp,s=this._start,n;return!!(!i||this._ts&&this._initted&&i.isActive()&&(n=i.rawTime(!0))>=s&&n<this.endTime(!0)-lt)},t.eventCallback=function(i,s,n){var o=this.vars;return arguments.length>1?(s?(o[i]=s,n&&(o[i+"Params"]=n),i==="onUpdate"&&(this._onUpdate=s)):delete o[i],this):o[i]},t.then=function(i){var s=this;return new Promise(function(n){var o=vt(i)?i:km,a=function(){var l=s.then;s.then=null,vt(o)&&(o=o(s))&&(o.then||o===s)&&(s.then=l),n(o),s.then=l};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?a():s._prom=a})},t.kill=function(){Bs(this)},r}();ve(pn.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-lt,_prom:0,_ps:!1,_rts:1});var Ht=function(r){Sm(t,r);function t(i,s){var n;return i===void 0&&(i={}),n=r.call(this,i)||this,n.labels={},n.smoothChildTiming=!!i.smoothChildTiming,n.autoRemoveChildren=!!i.autoRemoveChildren,n._sort=Yt(i.sortChildren),mt&&Ze(i.parent||mt,li(n),s),i.reversed&&n.reverse(),i.paused&&n.paused(!0),i.scrollTrigger&&Gm(li(n),i.scrollTrigger),n}var e=t.prototype;return e.to=function(s,n,o){return Hs(0,arguments,this),this},e.from=function(s,n,o){return Hs(1,arguments,this),this},e.fromTo=function(s,n,o,a){return Hs(2,arguments,this),this},e.set=function(s,n,o){return n.duration=0,n.parent=this,zs(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new Et(s,n,de(this,o),1),this},e.call=function(s,n,o){return Ze(this,Et.delayedCall(0,s,n),o)},e.staggerTo=function(s,n,o,a,h,l,u){return o.duration=n,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new Et(s,o,de(this,h)),this},e.staggerFrom=function(s,n,o,a,h,l,u){return o.runBackwards=1,zs(o).immediateRender=Yt(o.immediateRender),this.staggerTo(s,n,o,a,h,l,u)},e.staggerFromTo=function(s,n,o,a,h,l,u,c){return a.startAt=o,zs(a).immediateRender=Yt(a.immediateRender),this.staggerTo(s,n,a,h,l,u,c)},e.render=function(s,n,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=s<=0?0:Ot(s),c=this._zTime<0!=s<0&&(this._initted||!l),d,f,p,m,g,y,v,_,x,b,C,w;if(this!==mt&&u>h&&s>=0&&(u=h),u!==this._tTime||o||c){if(a!==this._time&&l&&(u+=this._time-a,s+=this._time-a),d=u,x=this._start,_=this._ts,y=!_,c&&(l||(a=this._zTime),(s||!n)&&(this._zTime=s)),this._repeat){if(C=this._yoyo,g=l+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(g*100+s,n,o);if(d=Ot(u%g),u===h?(m=this._repeat,d=l):(m=~~(u/g),m&&m===u/g&&(d=l,m--),d>l&&(d=l)),b=os(this._tTime,g),!a&&this._tTime&&b!==m&&this._tTime-b*g-this._dur<=0&&(b=m),C&&m&1&&(d=l-d,w=1),m!==b&&!this._lock){var T=C&&b&1,A=T===(C&&m&1);if(m<b&&(T=!T),a=T?0:u%l?l:u,this._lock=1,this.render(a||(w?0:Ot(m*g)),n,!l)._lock=0,this._tTime=u,!n&&this.parent&&ae(this,"onRepeat"),this.vars.repeatRefresh&&!w&&(this.invalidate()._lock=1),a&&a!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,h=this._tDur,A&&(this._lock=2,a=T?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!w&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;eg(this,w)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=Ib(this,Ot(a),Ot(d)),v&&(u-=d-(d=v._start))),this._tTime=u,this._time=d,this._act=!_,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,a=0),!a&&d&&!n&&!m&&(ae(this,"onStart"),this._tTime!==u))return this;if(d>=a&&s>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&v!==f){if(f.parent!==this)return this.render(s,n,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,n,o),d!==this._time||!this._ts&&!y){v=0,p&&(u+=this._zTime=-lt);break}}f=p}else{f=this._last;for(var I=s<0?s:d;f;){if(p=f._prev,(f._act||I<=f._end)&&f._ts&&v!==f){if(f.parent!==this)return this.render(s,n,o);if(f.render(f._ts>0?(I-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(I-f._start)*f._ts,n,o||$t&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!y){v=0,p&&(u+=this._zTime=I?-lt:lt);break}}f=p}}if(v&&!n&&(this.pause(),v.render(d>=a?0:-lt)._zTime=d>=a?1:-1,this._ts))return this._start=x,ma(this),this.render(s,n,o);this._onUpdate&&!n&&ae(this,"onUpdate",!0),(u===h&&this._tTime>=this.totalDuration()||!u&&a)&&(x===this._start||Math.abs(_)!==Math.abs(this._ts))&&(this._lock||((s||!l)&&(u===h&&this._ts>0||!u&&this._ts<0)&&Ni(this,1),!n&&!(s<0&&!a)&&(u||a||!h)&&(ae(this,u===h&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<h&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(s,n){var o=this;if(_i(n)||(n=de(this,n,s)),!(s instanceof pn)){if(Vt(s))return s.forEach(function(a){return o.add(a,n)}),this;if(kt(s))return this.addLabel(s,n);if(vt(s))s=Et.delayedCall(0,s);else return this}return this!==s?Ze(this,s,n):this},e.getChildren=function(s,n,o,a){s===void 0&&(s=!0),n===void 0&&(n=!0),o===void 0&&(o=!0),a===void 0&&(a=-ge);for(var h=[],l=this._first;l;)l._start>=a&&(l instanceof Et?n&&h.push(l):(o&&h.push(l),s&&h.push.apply(h,l.getChildren(!0,n,o)))),l=l._next;return h},e.getById=function(s){for(var n=this.getChildren(1,1,1),o=n.length;o--;)if(n[o].vars.id===s)return n[o]},e.remove=function(s){return kt(s)?this.removeLabel(s):vt(s)?this.killTweensOf(s):(pa(this,s),s===this._recent&&(this._recent=this._last),dr(this))},e.totalTime=function(s,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ot(ne.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),r.prototype.totalTime.call(this,s,n),this._forcing=0,this):this._tTime},e.addLabel=function(s,n){return this.labels[s]=de(this,n),this},e.removeLabel=function(s){return delete this.labels[s],this},e.addPause=function(s,n,o){var a=Et.delayedCall(0,n||cn,o);return a.data="isPause",this._hasPause=1,Ze(this,a,de(this,s))},e.removePause=function(s){var n=this._first;for(s=de(this,s);n;)n._start===s&&n.data==="isPause"&&Ni(n),n=n._next},e.killTweensOf=function(s,n,o){for(var a=this.getTweensOf(s,o),h=a.length;h--;)Pi!==a[h]&&a[h].kill(s,n);return this},e.getTweensOf=function(s,n){for(var o=[],a=_e(s),h=this._first,l=_i(n),u;h;)h instanceof Et?wb(h._targets,a)&&(l?(!Pi||h._initted&&h._ts)&&h.globalTime(0)<=n&&h.globalTime(h.totalDuration())>n:!n||h.isActive())&&o.push(h):(u=h.getTweensOf(a,n)).length&&o.push.apply(o,u),h=h._next;return o},e.tweenTo=function(s,n){n=n||{};var o=this,a=de(o,s),h=n,l=h.startAt,u=h.onStart,c=h.onStartParams,d=h.immediateRender,f,p=Et.to(o,ve({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||lt,onStart:function(){if(o.pause(),!f){var g=n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());p._dur!==g&&as(p,g,0,1).render(p._time,!0,!0),f=1}u&&u.apply(p,c||[])}},n));return d?p.render(0):p},e.tweenFromTo=function(s,n,o){return this.tweenTo(n,ve({startAt:{time:de(this,s)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(s){return s===void 0&&(s=this._time),fd(this,de(this,s))},e.previousLabel=function(s){return s===void 0&&(s=this._time),fd(this,de(this,s),1)},e.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+lt)},e.shiftChildren=function(s,n,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,l;a;)a._start>=o&&(a._start+=s,a._end+=s),a=a._next;if(n)for(l in h)h[l]>=o&&(h[l]+=s);return dr(this)},e.invalidate=function(s){var n=this._first;for(this._lock=0;n;)n.invalidate(s),n=n._next;return r.prototype.invalidate.call(this,s)},e.clear=function(s){s===void 0&&(s=!0);for(var n=this._first,o;n;)o=n._next,this.remove(n),n=o;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),dr(this)},e.totalDuration=function(s){var n=0,o=this,a=o._last,h=ge,l,u,c;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-s:s));if(o._dirty){for(c=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ze(o,a,u-a._delay,1)._lock=0):h=u,u<0&&a._ts&&(n-=u,(!c&&!o._dp||c&&c.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),h=0),a._end>n&&a._ts&&(n=a._end),a=l;as(o,o===mt&&o._time>n?o._time:n,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(s){if(mt._ts&&(Om(mt,Wo(s,mt)),Dm=ne.frame),ne.frame>=ld){ld+=le.autoSleep||120;var n=mt._first;if((!n||!n._ts)&&le.autoSleep&&ne._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||ne.sleep()}}},t}(pn);ve(Ht.prototype,{_lock:0,_hasPause:0,_forcing:0});var Wb=function(t,e,i,s,n,o,a){var h=new Kt(this._pt,t,e,0,1,lg,null,n),l=0,u=0,c,d,f,p,m,g,y,v;for(h.b=i,h.e=s,i+="",s+="",(y=~s.indexOf("random("))&&(s=dn(s)),o&&(v=[i,s],o(v,t,e),i=v[0],s=v[1]),d=i.match(ih)||[];c=ih.exec(s);)p=c[0],m=s.substring(l,c.index),f?f=(f+1)%5:m.substr(-5)==="rgba("&&(f=1),p!==d[u++]&&(g=parseFloat(d[u-1])||0,h._pt={_next:h._pt,p:m||u===1?m:",",s:g,c:p.charAt(1)==="="?qr(g,p)-g:parseFloat(p)-g,m:f&&f<4?Math.round:0},l=ih.lastIndex);return h.c=l<s.length?s.substring(l,s.length):"",h.fp=a,(Pm.test(s)||y)&&(h.e=0),this._pt=h,h},Ru=function(t,e,i,s,n,o,a,h,l,u){vt(s)&&(s=s(n||0,t,o));var c=t[e],d=i!=="get"?i:vt(c)?l?t[e.indexOf("set")||!vt(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():c,f=vt(c)?l?Zb:ag:Mu,p;if(kt(s)&&(~s.indexOf("random(")&&(s=dn(s)),s.charAt(1)==="="&&(p=qr(d,s)+(zt(d)||0),(p||p===0)&&(s=p))),!u||d!==s||pl)return!isNaN(d*s)&&s!==""?(p=new Kt(this._pt,t,e,+d||0,s-(d||0),typeof c=="boolean"?Jb:hg,0,f),l&&(p.fp=l),a&&p.modifier(a,this,t),this._pt=p):(!c&&!(e in t)&&Au(e,s),Wb.call(this,t,e,d,s,f,h||le.stringFilter,l))},jb=function(t,e,i,s,n){if(vt(t)&&(t=$s(t,n,e,i,s)),!ni(t)||t.style&&t.nodeType||Vt(t)||Cm(t))return kt(t)?$s(t,n,e,i,s):t;var o={},a;for(a in t)o[a]=$s(t[a],n,e,i,s);return o},sg=function(t,e,i,s,n,o){var a,h,l,u;if(se[t]&&(a=new se[t]).init(n,a.rawVars?e[t]:jb(e[t],s,n,o,i),i,s,o)!==!1&&(i._pt=h=new Kt(i._pt,n,t,0,1,a.render,a,0,a.priority),i!==Ur))for(l=i._ptLookup[i._targets.indexOf(n)],u=a._props.length;u--;)l[a._props[u]]=h;return a},Pi,pl,Iu=function r(t,e,i){var s=t.vars,n=s.ease,o=s.startAt,a=s.immediateRender,h=s.lazy,l=s.onUpdate,u=s.runBackwards,c=s.yoyoEase,d=s.keyframes,f=s.autoRevert,p=t._dur,m=t._startAt,g=t._targets,y=t.parent,v=y&&y.data==="nested"?y.vars.targets:g,_=t._overwrite==="auto"&&!bu,x=t.timeline,b,C,w,T,A,I,z,R,S,P,D,H,E;if(x&&(!d||!n)&&(n="none"),t._ease=fr(n,ns.ease),t._yEase=c?tg(fr(c===!0?n:c,ns.ease)):0,c&&t._yoyo&&!t._repeat&&(c=t._yEase,t._yEase=t._ease,t._ease=c),t._from=!x&&!!s.runBackwards,!x||d&&!s.stagger){if(R=g[0]?cr(g[0]).harness:0,H=R&&s[R.prop],b=Xo(s,Cu),m&&(m._zTime<0&&m.progress(1),e<0&&u&&a&&!f?m.render(-1,!0):m.revert(u&&p?vo:bb),m._lazy=0),o){if(Ni(t._startAt=Et.set(g,ve({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!m&&Yt(h),startAt:null,delay:0,onUpdate:l&&function(){return ae(t,"onUpdate")},stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&($t||!a&&!f)&&t._startAt.revert(vo),a&&p&&e<=0&&i<=0){e&&(t._zTime=e);return}}else if(u&&p&&!m){if(e&&(a=!1),w=ve({overwrite:!1,data:"isFromStart",lazy:a&&!m&&Yt(h),immediateRender:a,stagger:0,parent:y},b),H&&(w[R.prop]=H),Ni(t._startAt=Et.set(g,w)),t._startAt._dp=0,t._startAt._sat=t,e<0&&($t?t._startAt.revert(vo):t._startAt.render(-1,!0)),t._zTime=e,!a)r(t._startAt,lt,lt);else if(!e)return}for(t._pt=t._ptCache=0,h=p&&Yt(h)||h&&!p,C=0;C<g.length;C++){if(A=g[C],z=A._gsap||Pu(g)[C]._gsap,t._ptLookup[C]=P={},hl[z.id]&&Bi.length&&Vo(),D=v===g?C:v.indexOf(A),R&&(S=new R).init(A,H||b,t,D,v)!==!1&&(t._pt=T=new Kt(t._pt,A,S.name,0,1,S.render,S,0,S.priority),S._props.forEach(function(B){P[B]=T}),S.priority&&(I=1)),!R||H)for(w in b)se[w]&&(S=sg(w,b,t,D,A,v))?S.priority&&(I=1):P[w]=T=Ru.call(t,A,w,"get",b[w],D,v,0,s.stringFilter);t._op&&t._op[C]&&t.kill(A,t._op[C]),_&&t._pt&&(Pi=t,mt.killTweensOf(A,P,t.globalTime(e)),E=!t.parent,Pi=0),t._pt&&h&&(hl[z.id]=1)}I&&ug(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!E,d&&e<=0&&x.render(ge,!0,!0)},Yb=function(t,e,i,s,n,o,a,h){var l=(t._pt&&t._ptCache||(t._ptCache={}))[e],u,c,d,f;if(!l)for(l=t._ptCache[e]=[],d=t._ptLookup,f=t._targets.length;f--;){if(u=d[f][e],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==e&&u.fp!==e;)u=u._next;if(!u)return pl=1,t.vars[e]="+=0",Iu(t,a),pl=0,h?un(e+" not eligible for reset"):1;l.push(u)}for(f=l.length;f--;)c=l[f],u=c._pt||c,u.s=(s||s===0)&&!n?s:u.s+(s||0)+o*u.c,u.c=i-u.s,c.e&&(c.e=bt(i)+zt(c.e)),c.b&&(c.b=u.s+zt(c.b))},qb=function(t,e){var i=t[0]?cr(t[0]).harness:0,s=i&&i.aliases,n,o,a,h;if(!s)return e;n=_r({},e);for(o in s)if(o in n)for(h=s[o].split(","),a=h.length;a--;)n[h[a]]=n[o];return n},Kb=function(t,e,i,s){var n=e.ease||s||"power1.inOut",o,a;if(Vt(e))a=i[t]||(i[t]=[]),e.forEach(function(h,l){return a.push({t:l/(e.length-1)*100,v:h,e:n})});else for(o in e)a=i[o]||(i[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:n})},$s=function(t,e,i,s,n){return vt(t)?t.call(e,i,s,n):kt(t)&&~t.indexOf("random(")?dn(t):t},ng=Eu+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",og={};qt(ng+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return og[r]=1});var Et=function(r){Sm(t,r);function t(i,s,n,o){var a;typeof s=="number"&&(n.duration=s,s=n,n=null),a=r.call(this,o?s:zs(s))||this;var h=a.vars,l=h.duration,u=h.delay,c=h.immediateRender,d=h.stagger,f=h.overwrite,p=h.keyframes,m=h.defaults,g=h.scrollTrigger,y=h.yoyoEase,v=s.parent||mt,_=(Vt(i)||Cm(i)?_i(i[0]):"length"in s)?[i]:_e(i),x,b,C,w,T,A,I,z;if(a._targets=_.length?Pu(_):un("GSAP target "+i+" not found. https://gsap.com",!le.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||eo(l)||eo(u)){if(s=a.vars,x=a.timeline=new Ht({data:"nested",defaults:m||{},targets:v&&v.data==="nested"?v.vars.targets:_}),x.kill(),x.parent=x._dp=li(a),x._start=0,d||eo(l)||eo(u)){if(w=_.length,I=d&&Vm(d),ni(d))for(T in d)~ng.indexOf(T)&&(z||(z={}),z[T]=d[T]);for(b=0;b<w;b++)C=Xo(s,og),C.stagger=0,y&&(C.yoyoEase=y),z&&_r(C,z),A=_[b],C.duration=+$s(l,li(a),b,A,_),C.delay=(+$s(u,li(a),b,A,_)||0)-a._delay,!d&&w===1&&C.delay&&(a._delay=u=C.delay,a._start+=u,C.delay=0),x.to(A,C,I?I(b,A,_):0),x._ease=it.none;x.duration()?l=u=0:a.timeline=0}else if(p){zs(ve(x.vars.defaults,{ease:"none"})),x._ease=fr(p.ease||s.ease||"none");var R=0,S,P,D;if(Vt(p))p.forEach(function(H){return x.to(_,H,">")}),x.duration();else{C={};for(T in p)T==="ease"||T==="easeEach"||Kb(T,p[T],C,p.easeEach);for(T in C)for(S=C[T].sort(function(H,E){return H.t-E.t}),R=0,b=0;b<S.length;b++)P=S[b],D={ease:P.e,duration:(P.t-(b?S[b-1].t:0))/100*l},D[T]=P.v,x.to(_,D,R),R+=D.duration;x.duration()<l&&x.to({},{duration:l-x.duration()})}}l||a.duration(l=x.duration())}else a.timeline=0;return f===!0&&!bu&&(Pi=li(a),mt.killTweensOf(_),Pi=0),Ze(v,li(a),n),s.reversed&&a.reverse(),s.paused&&a.paused(!0),(c||!l&&!p&&a._start===Ot(v._time)&&Yt(c)&&Eb(li(a))&&v.data!=="nested")&&(a._tTime=-lt,a.render(Math.max(0,-u)||0)),g&&Gm(li(a),g),a}var e=t.prototype;return e.render=function(s,n,o){var a=this._time,h=this._tDur,l=this._dur,u=s<0,c=s>h-lt&&!u?h:s<lt?0:s,d,f,p,m,g,y,v,_,x;if(!l)Rb(this,s,n,o);else if(c!==this._tTime||!s||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=c,_=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(m*100+s,n,o);if(d=Ot(c%m),c===h?(p=this._repeat,d=l):(p=~~(c/m),p&&p===Ot(c/m)&&(d=l,p--),d>l&&(d=l)),y=this._yoyo&&p&1,y&&(x=this._yEase,d=l-d),g=os(this._tTime,m),d===a&&!o&&this._initted&&p===g)return this._tTime=c,this;p!==g&&(_&&this._yEase&&eg(_,y),this.vars.repeatRefresh&&!y&&!this._lock&&this._time!==m&&this._initted&&(this._lock=o=1,this.render(Ot(m*p),!0).invalidate()._lock=0))}if(!this._initted){if(zm(this,u?s:d,o,n,c))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&p!==g))return this;if(l!==this._dur)return this.render(s,n,o)}if(this._tTime=c,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(x||this._ease)(d/l),this._from&&(this.ratio=v=1-v),d&&!a&&!n&&!p&&(ae(this,"onStart"),this._tTime!==c))return this;for(f=this._pt;f;)f.r(v,f.d),f=f._next;_&&_.render(s<0?s:_._dur*_._ease(d/this._dur),n,o)||this._startAt&&(this._zTime=s),this._onUpdate&&!n&&(u&&ll(this,s,n,o),ae(this,"onUpdate")),this._repeat&&p!==g&&this.vars.onRepeat&&!n&&this.parent&&ae(this,"onRepeat"),(c===this._tDur||!c)&&this._tTime===c&&(u&&!this._onUpdate&&ll(this,s,!0,!0),(s||!l)&&(c===this._tDur&&this._ts>0||!c&&this._ts<0)&&Ni(this,1),!n&&!(u&&!a)&&(c||a||y)&&(ae(this,c===h?"onComplete":"onReverseComplete",!0),this._prom&&!(c<h&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),r.prototype.invalidate.call(this,s)},e.resetTo=function(s,n,o,a,h){fn||ne.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||Iu(this,l),u=this._ease(l/this._dur),Yb(this,s,n,o,a,u,l,h)?this.resetTo(s,n,o,a,1):(ga(this,0),this.parent||Nm(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(s,n){if(n===void 0&&(n="all"),!s&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?Bs(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(s,n,Pi&&Pi.vars.overwrite!==!0)._first||Bs(this),this.parent&&o!==this.timeline.totalDuration()&&as(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=s?_e(s):a,l=this._ptLookup,u=this._pt,c,d,f,p,m,g,y;if((!n||n==="all")&&Ab(a,h))return n==="all"&&(this._pt=0),Bs(this);for(c=this._op=this._op||[],n!=="all"&&(kt(n)&&(m={},qt(n,function(v){return m[v]=1}),n=m),n=qb(a,n)),y=a.length;y--;)if(~h.indexOf(a[y])){d=l[y],n==="all"?(c[y]=n,p=d,f={}):(f=c[y]=c[y]||{},p=n);for(m in p)g=d&&d[m],g&&((!("kill"in g.d)||g.d.kill(m)===!0)&&pa(this,g,"_pt"),delete d[m]),f!=="all"&&(f[m]=1)}return this._initted&&!this._pt&&u&&Bs(this),this},t.to=function(s,n){return new t(s,n,arguments[2])},t.from=function(s,n){return Hs(1,arguments)},t.delayedCall=function(s,n,o,a){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:n,onReverseComplete:n,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(s,n,o){return Hs(2,arguments)},t.set=function(s,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(s,n)},t.killTweensOf=function(s,n,o){return mt.killTweensOf(s,n,o)},t}(pn);ve(Et.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});qt("staggerTo,staggerFrom,staggerFromTo",function(r){Et[r]=function(){var t=new Ht,e=cl.call(arguments,0);return e.splice(r==="staggerFromTo"?5:4,0,0),t[r].apply(t,e)}});var Mu=function(t,e,i){return t[e]=i},ag=function(t,e,i){return t[e](i)},Zb=function(t,e,i,s){return t[e](s.fp,i)},Qb=function(t,e,i){return t.setAttribute(e,i)},Fu=function(t,e){return vt(t[e])?ag:Tu(t[e])&&t.setAttribute?Qb:Mu},hg=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Jb=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},lg=function(t,e){var i=e._pt,s="";if(!t&&e.b)s=e.b;else if(t===1&&e.e)s=e.e;else{for(;i;)s=i.p+(i.m?i.m(i.s+i.c*t):Math.round((i.s+i.c*t)*1e4)/1e4)+s,i=i._next;s+=e.c}e.set(e.t,e.p,s,e)},Du=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},tT=function(t,e,i,s){for(var n=this._pt,o;n;)o=n._next,n.p===s&&n.modifier(t,e,i),n=o},eT=function(t){for(var e=this._pt,i,s;e;)s=e._next,e.p===t&&!e.op||e.op===t?pa(this,e,"_pt"):e.dep||(i=1),e=s;return!i},iT=function(t,e,i,s){s.mSet(t,e,s.m.call(s.tween,i,s.mt),s)},ug=function(t){for(var e=t._pt,i,s,n,o;e;){for(i=e._next,s=n;s&&s.pr>e.pr;)s=s._next;(e._prev=s?s._prev:o)?e._prev._next=e:n=e,(e._next=s)?s._prev=e:o=e,e=i}t._pt=n},Kt=function(){function r(e,i,s,n,o,a,h,l,u){this.t=i,this.s=n,this.c=o,this.p=s,this.r=a||hg,this.d=h||this,this.set=l||Mu,this.pr=u||0,this._next=e,e&&(e._prev=this)}var t=r.prototype;return t.modifier=function(i,s,n){this.mSet=this.mSet||this.set,this.set=iT,this.m=i,this.mt=n,this.tween=s},r}();qt(Eu+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return Cu[r]=1});ue.TweenMax=ue.TweenLite=Et;ue.TimelineLite=ue.TimelineMax=Ht;mt=new Ht({sortChildren:!1,defaults:ns,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});le.stringFilter=Jm;var pr=[],bo={},rT=[],md=0,sT=0,ah=function(t){return(bo[t]||rT).map(function(e){return e()})},ml=function(){var t=Date.now(),e=[];t-md>2&&(ah("matchMediaInit"),pr.forEach(function(i){var s=i.queries,n=i.conditions,o,a,h,l;for(a in s)o=Ye.matchMedia(s[a]).matches,o&&(h=1),o!==n[a]&&(n[a]=o,l=1);l&&(i.revert(),h&&e.push(i))}),ah("matchMediaRevert"),e.forEach(function(i){return i.onMatch(i,function(s){return i.add(null,s)})}),md=t,ah("matchMedia"))},cg=function(){function r(e,i){this.selector=i&&dl(i),this.data=[],this._r=[],this.isReverted=!1,this.id=sT++,e&&this.add(e)}var t=r.prototype;return t.add=function(i,s,n){vt(i)&&(n=s,s=i,i=vt);var o=this,a=function(){var l=pt,u=o.selector,c;return l&&l!==o&&l.data.push(o),n&&(o.selector=dl(n)),pt=o,c=s.apply(o,arguments),vt(c)&&o._r.push(c),pt=l,o.selector=u,o.isReverted=!1,c};return o.last=a,i===vt?a(o,function(h){return o.add(null,h)}):i?o[i]=a:a},t.ignore=function(i){var s=pt;pt=null,i(this),pt=s},t.getTweens=function(){var i=[];return this.data.forEach(function(s){return s instanceof r?i.push.apply(i,s.getTweens()):s instanceof Et&&!(s.parent&&s.parent.data==="nested")&&i.push(s)}),i},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(i,s){var n=this;if(i?function(){for(var a=n.getTweens(),h=n.data.length,l;h--;)l=n.data[h],l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,c){return c.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),h=n.data.length;h--;)l=n.data[h],l instanceof Ht?l.data!=="nested"&&(l.scrollTrigger&&l.scrollTrigger.revert(),l.kill()):!(l instanceof Et)&&l.revert&&l.revert(i);n._r.forEach(function(u){return u(i,n)}),n.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),s)for(var o=pr.length;o--;)pr[o].id===this.id&&pr.splice(o,1)},t.revert=function(i){this.kill(i||{})},r}(),nT=function(){function r(e){this.contexts=[],this.scope=e,pt&&pt.data.push(this)}var t=r.prototype;return t.add=function(i,s,n){ni(i)||(i={matches:i});var o=new cg(0,n||this.scope),a=o.conditions={},h,l,u;pt&&!o.selector&&(o.selector=pt.selector),this.contexts.push(o),s=o.add("onMatch",s),o.queries=i;for(l in i)l==="all"?u=1:(h=Ye.matchMedia(i[l]),h&&(pr.indexOf(o)<0&&pr.push(o),(a[l]=h.matches)&&(u=1),h.addListener?h.addListener(ml):h.addEventListener("change",ml)));return u&&s(o,function(c){return o.add(null,c)}),this},t.revert=function(i){this.kill(i||{})},t.kill=function(i){this.contexts.forEach(function(s){return s.kill(i,!0)})},r}(),jo={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(s){return Km(s)})},timeline:function(t){return new Ht(t)},getTweensOf:function(t,e){return mt.getTweensOf(t,e)},getProperty:function(t,e,i,s){kt(t)&&(t=_e(t)[0]);var n=cr(t||{}).get,o=i?km:Lm;return i==="native"&&(i=""),t&&(e?o((se[e]&&se[e].get||n)(t,e,i,s)):function(a,h,l){return o((se[a]&&se[a].get||n)(t,a,h,l))})},quickSetter:function(t,e,i){if(t=_e(t),t.length>1){var s=t.map(function(u){return Qt.quickSetter(u,e,i)}),n=s.length;return function(u){for(var c=n;c--;)s[c](u)}}t=t[0]||{};var o=se[e],a=cr(t),h=a.harness&&(a.harness.aliases||{})[e]||e,l=o?function(u){var c=new o;Ur._pt=0,c.init(t,i?u+i:u,Ur,0,[t]),c.render(1,c),Ur._pt&&Du(1,Ur)}:a.set(t,h);return o?l:function(u){return l(t,h,i?u+i:u,a,1)}},quickTo:function(t,e,i){var s,n=Qt.to(t,_r((s={},s[e]="+=0.1",s.paused=!0,s),i||{})),o=function(h,l,u){return n.resetTo(e,h,l,u)};return o.tween=n,o},isTweening:function(t){return mt.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=fr(t.ease,ns.ease)),ud(ns,t||{})},config:function(t){return ud(le,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,s=t.plugins,n=t.defaults,o=t.extendTimeline;(s||"").split(",").forEach(function(a){return a&&!se[a]&&!ue[a]&&un(e+" effect requires "+a+" plugin.")}),rh[e]=function(a,h,l){return i(_e(a),ve(h||{},n),l)},o&&(Ht.prototype[e]=function(a,h,l){return this.add(rh[e](a,ni(h)?h:(l=h)&&{},this),l)})},registerEase:function(t,e){it[t]=fr(e)},parseEase:function(t,e){return arguments.length?fr(t,e):it},getById:function(t){return mt.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var i=new Ht(t),s,n;for(i.smoothChildTiming=Yt(t.smoothChildTiming),mt.remove(i),i._dp=0,i._time=i._tTime=mt._time,s=mt._first;s;)n=s._next,(e||!(!s._dur&&s instanceof Et&&s.vars.onComplete===s._targets[0]))&&Ze(i,s,s._start-s._delay),s=n;return Ze(mt,i,0),i},context:function(t,e){return t?new cg(t,e):pt},matchMedia:function(t){return new nT(t)},matchMediaRefresh:function(){return pr.forEach(function(t){var e=t.conditions,i,s;for(s in e)e[s]&&(e[s]=!1,i=1);i&&t.revert()})||ml()},addEventListener:function(t,e){var i=bo[t]||(bo[t]=[]);~i.indexOf(e)||i.push(e)},removeEventListener:function(t,e){var i=bo[t],s=i&&i.indexOf(e);s>=0&&i.splice(s,1)},utils:{wrap:kb,wrapYoyo:Nb,distribute:Vm,random:Wm,snap:Xm,normalize:Lb,getUnit:zt,clamp:Fb,splitColor:Zm,toArray:_e,selector:dl,mapRange:Ym,pipe:Bb,unitize:Ob,interpolate:Ub,shuffle:$m},install:Mm,effects:rh,ticker:ne,updateRoot:Ht.updateRoot,plugins:se,globalTimeline:mt,core:{PropTween:Kt,globals:Fm,Tween:Et,Timeline:Ht,Animation:pn,getCache:cr,_removeLinkedListItem:pa,reverting:function(){return $t},context:function(t){return t&&pt&&(pt.data.push(t),t._ctx=pt),pt},suppressOverwrites:function(t){return bu=t}}};qt("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return jo[r]=Et[r]});ne.add(Ht.updateRoot);Ur=jo.to({},{duration:0});var oT=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},aT=function(t,e){var i=t._targets,s,n,o;for(s in e)for(n=i.length;n--;)o=t._ptLookup[n][s],o&&(o=o.d)&&(o._pt&&(o=oT(o,s)),o&&o.modifier&&o.modifier(e[s],t,i[n],s))},hh=function(t,e){return{name:t,rawVars:1,init:function(s,n,o){o._onInit=function(a){var h,l;if(kt(n)&&(h={},qt(n,function(u){return h[u]=1}),n=h),e){h={};for(l in n)h[l]=e(n[l]);n=h}aT(a,n)}}}},Qt=jo.registerPlugin({name:"attr",init:function(t,e,i,s,n){var o,a,h;this.tween=i;for(o in e)h=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(h||0)+"",e[o],s,n,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(t,e){for(var i=e._pt;i;)$t?i.set(i.t,i.p,i.b,i):i.r(t,i.d),i=i._next}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i],0,0,0,0,0,1)}},hh("roundProps",fl),hh("modifiers"),hh("snap",Xm))||jo;Et.version=Ht.version=Qt.version="3.12.5";Im=1;wu()&&hs();it.Power0;it.Power1;it.Power2;it.Power3;it.Power4;it.Linear;it.Quad;it.Cubic;it.Quart;it.Quint;it.Strong;it.Elastic;it.Back;it.SteppedEase;it.Bounce;it.Sine;it.Expo;it.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var gd,Ri,Kr,Bu,sr,_d,Ou,hT=function(){return typeof window<"u"},yi={},Ji=180/Math.PI,Zr=Math.PI/180,Pr=Math.atan2,yd=1e8,Lu=/([A-Z])/g,lT=/(left|right|width|margin|padding|x)/i,uT=/[\s,\(]\S/,Je={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},gl=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},cT=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},dT=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},fT=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},dg=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},fg=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},pT=function(t,e,i){return t.style[e]=i},mT=function(t,e,i){return t.style.setProperty(e,i)},gT=function(t,e,i){return t._gsap[e]=i},_T=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},yT=function(t,e,i,s,n){var o=t._gsap;o.scaleX=o.scaleY=i,o.renderTransform(n,o)},vT=function(t,e,i,s,n){var o=t._gsap;o[e]=i,o.renderTransform(n,o)},_t="transform",Zt=_t+"Origin",xT=function r(t,e){var i=this,s=this.target,n=s.style,o=s._gsap;if(t in yi&&n){if(this.tfm=this.tfm||{},t!=="transform")t=Je[t]||t,~t.indexOf(",")?t.split(",").forEach(function(a){return i.tfm[a]=di(s,a)}):this.tfm[t]=o.x?o[t]:di(s,t),t===Zt&&(this.tfm.zOrigin=o.zOrigin);else return Je.transform.split(",").forEach(function(a){return r.call(i,a,e)});if(this.props.indexOf(_t)>=0)return;o.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(Zt,e,"")),t=_t}(n||e)&&this.props.push(t,e,n[t])},pg=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},bT=function(){var t=this.props,e=this.target,i=e.style,s=e._gsap,n,o;for(n=0;n<t.length;n+=3)t[n+1]?e[t[n]]=t[n+2]:t[n+2]?i[t[n]]=t[n+2]:i.removeProperty(t[n].substr(0,2)==="--"?t[n]:t[n].replace(Lu,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)s[o]=this.tfm[o];s.svg&&(s.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=Ou(),(!n||!n.isStart)&&!i[_t]&&(pg(i),s.zOrigin&&i[Zt]&&(i[Zt]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},mg=function(t,e){var i={target:t,props:[],revert:bT,save:xT};return t._gsap||Qt.core.getCache(t),e&&e.split(",").forEach(function(s){return i.save(s)}),i},gg,_l=function(t,e){var i=Ri.createElementNS?Ri.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Ri.createElement(t);return i&&i.style?i:Ri.createElement(t)},ei=function r(t,e,i){var s=getComputedStyle(t);return s[e]||s.getPropertyValue(e.replace(Lu,"-$1").toLowerCase())||s.getPropertyValue(e)||!i&&r(t,ls(e)||e,1)||""},vd="O,Moz,ms,Ms,Webkit".split(","),ls=function(t,e,i){var s=e||sr,n=s.style,o=5;if(t in n&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(vd[o]+t in n););return o<0?null:(o===3?"ms":o>=0?vd[o]:"")+t},yl=function(){hT()&&window.document&&(gd=window,Ri=gd.document,Kr=Ri.documentElement,sr=_l("div")||{style:{}},_l("div"),_t=ls(_t),Zt=_t+"Origin",sr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",gg=!!ls("perspective"),Ou=Qt.core.reverting,Bu=1)},lh=function r(t){var e=_l("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,s=this.nextSibling,n=this.style.cssText,o;if(Kr.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(s?i.insertBefore(this,s):i.appendChild(this)),Kr.removeChild(e),this.style.cssText=n,o},xd=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},_g=function(t){var e;try{e=t.getBBox()}catch{e=lh.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===lh||(e=lh.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+xd(t,["x","cx","x1"])||0,y:+xd(t,["y","cy","y1"])||0,width:0,height:0}:e},yg=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&_g(t))},yr=function(t,e){if(e){var i=t.style,s;e in yi&&e!==Zt&&(e=_t),i.removeProperty?(s=e.substr(0,2),(s==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),i.removeProperty(s==="--"?e:e.replace(Lu,"-$1").toLowerCase())):i.removeAttribute(e)}},Ii=function(t,e,i,s,n,o){var a=new Kt(t._pt,e,i,0,1,o?fg:dg);return t._pt=a,a.b=s,a.e=n,t._props.push(i),a},bd={deg:1,rad:1,turn:1},TT={grid:1,flex:1},Ui=function r(t,e,i,s){var n=parseFloat(i)||0,o=(i+"").trim().substr((n+"").length)||"px",a=sr.style,h=lT.test(e),l=t.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(h?"Width":"Height"),c=100,d=s==="px",f=s==="%",p,m,g,y;if(s===o||!n||bd[s]||bd[o])return n;if(o!=="px"&&!d&&(n=r(t,e,i,"px")),y=t.getCTM&&yg(t),(f||o==="%")&&(yi[e]||~e.indexOf("adius")))return p=y?t.getBBox()[h?"width":"height"]:t[u],bt(f?n/p*c:n/100*p);if(a[h?"width":"height"]=c+(d?o:s),m=~e.indexOf("adius")||s==="em"&&t.appendChild&&!l?t:t.parentNode,y&&(m=(t.ownerSVGElement||{}).parentNode),(!m||m===Ri||!m.appendChild)&&(m=Ri.body),g=m._gsap,g&&f&&g.width&&h&&g.time===ne.time&&!g.uncache)return bt(n/g.width*c);if(f&&(e==="height"||e==="width")){var v=t.style[e];t.style[e]=c+s,p=t[u],v?t.style[e]=v:yr(t,e)}else(f||o==="%")&&!TT[ei(m,"display")]&&(a.position=ei(t,"position")),m===t&&(a.position="static"),m.appendChild(sr),p=sr[u],m.removeChild(sr),a.position="absolute";return h&&f&&(g=cr(m),g.time=ne.time,g.width=m[u]),bt(d?p*n/c:p&&n?c/p*n:0)},di=function(t,e,i,s){var n;return Bu||yl(),e in Je&&e!=="transform"&&(e=Je[e],~e.indexOf(",")&&(e=e.split(",")[0])),yi[e]&&e!=="transform"?(n=gn(t,s),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:qo(ei(t,Zt))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||s||~(n+"").indexOf("calc("))&&(n=Yo[e]&&Yo[e](t,e,i)||ei(t,e)||Bm(t,e)||(e==="opacity"?1:0))),i&&!~(n+"").trim().indexOf(" ")?Ui(t,e,n,i)+i:n},wT=function(t,e,i,s){if(!i||i==="none"){var n=ls(e,t,1),o=n&&ei(t,n,1);o&&o!==i?(e=n,i=o):e==="borderColor"&&(i=ei(t,"borderTopColor"))}var a=new Kt(this._pt,t.style,e,0,1,lg),h=0,l=0,u,c,d,f,p,m,g,y,v,_,x,b;if(a.b=i,a.e=s,i+="",s+="",s==="auto"&&(m=t.style[e],t.style[e]=s,s=ei(t,e)||s,m?t.style[e]=m:yr(t,e)),u=[i,s],Jm(u),i=u[0],s=u[1],d=i.match(Nr)||[],b=s.match(Nr)||[],b.length){for(;c=Nr.exec(s);)g=c[0],v=s.substring(h,c.index),p?p=(p+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(p=1),g!==(m=d[l++]||"")&&(f=parseFloat(m)||0,x=m.substr((f+"").length),g.charAt(1)==="="&&(g=qr(f,g)+x),y=parseFloat(g),_=g.substr((y+"").length),h=Nr.lastIndex-_.length,_||(_=_||le.units[e]||x,h===s.length&&(s+=_,a.e+=_)),x!==_&&(f=Ui(t,e,m,_)||0),a._pt={_next:a._pt,p:v||l===1?v:",",s:f,c:y-f,m:p&&p<4||e==="zIndex"?Math.round:0});a.c=h<s.length?s.substring(h,s.length):""}else a.r=e==="display"&&s==="none"?fg:dg;return Pm.test(s)&&(a.e=0),this._pt=a,a},Td={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},ST=function(t){var e=t.split(" "),i=e[0],s=e[1]||"50%";return(i==="top"||i==="bottom"||s==="left"||s==="right")&&(t=i,i=s,s=t),e[0]=Td[i]||i,e[1]=Td[s]||s,e.join(" ")},AT=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i=e.t,s=i.style,n=e.u,o=i._gsap,a,h,l;if(n==="all"||n===!0)s.cssText="",h=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],yi[a]&&(h=1,a=a==="transformOrigin"?Zt:_t),yr(i,a);h&&(yr(i,_t),o&&(o.svg&&i.removeAttribute("transform"),gn(i,1),o.uncache=1,pg(s)))}},Yo={clearProps:function(t,e,i,s,n){if(n.data!=="isFromStart"){var o=t._pt=new Kt(t._pt,e,i,0,0,AT);return o.u=s,o.pr=-10,o.tween=n,t._props.push(i),1}}},mn=[1,0,0,1,0,0],vg={},xg=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},wd=function(t){var e=ei(t,_t);return xg(e)?mn:e.substr(7).match(Em).map(bt)},ku=function(t,e){var i=t._gsap||cr(t),s=t.style,n=wd(t),o,a,h,l;return i.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,n=[h.a,h.b,h.c,h.d,h.e,h.f],n.join(",")==="1,0,0,1,0,0"?mn:n):(n===mn&&!t.offsetParent&&t!==Kr&&!i.svg&&(h=s.display,s.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(l=1,a=t.nextElementSibling,Kr.appendChild(t)),n=wd(t),h?s.display=h:yr(t,"display"),l&&(a?o.insertBefore(t,a):o?o.appendChild(t):Kr.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},vl=function(t,e,i,s,n,o){var a=t._gsap,h=n||ku(t,!0),l=a.xOrigin||0,u=a.yOrigin||0,c=a.xOffset||0,d=a.yOffset||0,f=h[0],p=h[1],m=h[2],g=h[3],y=h[4],v=h[5],_=e.split(" "),x=parseFloat(_[0])||0,b=parseFloat(_[1])||0,C,w,T,A;i?h!==mn&&(w=f*g-p*m)&&(T=x*(g/w)+b*(-m/w)+(m*v-g*y)/w,A=x*(-p/w)+b*(f/w)-(f*v-p*y)/w,x=T,b=A):(C=_g(t),x=C.x+(~_[0].indexOf("%")?x/100*C.width:x),b=C.y+(~(_[1]||_[0]).indexOf("%")?b/100*C.height:b)),s||s!==!1&&a.smooth?(y=x-l,v=b-u,a.xOffset=c+(y*f+v*m)-y,a.yOffset=d+(y*p+v*g)-v):a.xOffset=a.yOffset=0,a.xOrigin=x,a.yOrigin=b,a.smooth=!!s,a.origin=e,a.originIsAbsolute=!!i,t.style[Zt]="0px 0px",o&&(Ii(o,a,"xOrigin",l,x),Ii(o,a,"yOrigin",u,b),Ii(o,a,"xOffset",c,a.xOffset),Ii(o,a,"yOffset",d,a.yOffset)),t.setAttribute("data-svg-origin",x+" "+b)},gn=function(t,e){var i=t._gsap||new rg(t);if("x"in i&&!e&&!i.uncache)return i;var s=t.style,n=i.scaleX<0,o="px",a="deg",h=getComputedStyle(t),l=ei(t,Zt)||"0",u,c,d,f,p,m,g,y,v,_,x,b,C,w,T,A,I,z,R,S,P,D,H,E,B,q,M,O,Q,nt,J,at;return u=c=d=m=g=y=v=_=x=0,f=p=1,i.svg=!!(t.getCTM&&yg(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(s[_t]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[_t]!=="none"?h[_t]:"")),s.scale=s.rotate=s.translate="none"),w=ku(t,i.svg),i.svg&&(i.uncache?(B=t.getBBox(),l=i.xOrigin-B.x+"px "+(i.yOrigin-B.y)+"px",E=""):E=!e&&t.getAttribute("data-svg-origin"),vl(t,E||l,!!E||i.originIsAbsolute,i.smooth!==!1,w)),b=i.xOrigin||0,C=i.yOrigin||0,w!==mn&&(z=w[0],R=w[1],S=w[2],P=w[3],u=D=w[4],c=H=w[5],w.length===6?(f=Math.sqrt(z*z+R*R),p=Math.sqrt(P*P+S*S),m=z||R?Pr(R,z)*Ji:0,v=S||P?Pr(S,P)*Ji+m:0,v&&(p*=Math.abs(Math.cos(v*Zr))),i.svg&&(u-=b-(b*z+C*S),c-=C-(b*R+C*P))):(at=w[6],nt=w[7],M=w[8],O=w[9],Q=w[10],J=w[11],u=w[12],c=w[13],d=w[14],T=Pr(at,Q),g=T*Ji,T&&(A=Math.cos(-T),I=Math.sin(-T),E=D*A+M*I,B=H*A+O*I,q=at*A+Q*I,M=D*-I+M*A,O=H*-I+O*A,Q=at*-I+Q*A,J=nt*-I+J*A,D=E,H=B,at=q),T=Pr(-S,Q),y=T*Ji,T&&(A=Math.cos(-T),I=Math.sin(-T),E=z*A-M*I,B=R*A-O*I,q=S*A-Q*I,J=P*I+J*A,z=E,R=B,S=q),T=Pr(R,z),m=T*Ji,T&&(A=Math.cos(T),I=Math.sin(T),E=z*A+R*I,B=D*A+H*I,R=R*A-z*I,H=H*A-D*I,z=E,D=B),g&&Math.abs(g)+Math.abs(m)>359.9&&(g=m=0,y=180-y),f=bt(Math.sqrt(z*z+R*R+S*S)),p=bt(Math.sqrt(H*H+at*at)),T=Pr(D,H),v=Math.abs(T)>2e-4?T*Ji:0,x=J?1/(J<0?-J:J):0),i.svg&&(E=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!xg(ei(t,_t)),E&&t.setAttribute("transform",E))),Math.abs(v)>90&&Math.abs(v)<270&&(n?(f*=-1,v+=m<=0?180:-180,m+=m<=0?180:-180):(p*=-1,v+=v<=0?180:-180)),e=e||i.uncache,i.x=u-((i.xPercent=u&&(!e&&i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-u)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+o,i.y=c-((i.yPercent=c&&(!e&&i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-c)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+o,i.z=d+o,i.scaleX=bt(f),i.scaleY=bt(p),i.rotation=bt(m)+a,i.rotationX=bt(g)+a,i.rotationY=bt(y)+a,i.skewX=v+a,i.skewY=_+a,i.transformPerspective=x+o,(i.zOrigin=parseFloat(l.split(" ")[2])||!e&&i.zOrigin||0)&&(s[Zt]=qo(l)),i.xOffset=i.yOffset=0,i.force3D=le.force3D,i.renderTransform=i.svg?ET:gg?bg:CT,i.uncache=0,i},qo=function(t){return(t=t.split(" "))[0]+" "+t[1]},uh=function(t,e,i){var s=zt(e);return bt(parseFloat(e)+parseFloat(Ui(t,"x",i+"px",s)))+s},CT=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,bg(t,e)},ji="0deg",ws="0px",Yi=") ",bg=function(t,e){var i=e||this,s=i.xPercent,n=i.yPercent,o=i.x,a=i.y,h=i.z,l=i.rotation,u=i.rotationY,c=i.rotationX,d=i.skewX,f=i.skewY,p=i.scaleX,m=i.scaleY,g=i.transformPerspective,y=i.force3D,v=i.target,_=i.zOrigin,x="",b=y==="auto"&&t&&t!==1||y===!0;if(_&&(c!==ji||u!==ji)){var C=parseFloat(u)*Zr,w=Math.sin(C),T=Math.cos(C),A;C=parseFloat(c)*Zr,A=Math.cos(C),o=uh(v,o,w*A*-_),a=uh(v,a,-Math.sin(C)*-_),h=uh(v,h,T*A*-_+_)}g!==ws&&(x+="perspective("+g+Yi),(s||n)&&(x+="translate("+s+"%, "+n+"%) "),(b||o!==ws||a!==ws||h!==ws)&&(x+=h!==ws||b?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+Yi),l!==ji&&(x+="rotate("+l+Yi),u!==ji&&(x+="rotateY("+u+Yi),c!==ji&&(x+="rotateX("+c+Yi),(d!==ji||f!==ji)&&(x+="skew("+d+", "+f+Yi),(p!==1||m!==1)&&(x+="scale("+p+", "+m+Yi),v.style[_t]=x||"translate(0, 0)"},ET=function(t,e){var i=e||this,s=i.xPercent,n=i.yPercent,o=i.x,a=i.y,h=i.rotation,l=i.skewX,u=i.skewY,c=i.scaleX,d=i.scaleY,f=i.target,p=i.xOrigin,m=i.yOrigin,g=i.xOffset,y=i.yOffset,v=i.forceCSS,_=parseFloat(o),x=parseFloat(a),b,C,w,T,A;h=parseFloat(h),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,h+=u),h||l?(h*=Zr,l*=Zr,b=Math.cos(h)*c,C=Math.sin(h)*c,w=Math.sin(h-l)*-d,T=Math.cos(h-l)*d,l&&(u*=Zr,A=Math.tan(l-u),A=Math.sqrt(1+A*A),w*=A,T*=A,u&&(A=Math.tan(u),A=Math.sqrt(1+A*A),b*=A,C*=A)),b=bt(b),C=bt(C),w=bt(w),T=bt(T)):(b=c,T=d,C=w=0),(_&&!~(o+"").indexOf("px")||x&&!~(a+"").indexOf("px"))&&(_=Ui(f,"x",o,"px"),x=Ui(f,"y",a,"px")),(p||m||g||y)&&(_=bt(_+p-(p*b+m*w)+g),x=bt(x+m-(p*C+m*T)+y)),(s||n)&&(A=f.getBBox(),_=bt(_+s/100*A.width),x=bt(x+n/100*A.height)),A="matrix("+b+","+C+","+w+","+T+","+_+","+x+")",f.setAttribute("transform",A),v&&(f.style[_t]=A)},PT=function(t,e,i,s,n){var o=360,a=kt(n),h=parseFloat(n)*(a&&~n.indexOf("rad")?Ji:1),l=h-s,u=s+l+"deg",c,d;return a&&(c=n.split("_")[1],c==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),c==="cw"&&l<0?l=(l+o*yd)%o-~~(l/o)*o:c==="ccw"&&l>0&&(l=(l-o*yd)%o-~~(l/o)*o)),t._pt=d=new Kt(t._pt,e,i,s,l,cT),d.e=u,d.u="deg",t._props.push(i),d},Sd=function(t,e){for(var i in e)t[i]=e[i];return t},RT=function(t,e,i){var s=Sd({},i._gsap),n="perspective,force3D,transformOrigin,svgOrigin",o=i.style,a,h,l,u,c,d,f,p;s.svg?(l=i.getAttribute("transform"),i.setAttribute("transform",""),o[_t]=e,a=gn(i,1),yr(i,_t),i.setAttribute("transform",l)):(l=getComputedStyle(i)[_t],o[_t]=e,a=gn(i,1),o[_t]=l);for(h in yi)l=s[h],u=a[h],l!==u&&n.indexOf(h)<0&&(f=zt(l),p=zt(u),c=f!==p?Ui(i,h,l,p):parseFloat(l),d=parseFloat(u),t._pt=new Kt(t._pt,a,h,c,d-c,gl),t._pt.u=p||0,t._props.push(h));Sd(a,s)};qt("padding,margin,Width,Radius",function(r,t){var e="Top",i="Right",s="Bottom",n="Left",o=(t<3?[e,i,s,n]:[e+n,e+i,s+i,s+n]).map(function(a){return t<2?r+a:"border"+a+r});Yo[t>1?"border"+r:r]=function(a,h,l,u,c){var d,f;if(arguments.length<4)return d=o.map(function(p){return di(a,p,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(h,f,c)}});var Tg={name:"css",register:yl,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,s,n){var o=this._props,a=t.style,h=i.vars.startAt,l,u,c,d,f,p,m,g,y,v,_,x,b,C,w,T;Bu||yl(),this.styles=this.styles||mg(t),T=this.styles.props,this.tween=i;for(m in e)if(m!=="autoRound"&&(u=e[m],!(se[m]&&sg(m,e,i,s,t,n)))){if(f=typeof u,p=Yo[m],f==="function"&&(u=u.call(i,s,t,n),f=typeof u),f==="string"&&~u.indexOf("random(")&&(u=dn(u)),p)p(this,t,m,u,i)&&(w=1);else if(m.substr(0,2)==="--")l=(getComputedStyle(t).getPropertyValue(m)+"").trim(),u+="",Oi.lastIndex=0,Oi.test(l)||(g=zt(l),y=zt(u)),y?g!==y&&(l=Ui(t,m,l,y)+y):g&&(u+=g),this.add(a,"setProperty",l,u,s,n,0,0,m),o.push(m),T.push(m,0,a[m]);else if(f!=="undefined"){if(h&&m in h?(l=typeof h[m]=="function"?h[m].call(i,s,t,n):h[m],kt(l)&&~l.indexOf("random(")&&(l=dn(l)),zt(l+"")||l==="auto"||(l+=le.units[m]||zt(di(t,m))||""),(l+"").charAt(1)==="="&&(l=di(t,m))):l=di(t,m),d=parseFloat(l),v=f==="string"&&u.charAt(1)==="="&&u.substr(0,2),v&&(u=u.substr(2)),c=parseFloat(u),m in Je&&(m==="autoAlpha"&&(d===1&&di(t,"visibility")==="hidden"&&c&&(d=0),T.push("visibility",0,a.visibility),Ii(this,a,"visibility",d?"inherit":"hidden",c?"inherit":"hidden",!c)),m!=="scale"&&m!=="transform"&&(m=Je[m],~m.indexOf(",")&&(m=m.split(",")[0]))),_=m in yi,_){if(this.styles.save(m),x||(b=t._gsap,b.renderTransform&&!e.parseTransform||gn(t,e.parseTransform),C=e.smoothOrigin!==!1&&b.smooth,x=this._pt=new Kt(this._pt,a,_t,0,1,b.renderTransform,b,0,-1),x.dep=1),m==="scale")this._pt=new Kt(this._pt,b,"scaleY",b.scaleY,(v?qr(b.scaleY,v+c):c)-b.scaleY||0,gl),this._pt.u=0,o.push("scaleY",m),m+="X";else if(m==="transformOrigin"){T.push(Zt,0,a[Zt]),u=ST(u),b.svg?vl(t,u,0,C,0,this):(y=parseFloat(u.split(" ")[2])||0,y!==b.zOrigin&&Ii(this,b,"zOrigin",b.zOrigin,y),Ii(this,a,m,qo(l),qo(u)));continue}else if(m==="svgOrigin"){vl(t,u,1,C,0,this);continue}else if(m in vg){PT(this,b,m,d,v?qr(d,v+u):u);continue}else if(m==="smoothOrigin"){Ii(this,b,"smooth",b.smooth,u);continue}else if(m==="force3D"){b[m]=u;continue}else if(m==="transform"){RT(this,u,t);continue}}else m in a||(m=ls(m)||m);if(_||(c||c===0)&&(d||d===0)&&!uT.test(u)&&m in a)g=(l+"").substr((d+"").length),c||(c=0),y=zt(u)||(m in le.units?le.units[m]:g),g!==y&&(d=Ui(t,m,l,y)),this._pt=new Kt(this._pt,_?b:a,m,d,(v?qr(d,v+c):c)-d,!_&&(y==="px"||m==="zIndex")&&e.autoRound!==!1?fT:gl),this._pt.u=y||0,g!==y&&y!=="%"&&(this._pt.b=l,this._pt.r=dT);else if(m in a)wT.call(this,t,m,l,v?v+u:u);else if(m in t)this.add(t,m,l||t[m],v?v+u:u,s,n);else if(m!=="parseTransform"){Au(m,u);continue}_||(m in a?T.push(m,0,a[m]):T.push(m,1,l||t[m])),o.push(m)}}w&&ug(this)},render:function(t,e){if(e.tween._time||!Ou())for(var i=e._pt;i;)i.r(t,i.d),i=i._next;else e.styles.revert()},get:di,aliases:Je,getSetter:function(t,e,i){var s=Je[e];return s&&s.indexOf(",")<0&&(e=s),e in yi&&e!==Zt&&(t._gsap.x||di(t,"x"))?i&&_d===i?e==="scale"?_T:gT:(_d=i||{})&&(e==="scale"?yT:vT):t.style&&!Tu(t.style[e])?pT:~e.indexOf("-")?mT:Fu(t,e)},core:{_removeProperty:yr,_getMatrix:ku}};Qt.utils.checkPrefix=ls;Qt.core.getStyleSaver=mg;(function(r,t,e,i){var s=qt(r+","+t+","+e,function(n){yi[n]=1});qt(t,function(n){le.units[n]="deg",vg[n]=1}),Je[s[13]]=r+","+t,qt(i,function(n){var o=n.split(":");Je[o[1]]=s[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");qt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){le.units[r]="px"});Qt.registerPlugin(Tg);var IT=Qt.registerPlugin(Tg)||Qt;IT.core.Tween;class MT extends fa{constructor(){super(...arguments);L(this,"container");L(this,"cards",[]);L(this,"displayWidth",ln.instance.getWidth());L(this,"displayHeight",ln.instance.getHeight());L(this,"animationTimeline",new Ht({paused:!0}));L(this,"restartButton");L(this,"restart",!1)}init(){this.container=new Ke(0,0,this,"Container"),this.restartButton=new yo({x:640,y:654,width:200,height:100,config:er.RestartButton.bConfig,callback:this.cardButtonUp.bind(this),parent:this.container,textConfig:er.RestartButton.tConfig}),this.restartButton.isEnabled=!1;const e=Gi.instance.backMenuButtonUp;new da({x:1245,y:35,width:70,height:70,config:Ee.MenuButton,callback:e.bind(this,this.name),parent:this.container}),this.createCardAssets(Yr.CardCounter),this.initDisplayEvents()}setVisualPortrait(){}setVisualLandscape(){}cardButtonUp(){this.restart=!this.restart,this.restart?(this.restartButton.textAsset.setTextConfig(er.RestartText),this.animationTimeline.play()):(this.restartButton.textAsset.setTextConfig(er.PlayText),this.animationTimeline.restart(),this.animationTimeline.paused(!0))}playCardAnimations(){this.animationTimeline.clear();for(let e=0,i=this.cards.length;e<i;e++){const s=this.cards[i-1-e],n=e*1.5,o=(Math.random()-.5)*.2;this.animationTimeline.to(s,Yr.CardAnimationDuration,{x:5/6*this.displayWidth,y:this.displayHeight/3+n,rotation:o,onStart:()=>{this.container.addChild(s)}},e*Yr.CardAnimationDelay)}}createCardAssets(e){for(let i=0;i<e;i++){const s=this.displayWidth/6,n=this.displayHeight/3+i*1.5,o=(Math.random()-.5)*.1,a=new wm(s,n,196,281,er.CardSprite,this.container);a.rotation=o,this.cards.push(a),this.container.addChild(a)}this.restartButton.isEnabled=!0,this.playCardAnimations()}dispose(){this.animationTimeline.kill(),this.cards.forEach(e=>e.destroy())}}/*!
 * pixi-particles - v4.3.1
 * Compiled Wed, 09 Jun 2021 13:12:54 UTC
 *
 * pixi-particles is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Xe=function(){function r(t,e,i){this.value=t,this.time=e,this.next=null,this.isStepped=!1,i?this.ease=typeof i=="function"?i:rt.generateEase(i):this.ease=null}return r.createList=function(t){if("list"in t){var e=t.list,i=void 0,s=e[0],n=s.value,o=s.time,a=i=new r(typeof n=="string"?rt.hexToRGB(n):n,o,t.ease);if(e.length>2||e.length===2&&e[1].value!==n)for(var h=1;h<e.length;++h){var l=e[h],u=l.value,c=l.time;i.next=new r(typeof u=="string"?rt.hexToRGB(u):u,c),i=i.next}return a.isStepped=!!t.isStepped,a}var d=new r(typeof t.start=="string"?rt.hexToRGB(t.start):t.start,0);return t.end!==t.start&&(d.next=new r(typeof t.end=="string"?rt.hexToRGB(t.end):t.end,1)),d},r}(),xl,Ad=Tm;parseInt(/^(\d+)\./.exec(uu)[1],10)<5?xl=Ad.Texture.fromImage:xl=Ad.Texture.from;function bl(r){return xl(r)}var rt;(function(r){r.verbose=!1,r.DEG_TO_RADS=Math.PI/180;function t(u,c){if(u){u*=r.DEG_TO_RADS;var d=Math.sin(u),f=Math.cos(u),p=c.x*f-c.y*d,m=c.x*d+c.y*f;c.x=p,c.y=m}}r.rotatePoint=t;function e(u,c,d){return u<<16|c<<8|d}r.combineRGBComponents=e;function i(u){var c=1/r.length(u);u.x*=c,u.y*=c}r.normalize=i;function s(u,c){u.x*=c,u.y*=c}r.scaleBy=s;function n(u){return Math.sqrt(u.x*u.x+u.y*u.y)}r.length=n;function o(u,c){c||(c={}),u.charAt(0)==="#"?u=u.substr(1):u.indexOf("0x")===0&&(u=u.substr(2));var d;return u.length===8&&(d=u.substr(0,2),u=u.substr(2)),c.r=parseInt(u.substr(0,2),16),c.g=parseInt(u.substr(2,2),16),c.b=parseInt(u.substr(4,2),16),d&&(c.a=parseInt(d,16)),c}r.hexToRGB=o;function a(u){var c=u.length,d=1/c;return function(f){var p=c*f|0,m=(f-p*d)*c,g=u[p]||u[c-1];return g.s+m*(2*(1-m)*(g.cp-g.s)+m*(g.e-g.s))}}r.generateEase=a;function h(u){if(!u)return W.NORMAL;for(u=u.toUpperCase();u.indexOf(" ")>=0;)u=u.replace(" ","_");return W[u]||W.NORMAL}r.getBlendMode=h;function l(u,c){c===void 0&&(c=10),(typeof c!="number"||c<=0)&&(c=10);var d=new Xe(r.hexToRGB(u[0].value),u[0].time);d.isStepped=!0;for(var f=d,p=u[0],m=1,g=u[m],y=1;y<c;++y){for(var v=y/c;v>g.time;)p=g,g=u[++m];v=(v-p.time)/(g.time-p.time);var _=r.hexToRGB(p.value),x=r.hexToRGB(g.value),b={r:(x.r-_.r)*v+_.r,g:(x.g-_.g)*v+_.g,b:(x.b-_.b)*v+_.b};f.next=new Xe(b,y/c),f=f.next}return d}r.createSteppedGradient=l})(rt||(rt={}));/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Tl=function(r,t){return Tl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])},Tl(r,t)};function _a(r,t){Tl(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function FT(r){return this.ease&&(r=this.ease(r)),(this.next.value-this.current.value)*r+this.current.value}function DT(r){this.ease&&(r=this.ease(r));var t=this.current.value,e=this.next.value,i=(e.r-t.r)*r+t.r,s=(e.g-t.g)*r+t.g,n=(e.b-t.b)*r+t.b;return rt.combineRGBComponents(i,s,n)}function BT(r){for(this.ease&&(r=this.ease(r));r>this.next.time;)this.current=this.next,this.next=this.next.next;return r=(r-this.current.time)/(this.next.time-this.current.time),(this.next.value-this.current.value)*r+this.current.value}function OT(r){for(this.ease&&(r=this.ease(r));r>this.next.time;)this.current=this.next,this.next=this.next.next;r=(r-this.current.time)/(this.next.time-this.current.time);var t=this.current.value,e=this.next.value,i=(e.r-t.r)*r+t.r,s=(e.g-t.g)*r+t.g,n=(e.b-t.b)*r+t.b;return rt.combineRGBComponents(i,s,n)}function LT(r){for(this.ease&&(r=this.ease(r));this.next&&r>this.next.time;)this.current=this.next,this.next=this.next.next;return this.current.value}function kT(r){for(this.ease&&(r=this.ease(r));this.next&&r>this.next.time;)this.current=this.next,this.next=this.next.next;var t=this.current.value;return rt.combineRGBComponents(t.r,t.g,t.b)}var io=function(){function r(t){t===void 0&&(t=!1),this.current=null,this.next=null,this.isColor=!!t,this.interpolate=null,this.ease=null}return r.prototype.reset=function(t){this.current=t,this.next=t.next;var e=this.next&&this.next.time>=1;e?this.interpolate=this.isColor?DT:FT:t.isStepped?this.interpolate=this.isColor?kT:LT:this.interpolate=this.isColor?OT:BT,this.ease=this.current.ease},r}(),Ko=function(r){_a(t,r);function t(e){var i=r.call(this)||this;return i.prevChild=i.nextChild=null,i.emitter=e,i.anchor.x=i.anchor.y=.5,i.velocity=new j,i.rotationSpeed=0,i.rotationAcceleration=0,i.maxLife=0,i.age=0,i.ease=null,i.extraData=null,i.alphaList=new io,i.speedList=new io,i.speedMultiplier=1,i.acceleration=new j,i.maxSpeed=NaN,i.scaleList=new io,i.scaleMultiplier=1,i.colorList=new io(!0),i._doAlpha=!1,i._doScale=!1,i._doSpeed=!1,i._doAcceleration=!1,i._doColor=!1,i._doNormalMovement=!1,i._oneOverLife=0,i.next=null,i.prev=null,i.init=i.init,i.Particle_init=t.prototype.init,i.update=i.update,i.Particle_update=t.prototype.update,i.Sprite_destroy=r.prototype.destroy,i.Particle_destroy=t.prototype.destroy,i.applyArt=i.applyArt,i.kill=i.kill,i}return t.prototype.init=function(){this.age=0,this.velocity.x=this.speedList.current.value*this.speedMultiplier,this.velocity.y=0,rt.rotatePoint(this.rotation,this.velocity),this.noRotation?this.rotation=0:this.rotation*=rt.DEG_TO_RADS,this.rotationSpeed*=rt.DEG_TO_RADS,this.rotationAcceleration*=rt.DEG_TO_RADS,this.alpha=this.alphaList.current.value,this.scale.x=this.scale.y=this.scaleList.current.value,this._doAlpha=!!this.alphaList.current.next,this._doSpeed=!!this.speedList.current.next,this._doScale=!!this.scaleList.current.next,this._doColor=!!this.colorList.current.next,this._doAcceleration=this.acceleration.x!==0||this.acceleration.y!==0,this._doNormalMovement=this._doSpeed||this.speedList.current.value!==0||this._doAcceleration,this._oneOverLife=1/this.maxLife;var e=this.colorList.current.value;this.tint=rt.combineRGBComponents(e.r,e.g,e.b),this.visible=!0},t.prototype.applyArt=function(e){this.texture=e||k.EMPTY},t.prototype.update=function(e){if(this.age+=e,this.age>=this.maxLife||this.age<0)return this.kill(),-1;var i=this.age*this._oneOverLife;if(this.ease&&(this.ease.length===4?i=this.ease(i,0,1,1):i=this.ease(i)),this._doAlpha&&(this.alpha=this.alphaList.interpolate(i)),this._doScale){var s=this.scaleList.interpolate(i)*this.scaleMultiplier;this.scale.x=this.scale.y=s}if(this._doNormalMovement){var n=void 0,o=void 0;if(this._doSpeed){var a=this.speedList.interpolate(i)*this.speedMultiplier;rt.normalize(this.velocity),rt.scaleBy(this.velocity,a),n=this.velocity.x*e,o=this.velocity.y*e}else if(this._doAcceleration){var h=this.velocity.x,l=this.velocity.y;if(this.velocity.x+=this.acceleration.x*e,this.velocity.y+=this.acceleration.y*e,this.maxSpeed){var u=rt.length(this.velocity);u>this.maxSpeed&&rt.scaleBy(this.velocity,this.maxSpeed/u)}n=(h+this.velocity.x)/2*e,o=(l+this.velocity.y)/2*e}else n=this.velocity.x*e,o=this.velocity.y*e;this.position.x+=n,this.position.y+=o}if(this._doColor&&(this.tint=this.colorList.interpolate(i)),this.rotationAcceleration!==0){var c=this.rotationSpeed+this.rotationAcceleration*e;this.rotation+=(this.rotationSpeed+c)/2*e,this.rotationSpeed=c}else this.rotationSpeed!==0?this.rotation+=this.rotationSpeed*e:this.acceleration&&!this.noRotation&&(this.rotation=Math.atan2(this.velocity.y,this.velocity.x));return i},t.prototype.kill=function(){this.emitter.recycle(this)},t.prototype.destroy=function(){this.parent&&this.parent.removeChild(this),this.Sprite_destroy(),this.emitter=this.velocity=this.colorList=this.scaleList=this.alphaList=this.speedList=this.ease=this.next=this.prev=null},t.parseArt=function(e){var i;for(i=e.length;i>=0;--i)typeof e[i]=="string"&&(e[i]=bl(e[i]));if(rt.verbose){for(i=e.length-1;i>0;--i)if(e[i].baseTexture!==e[i-1].baseTexture){window.console&&console.warn("PixiParticles: using particle textures from different images may hinder performance in WebGL");break}}return e},t.parseData=function(e){return e},t}(ke),NT=function(){function r(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}return r.prototype.init=function(t){if(!t||!t.length)this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});else if(Array.isArray(t[0]))for(var e=0;e<t.length;++e)for(var i=t[e],s=i[0],n=1;n<i.length;++n){var o=i[n];this.segments.push({p1:s,p2:o,l:0}),s=o}else for(var s=t[0],e=1;e<t.length;++e){var o=t[e];this.segments.push({p1:s,p2:o,l:0}),s=o}for(var e=0;e<this.segments.length;++e){var a=this.segments[e],h=a.p1,l=a.p2,u=Math.sqrt((l.x-h.x)*(l.x-h.x)+(l.y-h.y)*(l.y-h.y));this.segments[e].l=u,this.totalLength+=u,this.countingLengths.push(this.totalLength)}},r.prototype.getRandomPoint=function(t){var e=Math.random()*this.totalLength,i,s;if(this.segments.length===1)i=this.segments[0],s=e;else for(var n=0;n<this.countingLengths.length;++n)if(e<this.countingLengths[n]){i=this.segments[n],s=n===0?e:e-this.countingLengths[n-1];break}s/=i.l||1;var o=i.p1,a=i.p2;t.x=o.x+s*(a.x-o.x),t.y=o.y+s*(a.y-o.y)},r}(),Zo,Cd=Tm;parseInt(/^(\d+)\./.exec(uu)[1],10)<5?Zo=Cd.ticker.shared:Zo=Cd.Ticker.shared;var ht=new j,UT=function(){function r(t,e,i){this._currentImageIndex=-1,this._particleConstructor=Ko,this.particleImages=null,this.startAlpha=null,this.startSpeed=null,this.minimumSpeedMultiplier=1,this.acceleration=null,this.maxSpeed=NaN,this.startScale=null,this.minimumScaleMultiplier=1,this.startColor=null,this.minLifetime=0,this.maxLifetime=0,this.minStartRotation=0,this.maxStartRotation=0,this.noRotation=!1,this.minRotationSpeed=0,this.maxRotationSpeed=0,this.particleBlendMode=0,this.customEase=null,this.extraData=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=null,this.spawnType=null,this._spawnFunc=null,this.spawnRect=null,this.spawnCircle=null,this.spawnPolygonalChain=null,this.particlesPerWave=1,this.particleSpacing=0,this.angleStart=0,this.rotation=0,this.ownerPos=null,this._prevEmitterPos=null,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._origArt=null,this._autoUpdate=!1,this._currentImageIndex=-1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&i&&this.init(e,i),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}return Object.defineProperty(r.prototype,"orderedArt",{get:function(){return this._currentImageIndex!==-1},set:function(t){this._currentImageIndex=t?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frequency",{get:function(){return this._frequency},set:function(t){typeof t=="number"&&t>0?this._frequency=t:this._frequency=1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"particleConstructor",{get:function(){return this._particleConstructor},set:function(t){if(t!==this._particleConstructor){this._particleConstructor=t,this.cleanup();for(var e=this._poolFirst;e;e=e.next)e.destroy();this._poolFirst=null,this._origConfig&&this._origArt&&this.init(this._origArt,this._origConfig)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return this._parent},set:function(t){this.cleanup(),this._parent=t},enumerable:!0,configurable:!0}),r.prototype.init=function(t,e){if(!(!t||!e)){this.cleanup(),this._origConfig=e,this._origArt=t,t=Array.isArray(t)?t.slice():[t];var i=this._particleConstructor;this.particleImages=i.parseArt?i.parseArt(t):t,e.alpha?this.startAlpha=Xe.createList(e.alpha):this.startAlpha=new Xe(1,0),e.speed?(this.startSpeed=Xe.createList(e.speed),this.minimumSpeedMultiplier=("minimumSpeedMultiplier"in e?e.minimumSpeedMultiplier:e.speed.minimumSpeedMultiplier)||1):(this.minimumSpeedMultiplier=1,this.startSpeed=new Xe(0,0));var s=e.acceleration;s&&(s.x||s.y)?(this.startSpeed.next=null,this.acceleration=new j(s.x,s.y),this.maxSpeed=e.maxSpeed||NaN):this.acceleration=new j,e.scale?(this.startScale=Xe.createList(e.scale),this.minimumScaleMultiplier=("minimumScaleMultiplier"in e?e.minimumScaleMultiplier:e.scale.minimumScaleMultiplier)||1):(this.startScale=new Xe(1,0),this.minimumScaleMultiplier=1),e.color?this.startColor=Xe.createList(e.color):this.startColor=new Xe({r:255,g:255,b:255},0),e.startRotation?(this.minStartRotation=e.startRotation.min,this.maxStartRotation=e.startRotation.max):this.minStartRotation=this.maxStartRotation=0,e.noRotation&&(this.minStartRotation||this.maxStartRotation)?this.noRotation=!!e.noRotation:this.noRotation=!1,e.rotationSpeed?(this.minRotationSpeed=e.rotationSpeed.min,this.maxRotationSpeed=e.rotationSpeed.max):this.minRotationSpeed=this.maxRotationSpeed=0,this.rotationAcceleration=e.rotationAcceleration||0,this.minLifetime=e.lifetime.min,this.maxLifetime=e.lifetime.max,this.particleBlendMode=rt.getBlendMode(e.blendMode),e.ease?this.customEase=typeof e.ease=="function"?e.ease:rt.generateEase(e.ease):this.customEase=null,i.parseData?this.extraData=i.parseData(e.extraData):this.extraData=e.extraData||null,this.spawnRect=this.spawnCircle=null,this.particlesPerWave=1,e.particlesPerWave&&e.particlesPerWave>1&&(this.particlesPerWave=e.particlesPerWave),this.particleSpacing=0,this.angleStart=0,this.parseSpawnType(e),this.frequency=e.frequency,this.spawnChance=typeof e.spawnChance=="number"&&e.spawnChance>0?e.spawnChance:1,this.emitterLifetime=e.emitterLifetime||-1,this.maxParticles=e.maxParticles>0?e.maxParticles:1e3,this.addAtBack=!!e.addAtBack,this.rotation=0,this.ownerPos=new j,this.spawnPos=new j(e.pos.x,e.pos.y),this.initAdditional(t,e),this._prevEmitterPos=this.spawnPos.clone(),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=e.emit===void 0?!0:!!e.emit,this.autoUpdate=!!e.autoUpdate,this.orderedArt=!!e.orderedArt}},r.prototype.initAdditional=function(t,e){},r.prototype.parseSpawnType=function(t){var e;switch(t.spawnType){case"rect":this.spawnType="rect",this._spawnFunc=this._spawnRect;var i=t.spawnRect;this.spawnRect=new Z(i.x,i.y,i.w,i.h);break;case"circle":this.spawnType="circle",this._spawnFunc=this._spawnCircle,e=t.spawnCircle,this.spawnCircle=new gr(e.x,e.y,e.r);break;case"ring":this.spawnType="ring",this._spawnFunc=this._spawnRing,e=t.spawnCircle,this.spawnCircle=new gr(e.x,e.y,e.r),this.spawnCircle.minRadius=e.minR;break;case"burst":this.spawnType="burst",this._spawnFunc=this._spawnBurst,this.particleSpacing=t.particleSpacing,this.angleStart=t.angleStart?t.angleStart:0;break;case"point":this.spawnType="point",this._spawnFunc=this._spawnPoint;break;case"polygonalChain":this.spawnType="polygonalChain",this._spawnFunc=this._spawnPolygonalChain,this.spawnPolygonalChain=new NT(t.spawnPolygon);break;default:this.spawnType="point",this._spawnFunc=this._spawnPoint;break}},r.prototype.recycle=function(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount},r.prototype.rotate=function(t){if(this.rotation!==t){var e=t-this.rotation;this.rotation=t,rt.rotatePoint(e,this.spawnPos),this._posChanged=!0}},r.prototype.updateSpawnPos=function(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e},r.prototype.updateOwnerPos=function(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e},r.prototype.resetPositionTracking=function(){this._prevPosIsValid=!1},Object.defineProperty(r.prototype,"emit",{get:function(){return this._emit},set:function(t){this._emit=!!t,this._emitterLife=this.emitterLifetime},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){this._autoUpdate&&!t?Zo.remove(this.update,this):!this._autoUpdate&&t&&Zo.add(this.update,this),this._autoUpdate=!!t},enumerable:!0,configurable:!0}),r.prototype.playOnceAndDestroy=function(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t},r.prototype.playOnce=function(t){this.emit=!0,this._completeCallback=t},r.prototype.update=function(t){if(this._autoUpdate&&(t=t/U.TARGET_FPMS/1e3),!!this._parent){var e,i,s;for(i=this._activeParticlesFirst;i;i=s)s=i.next,i.update(t);var n,o;this._prevPosIsValid&&(n=this._prevEmitterPos.x,o=this._prevEmitterPos.y);var a=this.ownerPos.x+this.spawnPos.x,h=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}var l=void 0;if(this.minLifetime===this.maxLifetime?l=this.minLifetime:l=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer<l){var u=void 0,c=void 0;if(this._prevPosIsValid&&this._posChanged){var d=1+this._spawnTimer/t;u=(a-n)*d+n,c=(h-o)*d+o}else u=a,c=h;e=0;for(var f=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount);e<f;++e)if(!(this.spawnChance<1&&Math.random()>=this.spawnChance)){var p=void 0;this._poolFirst?(p=this._poolFirst,this._poolFirst=this._poolFirst.next,p.next=null):p=new this.particleConstructor(this),this.particleImages.length>1?this._currentImageIndex!==-1?(p.applyArt(this.particleImages[this._currentImageIndex++]),(this._currentImageIndex<0||this._currentImageIndex>=this.particleImages.length)&&(this._currentImageIndex=0)):p.applyArt(this.particleImages[Math.floor(Math.random()*this.particleImages.length)]):p.applyArt(this.particleImages[0]),p.alphaList.reset(this.startAlpha),this.minimumSpeedMultiplier!==1&&(p.speedMultiplier=Math.random()*(1-this.minimumSpeedMultiplier)+this.minimumSpeedMultiplier),p.speedList.reset(this.startSpeed),p.acceleration.x=this.acceleration.x,p.acceleration.y=this.acceleration.y,p.maxSpeed=this.maxSpeed,this.minimumScaleMultiplier!==1&&(p.scaleMultiplier=Math.random()*(1-this.minimumScaleMultiplier)+this.minimumScaleMultiplier),p.scaleList.reset(this.startScale),p.colorList.reset(this.startColor),this.minRotationSpeed===this.maxRotationSpeed?p.rotationSpeed=this.minRotationSpeed:p.rotationSpeed=Math.random()*(this.maxRotationSpeed-this.minRotationSpeed)+this.minRotationSpeed,p.rotationAcceleration=this.rotationAcceleration,p.noRotation=this.noRotation,p.maxLife=l,p.blendMode=this.particleBlendMode,p.ease=this.customEase,p.extraData=this.extraData,this.applyAdditionalProperties(p),this._spawnFunc(p,u,c,e),p.init(),this.addAtBack?this._parent.addChildAt(p,0):this._parent.addChild(p),this._activeParticlesLast?(this._activeParticlesLast.next=p,p.prev=this._activeParticlesLast,this._activeParticlesLast=p):this._activeParticlesLast=this._activeParticlesFirst=p,++this.particleCount,p.update(-this._spawnTimer)}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=a,this._prevEmitterPos.y=h,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){var m=this._completeCallback;this._completeCallback=null,m()}this._destroyWhenComplete&&this.destroy()}}},r.prototype.applyAdditionalProperties=function(t){},r.prototype._spawnPoint=function(t,e,i){this.minStartRotation===this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,t.position.x=e,t.position.y=i},r.prototype._spawnRect=function(t,e,i){this.minStartRotation===this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,ht.x=Math.random()*this.spawnRect.width+this.spawnRect.x,ht.y=Math.random()*this.spawnRect.height+this.spawnRect.y,this.rotation!==0&&rt.rotatePoint(this.rotation,ht),t.position.x=e+ht.x,t.position.y=i+ht.y},r.prototype._spawnCircle=function(t,e,i){this.minStartRotation===this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,ht.x=Math.random()*this.spawnCircle.radius,ht.y=0,rt.rotatePoint(Math.random()*360,ht),ht.x+=this.spawnCircle.x,ht.y+=this.spawnCircle.y,this.rotation!==0&&rt.rotatePoint(this.rotation,ht),t.position.x=e+ht.x,t.position.y=i+ht.y},r.prototype._spawnRing=function(t,e,i){var s=this.spawnCircle;this.minStartRotation===this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,s.minRadius!==s.radius?ht.x=Math.random()*(s.radius-s.minRadius)+s.minRadius:ht.x=s.radius,ht.y=0;var n=Math.random()*360;t.rotation+=n,rt.rotatePoint(n,ht),ht.x+=this.spawnCircle.x,ht.y+=this.spawnCircle.y,this.rotation!==0&&rt.rotatePoint(this.rotation,ht),t.position.x=e+ht.x,t.position.y=i+ht.y},r.prototype._spawnPolygonalChain=function(t,e,i){this.minStartRotation===this.maxStartRotation?t.rotation=this.minStartRotation+this.rotation:t.rotation=Math.random()*(this.maxStartRotation-this.minStartRotation)+this.minStartRotation+this.rotation,this.spawnPolygonalChain.getRandomPoint(ht),this.rotation!==0&&rt.rotatePoint(this.rotation,ht),t.position.x=e+ht.x,t.position.y=i+ht.y},r.prototype._spawnBurst=function(t,e,i,s){this.particleSpacing===0?t.rotation=Math.random()*360:t.rotation=this.angleStart+this.particleSpacing*s+this.rotation,t.position.x=e,t.position.y=i},r.prototype.cleanup=function(){var t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t),t.parent&&t.parent.removeChild(t);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0},r.prototype.destroy=function(){this.autoUpdate=!1,this.cleanup();for(var t,e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.particleImages=this.spawnPos=this.ownerPos=this.startColor=this.startScale=this.startAlpha=this.startSpeed=this.customEase=this._completeCallback=null},r}(),Ss=new j,wg=["pow","sqrt","abs","floor","round","ceil","E","PI","sin","cos","tan","asin","acos","atan","atan2","log"],GT=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(wg).join("|"),"g");function zT(r){for(var t=r.match(GT),e=t.length-1;e>=0;--e)wg.indexOf(t[e])>=0&&(t[e]="Math."+t[e]);return r=t.join(""),new Function("x","return "+r+";")}(function(r){_a(t,r);function t(e){var i=r.call(this,e)||this;return i.path=null,i.initialRotation=0,i.initialPosition=new j,i.movement=0,i}return t.prototype.init=function(){this.initialRotation=this.rotation,this.Particle_init(),this.path=this.extraData.path,this._doNormalMovement=!this.path,this.movement=0,this.initialPosition.x=this.position.x,this.initialPosition.y=this.position.y},t.prototype.update=function(e){var i=this.Particle_update(e);if(i>=0&&this.path){if(this._doSpeed){var s=this.speedList.interpolate(i)*this.speedMultiplier;this.movement+=s*e}else{var s=this.speedList.current.value*this.speedMultiplier;this.movement+=s*e}Ss.x=this.movement,Ss.y=this.path(this.movement),rt.rotatePoint(this.initialRotation,Ss),this.position.x=this.initialPosition.x+Ss.x,this.position.y=this.initialPosition.y+Ss.y}return i},t.prototype.destroy=function(){this.Particle_destroy(),this.path=this.initialPosition=null},t.parseArt=function(e){return Ko.parseArt(e)},t.parseData=function(e){var i={};if(e&&e.path)try{i.path=zT(e.path)}catch{rt.verbose&&console.error("PathParticle: error in parsing path expression"),i.path=null}else rt.verbose&&console.error("PathParticle requires a path string in extraData!"),i.path=null;return i},t})(Ko);(function(r){_a(t,r);function t(e){var i=r.call(this,e)||this;return i.textures=null,i.duration=0,i.framerate=0,i.elapsed=0,i.loop=!1,i}return t.prototype.init=function(){this.Particle_init(),this.elapsed=0,this.framerate<0&&(this.duration=this.maxLife,this.framerate=this.textures.length/this.duration)},t.prototype.applyArt=function(e){this.textures=e.textures,this.framerate=e.framerate,this.duration=e.duration,this.loop=e.loop},t.prototype.update=function(e){var i=this.Particle_update(e);if(i>=0){this.elapsed+=e,this.elapsed>=this.duration&&(this.loop?this.elapsed=this.elapsed%this.duration:this.elapsed=this.duration-1e-6);var s=this.elapsed*this.framerate+1e-7|0;this.texture=this.textures[s]||this.textures[this.textures.length-1]||k.EMPTY}return i},t.prototype.destroy=function(){this.Particle_destroy(),this.textures=null},t.parseArt=function(e){for(var i=[],s=0;s<e.length;++s){for(var n=e[s],o=i[s]={},a=o.textures=[],h=n.textures,l=0;l<h.length;++l){var u=h[l];if(typeof u=="string")a.push(bl(u));else if(u instanceof k)a.push(u);else{var c=u.count||1;for(typeof u.texture=="string"?u=bl(u.texture):u=u.texture;c>0;--c)a.push(u)}}n.framerate==="matchLife"?(o.framerate=-1,o.duration=0,o.loop=!1):(o.loop=!!n.loop,o.framerate=n.framerate>0?n.framerate:60,o.duration=a.length/o.framerate)}return i},t})(Ko);(function(r){_a(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._firstChild=null,e._lastChild=null,e._childCount=0,e}return Object.defineProperty(t.prototype,"firstChild",{get:function(){return this._firstChild},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this._lastChild},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childCount",{get:function(){return this._childCount},enumerable:!0,configurable:!0}),t.prototype.addChild=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(e.length>1)for(var s=0;s<e.length;s++)this.addChild(e[s]);else{var n=e[0];n.parent&&n.parent.removeChild(n),n.parent=this,this.sortDirty=!0,n.transform._parentID=-1,this._lastChild?(this._lastChild.nextChild=n,n.prevChild=this._lastChild,this._lastChild=n):this._firstChild=this._lastChild=n,++this._childCount,this._boundsID++,this.onChildrenChange(),this.emit("childAdded",n,this,this._childCount),n.emit("added",this)}return e[0]},t.prototype.addChildAt=function(e,i){if(i<0||i>this._childCount)throw new Error("addChildAt: The index "+i+" supplied is out of bounds "+this._childCount);e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1;var s=e;if(!this._firstChild)this._firstChild=this._lastChild=s;else if(i===0)this._firstChild.prevChild=s,s.nextChild=this._firstChild,this._firstChild=s;else if(i===this._childCount)this._lastChild.nextChild=s,s.prevChild=this._lastChild,this._lastChild=s;else{for(var n=0,o=this._firstChild;n<i;)o=o.nextChild,++n;o.prevChild.nextChild=s,s.prevChild=o.prevChild,s.nextChild=o,o.prevChild=s}return++this._childCount,this._boundsID++,this.onChildrenChange(i),e.emit("added",this),this.emit("childAdded",e,this,i),e},t.prototype.addChildBelow=function(e,i){if(i.parent!==this)throw new Error("addChildBelow: The relative target must be a child of this parent");return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,i.prevChild.nextChild=e,e.prevChild=i.prevChild,e.nextChild=i,i.prevChild=e,this._firstChild===i&&(this._firstChild=e),++this._childCount,this._boundsID++,this.onChildrenChange(),this.emit("childAdded",e,this,this._childCount),e.emit("added",this),e},t.prototype.addChildAbove=function(e,i){if(i.parent!==this)throw new Error("addChildBelow: The relative target must be a child of this parent");return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,i.nextChild.prevChild=e,e.nextChild=i.nextChild,e.prevChild=i,i.nextChild=e,this._lastChild===i&&(this._lastChild=e),++this._childCount,this._boundsID++,this.onChildrenChange(),this.emit("childAdded",e,this,this._childCount),e.emit("added",this),e},t.prototype.swapChildren=function(e,i){if(!(e===i||e.parent!==this||i.parent!==this)){var s=e,n=s.prevChild,o=s.nextChild;e.prevChild=i.prevChild,e.nextChild=i.nextChild,i.prevChild=n,i.nextChild=o,this._firstChild===e?this._firstChild=i:this._firstChild===i&&(this._firstChild=e),this._lastChild===e?this._lastChild=i:this._lastChild===i&&(this._lastChild=e),this.onChildrenChange()}},t.prototype.getChildIndex=function(e){for(var i=0,s=this._firstChild;s&&s!==e;)s=s.nextChild,++i;if(!s)throw new Error("The supplied DisplayObject must be a child of the caller");return i},t.prototype.setChildIndex=function(e,i){if(i<0||i>=this._childCount)throw new Error("The index "+i+" supplied is out of bounds "+this._childCount);if(e.parent!==this)throw new Error("The supplied DisplayObject must be a child of the caller");if(e.nextChild&&(e.nextChild.prevChild=e.prevChild),e.prevChild&&(e.prevChild.nextChild=e.nextChild),this._firstChild===e&&(this._firstChild=e.nextChild),this._lastChild===e&&(this._lastChild=e.prevChild),e.nextChild=null,e.prevChild=null,!this._firstChild)this._firstChild=this._lastChild=e;else if(i===0)this._firstChild.prevChild=e,e.nextChild=this._firstChild,this._firstChild=e;else if(i===this._childCount)this._lastChild.nextChild=e,e.prevChild=this._lastChild,this._lastChild=e;else{for(var s=0,n=this._firstChild;s<i;)n=n.nextChild,++s;n.prevChild.nextChild=e,e.prevChild=n.prevChild,e.nextChild=n,n.prevChild=e}this.onChildrenChange(i)},t.prototype.removeChild=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(e.length>1)for(var s=0;s<e.length;s++)this.removeChild(e[s]);else{var n=e[0];if(n.parent!==this)return null;n.parent=null,n.transform._parentID=-1,n.nextChild&&(n.nextChild.prevChild=n.prevChild),n.prevChild&&(n.prevChild.nextChild=n.nextChild),this._firstChild===n&&(this._firstChild=n.nextChild),this._lastChild===n&&(this._lastChild=n.prevChild),n.nextChild=null,n.prevChild=null,--this._childCount,this._boundsID++,this.onChildrenChange(),n.emit("removed",this),this.emit("childRemoved",n,this)}return e[0]},t.prototype.getChildAt=function(e){if(e<0||e>=this._childCount)throw new Error("getChildAt: Index ("+e+") does not exist.");if(e===0)return this._firstChild;if(e===this._childCount)return this._lastChild;for(var i=0,s=this._firstChild;i<e;)s=s.nextChild,++i;return s},t.prototype.removeChildAt=function(e){var i=this.getChildAt(e);return i.parent=null,i.transform._parentID=-1,i.nextChild&&(i.nextChild.prevChild=i.prevChild),i.prevChild&&(i.prevChild.nextChild=i.nextChild),this._firstChild===i&&(this._firstChild=i.nextChild),this._lastChild===i&&(this._lastChild=i.prevChild),i.nextChild=null,i.prevChild=null,--this._childCount,this._boundsID++,this.onChildrenChange(e),i.emit("removed",this),this.emit("childRemoved",i,this,e),i},t.prototype.removeChildren=function(e,i){e===void 0&&(e=0),i===void 0&&(i=this._childCount);var s=e,n=i,o=n-s;if(o>0&&o<=n){for(var a=[],h=this._firstChild,l=0;l<=n&&h;++l,h=h.nextChild)l>=s&&a.push(h);var u=a[0].prevChild,c=a[a.length-1].nextChild;c?c.prevChild=u:this._lastChild=u,u?u.nextChild=c:this._firstChild=c;for(var l=0;l<a.length;++l)a[l].parent=null,a[l].transform&&(a[l].transform._parentID=-1),a[l].nextChild=null,a[l].prevChild=null;this._boundsID++,this.onChildrenChange(e);for(var l=0;l<a.length;++l)a[l].emit("removed",this),this.emit("childRemoved",a[l],this,l);return a}else if(o===0&&this._childCount===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;var e,i;for(e=this._firstChild;e;e=i)i=e.nextChild,e.visible&&e.updateTransform()},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();var e,i;for(e=this._firstChild;e;e=i)if(i=e.nextChild,!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){var s=e._mask.maskObject||e._mask;s.calculateBounds(),this._bounds.addBoundsMask(e._bounds,s._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds);this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,i){i===void 0&&(i=!1);var s=ct.prototype.getLocalBounds.call(this,e);if(!i){var n=void 0,o=void 0;for(n=this._firstChild;n;n=o)o=n.nextChild,n.visible&&n.updateTransform()}return s},t.prototype.render=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);var i=void 0,s=void 0;for(i=this._firstChild;i;i=s)s=i.nextChild,i.render(e)}},t.prototype.renderAdvanced=function(e){e.batch.flush();var i=this.filters,s=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<i.length;n++)i[n].enabled&&this._enabledFilters.push(i[n]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}s&&e.mask.push(this,this._mask),this._render(e);var o,a;for(o=this._firstChild;o;o=a)a=o.nextChild,o.render(e);e.batch.flush(),s&&e.mask.pop(this),i&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype.renderWebGL=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvancedWebGL(e);else{this._renderWebGL(e);var i=void 0,s=void 0;for(i=this._firstChild;i;i=s)s=i.nextChild,i.renderWebGL(e)}},t.prototype.renderAdvancedWebGL=function(e){e.flush();var i=this._filters,s=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<i.length;n++)i[n].enabled&&this._enabledFilters.push(i[n]);this._enabledFilters.length&&e.filterManager.pushFilter(this,this._enabledFilters)}s&&e.maskManager.pushMask(this,this._mask),this._renderWebGL(e);var o,a;for(o=this._firstChild;o;o=a)a=o.nextChild,o.renderWebGL(e);e.flush(),s&&e.maskManager.popMask(this,this._mask),i&&this._enabledFilters&&this._enabledFilters.length&&e.filterManager.popFilter()},t.prototype.renderCanvas=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){this._mask&&e.maskManager.pushMask(this._mask),this._renderCanvas(e);var i,s;for(i=this._firstChild;i;i=s)s=i.nextChild,i.renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t})(Wt);class ro extends UT{constructor(t,e,i){super(i,t,e);let s=Date.now();wt.shared.add(()=>{const n=Date.now(),o=(n-s)*8e-4;this.update(o),s=n})}start(){this.emit=!0}stop(){this.emit=!1}}const ee=class ee{};L(ee,"MAX_PARTICLES",10),L(ee,"WoodSPrite",{frame:"fire/wood",name:"wood"}),L(ee,"DarkForestBackgroundSprite",{frame:"fire/dark_forest_bg",name:"dark_forest_bg"}),L(ee,"FireParticle",{frame:"fire/particle",name:"particle"}),L(ee,"FireSmallParticles",[{frame:"fire/fire01",name:"fire01"},{frame:"fire/fire02",name:"fire02"},{frame:"fire/fire03",name:"fire03"}]),L(ee,"fireGeneralEmitter",{alpha:{start:1,end:0},scale:{start:1.4,end:2.2,minimumScaleMultiplier:1},color:{start:"#d18726",end:"#333231"},speed:{start:100,end:100,minimumSpeedMultiplier:.5},acceleration:{x:0,y:0},maxSpeed:2,startRotation:{min:-110,max:-70},noRotation:!1,rotationSpeed:{min:0,max:0},lifetime:{min:.5,max:.5},blendMode:"normal",frequency:.05,emitterLifetime:-1,maxParticles:ee.MAX_PARTICLES,pos:{x:0,y:-8},addAtBack:!0,spawnType:"circle",spawnCircle:{x:0,y:0,r:5}}),L(ee,"fireSparkEmitter",{alpha:{start:1,end:0},scale:{start:.1,end:.1,minimumScaleMultiplier:1},color:{start:"#47150b",end:"#333231"},speed:{start:100,end:100,minimumSpeedMultiplier:.5},acceleration:{x:0,y:0},maxSpeed:2,startRotation:{min:-110,max:-70},noRotation:!1,rotationSpeed:{min:0,max:0},lifetime:{min:1.5,max:2},blendMode:"normal",frequency:.05,emitterLifetime:-1,maxParticles:ee.MAX_PARTICLES,pos:{x:0,y:-8},addAtBack:!0,spawnType:"circle",spawnCircle:{x:0,y:0,r:5}}),L(ee,"fireGlowEmitter",{alpha:{start:.25,end:0},scale:{start:1,end:1.4,minimumScaleMultiplier:1},color:{start:"0xa41e1e",end:"0xa41e1e"},speed:{start:100,end:100,minimumSpeedMultiplier:.5},acceleration:{x:0,y:0},maxSpeed:2,startRotation:{min:-110,max:-70},noRotation:!1,rotationSpeed:{min:0,max:0},lifetime:{min:1,max:1.5},blendMode:"normal",frequency:.05,emitterLifetime:-1,maxParticles:ee.MAX_PARTICLES,pos:{x:0,y:-8},addAtBack:!0,spawnType:"circle",spawnCircle:{x:0,y:0,r:5}});let We=ee;var HT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$T=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,VT=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;let Qo=class extends tt{constructor(t=4,e=3,i=!1){super(HT,i?VT:$T),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new j,this.pixelSize=1,this._clamp=i,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,i,s){const n=this._pixelSize.x/e._frame.width,o=this._pixelSize.y/e._frame.height;let a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,e,i,s);else{const h=t.getFilterTexture();let l=e,u=h,c;const d=this._quality-1;for(let f=0;f<d;f++)a=this._kernels[f]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,u,1),c=l,l=u,u=c;a=this._kernels[d]+.5,this.uniforms.uOffset[0]=a*n,this.uniforms.uOffset[1]=a*o,t.applyFilter(this,l,i,s),t.returnFilterTexture(h)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((t,e)=>t+e+.5,0))}_generateKernels(){const t=this._blur,e=this._quality,i=[t];if(t>0){let s=t;const n=t/e;for(let o=1;o<e;o++)s-=n,i.push(s)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){typeof t=="number"?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof j?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}};var Sg=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,XT=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`;let WT=class extends tt{constructor(t=.5){super(Sg,XT),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}};var jT=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;const Ag=class extends tt{constructor(t){super(Sg,jT),this.bloomScale=1,this.brightness=1,this._resolution=U.FILTER_RESOLUTION,typeof t=="number"&&(t={threshold:t});const e=Object.assign(Ag.defaults,t);this.bloomScale=e.bloomScale,this.brightness=e.brightness;const{kernels:i,blur:s,quality:n,pixelSize:o,resolution:a}=e;this._extractFilter=new WT(e.threshold),this._extractFilter.resolution=a,this._blurFilter=i?new Qo(i):new Qo(s,n),this.pixelSize=o,this.resolution=a}apply(t,e,i,s,n){const o=t.getFilterTexture();this._extractFilter.apply(t,e,o,1,n);const a=t.getFilterTexture();this._blurFilter.apply(t,o,a,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=a,t.applyFilter(this,e,i,s),t.returnFilterTexture(a),t.returnFilterTexture(o)}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._extractFilter&&(this._extractFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get threshold(){return this._extractFilter.threshold}set threshold(t){this._extractFilter.threshold=t}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};let YT=Ag;YT.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:U.FILTER_RESOLUTION};var qT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,KT=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;const Cg=class extends tt{constructor(t){super(qT,KT),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Cg.defaults,t)}apply(t,e,i,s){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,t.applyFilter(this,e,i,s)}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}get strength(){return this.uniforms.strength}set strength(t){this.uniforms.strength=t}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}};let ZT=Cg;ZT.defaults={center:[.5,.5],radius:100,strength:1};var QT=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;
uniform bool uReplace;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    if (uReplace == false) {
        // mix resulting color with current color
        gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
    } else {
        // replace with gradient color
        gl_FragColor = gradientColor;
    }
}
`,JT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,Tr=Tr||{};Tr.stringify=function(){var r={"visit_linear-gradient":function(t){return r.visit_gradient(t)},"visit_repeating-linear-gradient":function(t){return r.visit_gradient(t)},"visit_radial-gradient":function(t){return r.visit_gradient(t)},"visit_repeating-radial-gradient":function(t){return r.visit_gradient(t)},visit_gradient:function(t){var e=r.visit(t.orientation);return e&&(e+=", "),t.type+"("+e+r.visit(t.colorStops)+")"},visit_shape:function(t){var e=t.value,i=r.visit(t.at),s=r.visit(t.style);return s&&(e+=" "+s),i&&(e+=" at "+i),e},"visit_default-radial":function(t){var e="",i=r.visit(t.at);return i&&(e+=i),e},"visit_extent-keyword":function(t){var e=t.value,i=r.visit(t.at);return i&&(e+=" at "+i),e},"visit_position-keyword":function(t){return t.value},visit_position:function(t){return r.visit(t.value.x)+" "+r.visit(t.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(t){return r.visit_color(t.value,t)},visit_hex:function(t){return r.visit_color("#"+t.value,t)},visit_rgb:function(t){return r.visit_color("rgb("+t.value.join(", ")+")",t)},visit_rgba:function(t){return r.visit_color("rgba("+t.value.join(", ")+")",t)},visit_color:function(t,e){var i=t,s=r.visit(e.length);return s&&(i+=" "+s),i},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(t){var e="",i=t.length;return t.forEach(function(s,n){e+=r.visit(s),n<i-1&&(e+=", ")}),e},visit:function(t){if(!t)return"";var e="";if(t instanceof Array)return r.visit_array(t,e);if(t.type){var i=r["visit_"+t.type];if(i)return i(t);throw Error("Missing visitor visit_"+t.type)}else throw Error("Invalid node.")}};return function(t){return r.visit(t)}}();var Tr=Tr||{};Tr.parse=function(){var r={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function e(E){var B=new Error(t+": "+E);throw B.source=t,B}function i(){var E=s();return t.length>0&&e("Invalid input not EOF"),E}function s(){return _(n)}function n(){return o("linear-gradient",r.linearGradient,h)||o("repeating-linear-gradient",r.repeatingLinearGradient,h)||o("radial-gradient",r.radialGradient,c)||o("repeating-radial-gradient",r.repeatingRadialGradient,c)}function o(E,B,q){return a(B,function(M){var O=q();return O&&(D(r.comma)||e("Missing comma before color stops")),{type:E,orientation:O,colorStops:_(x)}})}function a(E,B){var q=D(E);if(q){D(r.startCall)||e("Missing (");var M=B(q);return D(r.endCall)||e("Missing )"),M}}function h(){return l()||u()}function l(){return P("directional",r.sideOrCorner,1)}function u(){return P("angular",r.angleValue,1)}function c(){var E,B=d(),q;return B&&(E=[],E.push(B),q=t,D(r.comma)&&(B=d(),B?E.push(B):t=q)),E}function d(){var E=f()||p();if(E)E.at=g();else{var B=m();if(B){E=B;var q=g();q&&(E.at=q)}else{var M=y();M&&(E={type:"default-radial",at:M})}}return E}function f(){var E=P("shape",/^(circle)/i,0);return E&&(E.style=S()||m()),E}function p(){var E=P("shape",/^(ellipse)/i,0);return E&&(E.style=z()||m()),E}function m(){return P("extent-keyword",r.extentKeywords,1)}function g(){if(P("position",/^at/,0)){var E=y();return E||e("Missing positioning value"),E}}function y(){var E=v();if(E.x||E.y)return{type:"position",value:E}}function v(){return{x:z(),y:z()}}function _(E){var B=E(),q=[];if(B)for(q.push(B);D(r.comma);)B=E(),B?q.push(B):e("One extra comma");return q}function x(){var E=b();return E||e("Expected color definition"),E.length=z(),E}function b(){return w()||A()||T()||C()}function C(){return P("literal",r.literalColor,0)}function w(){return P("hex",r.hexColor,1)}function T(){return a(r.rgbColor,function(){return{type:"rgb",value:_(I)}})}function A(){return a(r.rgbaColor,function(){return{type:"rgba",value:_(I)}})}function I(){return D(r.number)[1]}function z(){return P("%",r.percentageValue,1)||R()||S()}function R(){return P("position-keyword",r.positionKeywords,1)}function S(){return P("px",r.pixelValue,1)||P("em",r.emValue,1)}function P(E,B,q){var M=D(B);if(M)return{type:E,value:M[q]}}function D(E){var B,q;return q=/^[\n\r\t\s]+/.exec(t),q&&H(q[0].length),B=E.exec(t),B&&H(B[0].length),B}function H(E){t=t.substr(E)}return function(E){return t=E.toString(),i()}}();var tw=Tr.parse;Tr.stringify;var Ed={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Pd={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function ew(r){var t,e=[],i=1,s;if(typeof r=="string")if(Ed[r])e=Ed[r].slice(),s="rgb";else if(r==="transparent")i=0,s="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(r)){var n=r.slice(1),o=n.length,a=o<=4;i=1,a?(e=[parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16)],o===4&&(i=parseInt(n[3]+n[3],16)/255)):(e=[parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16)],o===8&&(i=parseInt(n[6]+n[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(r)){var h=t[1],l=h==="rgb",n=h.replace(/a$/,"");s=n;var o=n==="cmyk"?4:n==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(d,f){if(/%$/.test(d))return f===o?parseFloat(d)/100:n==="rgb"?parseFloat(d)*255/100:parseFloat(d);if(n[f]==="h"){if(/deg$/.test(d))return parseFloat(d);if(Pd[d]!==void 0)return Pd[d]}return parseFloat(d)}),h===n&&e.push(1),i=l||e[o]===void 0?1:e[o],e=e.slice(0,o)}else r.length>10&&/[0-9](?:\s|\/)/.test(r)&&(e=r.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),s=r.match(/([a-z])/ig).join("").toLowerCase());else isNaN(r)?Array.isArray(r)||r.length?(e=[r[0],r[1],r[2]],s="rgb",i=r.length===4?r[3]:1):r instanceof Object&&(r.r!=null||r.red!=null||r.R!=null?(s="rgb",e=[r.r||r.red||r.R||0,r.g||r.green||r.G||0,r.b||r.blue||r.B||0]):(s="hsl",e=[r.h||r.hue||r.H||0,r.s||r.saturation||r.S||0,r.l||r.lightness||r.L||r.b||r.brightness]),i=r.a||r.alpha||r.opacity||1,r.opacity!=null&&(i/=100)):(s="rgb",e=[r>>>16,(r&65280)>>>8,r&255]);return{space:s,values:e,alpha:i}}var wl={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},ch={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(r){var t=r[0]/360,e=r[1]/100,i=r[2]/100,s,n,o,a,h;if(e===0)return h=i*255,[h,h,h];i<.5?n=i*(1+e):n=i+e-i*e,s=2*i-n,a=[0,0,0];for(var l=0;l<3;l++)o=t+1/3*-(l-1),o<0?o++:o>1&&o--,6*o<1?h=s+(n-s)*6*o:2*o<1?h=n:3*o<2?h=s+(n-s)*(2/3-o)*6:h=s,a[l]=h*255;return a}};wl.hsl=function(r){var t=r[0]/255,e=r[1]/255,i=r[2]/255,s=Math.min(t,e,i),n=Math.max(t,e,i),o=n-s,a,h,l;return n===s?a=0:t===n?a=(e-i)/o:e===n?a=2+(i-t)/o:i===n&&(a=4+(t-e)/o),a=Math.min(a*60,360),a<0&&(a+=360),l=(s+n)/2,n===s?h=0:l<=.5?h=o/(n+s):h=o/(2-n-s),[a,h*100,l*100]};function iw(r){Array.isArray(r)&&r.raw&&(r=String.raw(...arguments));var t,e=ew(r);if(!e.space)return[];const i=e.space[0]==="h"?ch.min:wl.min,s=e.space[0]==="h"?ch.max:wl.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],i[0]),s[0]),t[1]=Math.min(Math.max(e.values[1],i[1]),s[1]),t[2]=Math.min(Math.max(e.values[2],i[2]),s[2]),e.space[0]==="h"&&(t=ch.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}function Eg(r){switch(typeof r){case"string":return rw(r);case"number":return ds(r);default:return r}}function rw(r){const t=iw(r);if(!t)throw new Error(`Unable to parse color "${r}" as RGBA.`);return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function sw(r){const t=tw(fw(r));if(t.length===0)throw new Error("Invalid CSS gradient.");if(t.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");const e=t[0],i=nw(e.type),s=ow(e.colorStops),n=cw(e.orientation);return{type:i,stops:s,angle:n}}function nw(r){const t={"linear-gradient":0,"radial-gradient":1};if(!(r in t))throw new Error(`Unsupported gradient type "${r}"`);return t[r]}function ow(r){const t=lw(r),e=[];for(let i=0;i<r.length;i++){const s=aw(r[i]);e.push({offset:t[i],color:s.slice(0,3),alpha:s[3]})}return e}function aw(r){return Eg(hw(r))}function hw(r){switch(r.type){case"hex":return`#${r.value}`;case"literal":return r.value;default:return`${r.type}(${r.value.join(",")})`}}function lw(r){const t=[];for(let s=0;s<r.length;s++){const n=r[s];let o=-1;n.type==="literal"&&n.length&&"type"in n.length&&n.length.type==="%"&&"value"in n.length&&(o=parseFloat(n.length.value)/100),t.push(o)}const e=s=>{for(let n=s;n<t.length;n++)if(t[n]!==-1)return{indexDelta:n-s,offset:t[n]};return{indexDelta:t.length-1-s,offset:1}};let i=0;for(let s=0;s<t.length;s++){const n=t[s];if(n!==-1)i=n;else if(s===0)t[s]=0;else if(s+1===t.length)t[s]=1;else{const o=e(s),a=(o.offset-i)/(1+o.indexDelta);for(let h=0;h<=o.indexDelta;h++)t[s+h]=i+(h+1)*a;s+=o.indexDelta,i=t[s]}}return t.map(uw)}function uw(r){return r.toString().length>6?parseFloat(r.toString().substring(0,6)):r}function cw(r){if(typeof r>"u")return 0;if("type"in r&&"value"in r)switch(r.type){case"angular":return parseFloat(r.value);case"directional":return dw(r.value)}return 0}function dw(r){const t={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(r in t))throw new Error(`Unsupported directional value "${r}"`);return t[r]}function fw(r){let t=r.replace(/\s{2,}/gu," ");return t=t.replace(/;/g,""),t=t.replace(/ ,/g,","),t=t.replace(/\( /g,"("),t=t.replace(/ \)/g,")"),t.trim()}var pw=Object.defineProperty,mw=Object.defineProperties,gw=Object.getOwnPropertyDescriptors,Rd=Object.getOwnPropertySymbols,_w=Object.prototype.hasOwnProperty,yw=Object.prototype.propertyIsEnumerable,Id=(r,t,e)=>t in r?pw(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,dh=(r,t)=>{for(var e in t||(t={}))_w.call(t,e)&&Id(r,e,t[e]);if(Rd)for(var e of Rd(t))yw.call(t,e)&&Id(r,e,t[e]);return r},vw=(r,t)=>mw(r,gw(t));const Md=90;function xw(r){return[...r].sort((t,e)=>t.offset-e.offset)}const Vs=class extends tt{constructor(r){var t,e;let i;if(r&&"css"in r?i=vw(dh({},sw(r.css||"")),{alpha:(t=r.alpha)!=null?t:Vs.defaults.alpha,maxColors:(e=r.maxColors)!=null?e:Vs.defaults.maxColors}):i=dh(dh({},Vs.defaults),r),!i.stops||i.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super(JT,QT),this._stops=[],this.autoFit=!1,Object.assign(this,i)}get stops(){return this._stops}set stops(r){const t=xw(r),e=new Float32Array(t.length*3),i=0,s=1,n=2;for(let o=0;o<t.length;o++){const a=Eg(t[o].color),h=o*3;e[h+i]=a[i],e[h+s]=a[s],e[h+n]=a[n]}this.uniforms.uColors=e,this.uniforms.uOffsets=t.map(o=>o.offset),this.uniforms.uAlphas=t.map(o=>o.alpha),this.uniforms.uNumStops=t.length,this._stops=t}set type(r){this.uniforms.uType=r}get type(){return this.uniforms.uType}set angle(r){this.uniforms.uAngle=r-Md}get angle(){return this.uniforms.uAngle+Md}set alpha(r){this.uniforms.uAlpha=r}get alpha(){return this.uniforms.uAlpha}set maxColors(r){this.uniforms.uMaxColors=r}get maxColors(){return this.uniforms.uMaxColors}set replace(r){this.uniforms.uReplace=r}get replace(){return this.uniforms.uReplace}};let so=Vs;so.LINEAR=0,so.RADIAL=1,so.CONIC=2,so.defaults={type:Vs.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1};var bw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Tw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;const Pg=class extends tt{constructor(t){super(bw,Tw),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Pg.defaults,t)}apply(t,e,i,s){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.seed=this.seed,this.uniforms.time=this.time,t.applyFilter(this,e,i,s)}set curvature(t){this.uniforms.curvature=t}get curvature(){return this.uniforms.curvature}set lineWidth(t){this.uniforms.lineWidth=t}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(t){this.uniforms.lineContrast=t}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(t){this.uniforms.verticalLine=t}get verticalLine(){return this.uniforms.verticalLine}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};let ww=Pg;ww.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var Sw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Aw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,Cw=Object.defineProperty,Fd=Object.getOwnPropertySymbols,Ew=Object.prototype.hasOwnProperty,Pw=Object.prototype.propertyIsEnumerable,Dd=(r,t,e)=>t in r?Cw(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Bd=(r,t)=>{for(var e in t||(t={}))Ew.call(t,e)&&Dd(r,e,t[e]);if(Fd)for(var e of Fd(t))Pw.call(t,e)&&Dd(r,e,t[e]);return r};const Sl=class extends tt{constructor(t){super(),this.angle=45,this._distance=5,this._resolution=U.FILTER_RESOLUTION;const e=t?Bd(Bd({},Sl.defaults),t):Sl.defaults,{kernels:i,blur:s,quality:n,pixelSize:o,resolution:a}=e;this._offset=new Me(this._updatePadding,this),this._tintFilter=new tt(Sw,Aw),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=a,this._blurFilter=i?new Qo(i):new Qo(s,n),this.pixelSize=o,this.resolution=a;const{shadowOnly:h,rotation:l,distance:u,offset:c,alpha:d,color:f}=e;this.shadowOnly=h,l!==void 0&&u!==void 0?(this.rotation=l,this.distance=u):this.offset=c,this.alpha=d,this.color=f}apply(t,e,i,s){const n=t.getFilterTexture();this._tintFilter.apply(t,e,n,1),this._blurFilter.apply(t,n,i,s),this.shadowOnly!==!0&&t.applyFilter(this,e,i,0),t.returnFilterTexture(n)}_updatePadding(){const t=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=t+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(t){this._offset.copyFrom(t),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)}get distance(){return this._distance}set distance(t){Y("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=t,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/is}set rotation(t){Y("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=t*is,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(t){this._tintFilter.uniforms.alpha=t}get color(){return fs(this._tintFilter.uniforms.color)}set color(t){ds(t,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(t){this._blurFilter.kernels=t}get blur(){return this._blurFilter.blur}set blur(t){this._blurFilter.blur=t,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(t){this._blurFilter.quality=t}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(t){this._blurFilter.pixelSize=t}};let Rw=Sl;Rw.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:U.FILTER_RESOLUTION};var Iw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Mw=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;const Al=class extends tt{constructor(t){super(Iw,Mw),this.offset=100,this.fillMode=Al.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=k.from(this._canvas,{scaleMode:Re.NEAREST}),Object.assign(this,Al.defaults,t)}apply(t,e,i,s){const{width:n,height:o}=e.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/n,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,t.applyFilter(this,e,i,s)}_randomizeSizes(){const t=this._sizes,e=this._slices-1,i=this.sampleSize,s=Math.min(this.minSize/i,.9/this._slices);if(this.average){const n=this._slices;let o=1;for(let a=0;a<e;a++){const h=o/(n-a),l=Math.max(h*(1-Math.random()*.6),s);t[a]=l,o-=l}t[e]=o}else{let n=1;const o=Math.sqrt(1/this._slices);for(let a=0;a<e;a++){const h=Math.max(o*n*Math.random(),s);t[a]=h,n-=h}t[e]=n}this.shuffle()}shuffle(){const t=this._sizes,e=this._slices-1;for(let i=e;i>0;i--){const s=Math.random()*i>>0,n=t[i];t[i]=t[s],t[s]=n}}_randomizeOffsets(){for(let t=0;t<this._slices;t++)this._offsets[t]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){const t=this.sampleSize,e=this.texture,i=this._canvas.getContext("2d");i.clearRect(0,0,8,t);let s,n=0;for(let o=0;o<this._slices;o++){s=Math.floor(this._offsets[o]*256);const a=this._sizes[o]*t,h=s>0?s:0,l=s<0?-s:0;i.fillStyle=`rgba(${h}, ${l}, 0, 1)`,i.fillRect(0,n>>0,t,a+1>>0),n+=a}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){const e=Math.min(this._slices,t.length);for(let i=0;i<e;i++)this._sizes[i]=t[i]}get sizes(){return this._sizes}set offsets(t){const e=Math.min(this._slices,t.length);for(let i=0;i<e;i++)this._offsets[i]=t[i]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(t){this._slices!==t&&(this._slices=t,this.uniforms.slices=t,this._sizes=this.uniforms.slicesWidth=new Float32Array(t),this._offsets=this.uniforms.slicesOffset=new Float32Array(t),this.refresh())}get direction(){return this._direction}set direction(t){if(this._direction===t)return;this._direction=t;const e=t*is;this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e)}get red(){return this.uniforms.red}set red(t){this.uniforms.red=t}get green(){return this.uniforms.green}set green(t){this.uniforms.green=t}get blue(){return this.uniforms.blue}set blue(t){this.uniforms.blue=t}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};let Rr=Al;Rr.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},Rr.TRANSPARENT=0,Rr.ORIGINAL=1,Rr.LOOP=2,Rr.CLAMP=3,Rr.MIRROR=4;var Fw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Dw=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;const Rg=class extends tt{constructor(r){const t=Object.assign({},Rg.defaults,r),{outerStrength:e,innerStrength:i,color:s,knockout:n,quality:o,alpha:a}=t,h=Math.round(t.distance);super(Fw,Dw.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/h).toFixed(7)}`).replace(/__DIST__/gi,`${h.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:s,outerStrength:e,innerStrength:i,padding:h,knockout:n,alpha:a})}get color(){return fs(this.uniforms.glowColor)}set color(r){ds(r,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(r){this.uniforms.outerStrength=r}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(r){this.uniforms.innerStrength=r}get knockout(){return this.uniforms.knockout}set knockout(r){this.uniforms.knockout=r}get alpha(){return this.uniforms.alpha}set alpha(r){this.uniforms.alpha=r}};let Bw=Rg;Bw.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var Ow=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Lw=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,kw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;const Ig=class extends tt{constructor(t){super(Ow,kw.replace("${perlin}",Lw)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);const e=Object.assign(Ig.defaults,t);this._angleLight=new j,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(t,e,i,s){const{width:n,height:o}=e.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/n,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,i,s)}get angle(){return this._angle}set angle(t){this._angle=t;const e=t*is;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(t){this.uniforms.gain=t}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(t){this.uniforms.lacunarity=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};let Nw=Ig;Nw.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};var Uw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Gw=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`;const Mg=class extends tt{constructor(r){super(Uw,Gw),this._hue=0;const t=Object.assign({},Mg.defaults,r);Object.assign(this,t)}get hue(){return this._hue}set hue(r){this._hue=r,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(r){this.uniforms.uAlpha=r}get colorize(){return this.uniforms.uColorize}set colorize(r){this.uniforms.uColorize=r}get lightness(){return this.uniforms.uLightness}set lightness(r){this.uniforms.uLightness=r}get saturation(){return this.uniforms.uSaturation}set saturation(r){this.uniforms.uSaturation=r}};let zw=Mg;zw.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};var Hw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$w=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;const Fg=class extends tt{constructor(t,e=0){super(Hw,$w),this.seed=0,this.uniforms.dimensions=new Float32Array(2),typeof t=="number"?(this.seed=t,t=void 0):this.seed=e,Object.assign(this,Fg.defaults,t)}apply(t,e,i,s){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,this.uniforms.seed=this.seed,t.applyFilter(this,e,i,s)}set sepia(t){this.uniforms.sepia=t}get sepia(){return this.uniforms.sepia}set noise(t){this.uniforms.noise=t}get noise(){return this.uniforms.noise}set noiseSize(t){this.uniforms.noiseSize=t}get noiseSize(){return this.uniforms.noiseSize}set scratch(t){this.uniforms.scratch=t}get scratch(){return this.uniforms.scratch}set scratchDensity(t){this.uniforms.scratchDensity=t}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(t){this.uniforms.scratchWidth=t}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(t){this.uniforms.vignetting=t}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(t){this.uniforms.vignettingAlpha=t}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(t){this.uniforms.vignettingBlur=t}get vignettingBlur(){return this.uniforms.vignettingBlur}};let Vw=Fg;Vw.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var Xw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ww=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`;const To=class extends tt{constructor(t=1,e=0,i=.1,s=1,n=!1){super(Xw,Ww.replace(/\$\{angleStep\}/,To.getAngleStep(i))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=s,this.uniforms.uKnockout=n,Object.assign(this,{thickness:t,color:e,quality:i,alpha:s,knockout:n})}static getAngleStep(t){const e=Math.max(t*To.MAX_SAMPLES,To.MIN_SAMPLES);return(Math.PI*2/e).toFixed(7)}apply(t,e,i,s){this.uniforms.uThickness[0]=this._thickness/e._frame.width,this.uniforms.uThickness[1]=this._thickness/e._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,t.applyFilter(this,e,i,s)}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get color(){return fs(this.uniforms.uColor)}set color(t){ds(t,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(t){this._knockout=t}get thickness(){return this._thickness}set thickness(t){this._thickness=t,this.padding=t}};let Od=To;Od.MIN_SAMPLES=1,Od.MAX_SAMPLES=100;var jw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Yw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;const Dg=class extends tt{constructor(t){super(jw,Yw),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Dg.defaults,t)}apply(t,e,i,s){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,this.uniforms.time=this.time,t.applyFilter(this,e,i,s)}set mirror(t){this.uniforms.mirror=t}get mirror(){return this.uniforms.mirror}set boundary(t){this.uniforms.boundary=t}get boundary(){return this.uniforms.boundary}set amplitude(t){this.uniforms.amplitude[0]=t[0],this.uniforms.amplitude[1]=t[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(t){this.uniforms.waveLength[0]=t[0],this.uniforms.waveLength[1]=t[1]}get waveLength(){return this.uniforms.waveLength}set alpha(t){this.uniforms.alpha[0]=t[0],this.uniforms.alpha[1]=t[1]}get alpha(){return this.uniforms.alpha}};let qw=Dg;qw.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};var Kw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Zw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;const Bg=class extends tt{constructor(t=[0,0],e,i=0){super(Kw,Zw),this.center=t,Object.assign(this,Bg.defaults,e),this.time=i}apply(t,e,i,s){this.uniforms.time=this.time,t.applyFilter(this,e,i,s)}get center(){return this.uniforms.center}set center(t){this.uniforms.center=t}get amplitude(){return this.uniforms.amplitude}set amplitude(t){this.uniforms.amplitude=t}get wavelength(){return this.uniforms.wavelength}set wavelength(t){this.uniforms.wavelength=t}get brightness(){return this.uniforms.brightness}set brightness(t){this.uniforms.brightness=t}get speed(){return this.uniforms.speed}set speed(t){this.uniforms.speed=t}get radius(){return this.uniforms.radius}set radius(t){this.uniforms.radius=t}};let Qw=Bg;Qw.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};var Jw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,tS=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D uLightmap;
uniform vec4 filterArea;
uniform vec2 dimensions;
uniform vec4 ambientColor;
void main() {
    vec4 diffuseColor = texture2D(uSampler, vTextureCoord);
    vec2 lightCoord = (vTextureCoord * filterArea.xy) / dimensions;
    vec4 light = texture2D(uLightmap, lightCoord);
    vec3 ambient = ambientColor.rgb * ambientColor.a;
    vec3 intensity = ambient + light.rgb;
    vec3 finalColor = diffuseColor.rgb * intensity;
    gl_FragColor = vec4(finalColor, diffuseColor.a);
}
`;let Ld=class extends tt{constructor(t,e=0,i=1){super(Jw,tS),this._color=0,this.uniforms.dimensions=new Float32Array(2),this.uniforms.ambientColor=new Float32Array([0,0,0,i]),this.texture=t,this.color=e}apply(t,e,i,s){var n,o;this.uniforms.dimensions[0]=(n=e.filterFrame)==null?void 0:n.width,this.uniforms.dimensions[1]=(o=e.filterFrame)==null?void 0:o.height,t.applyFilter(this,e,i,s)}get texture(){return this.uniforms.uLightmap}set texture(t){this.uniforms.uLightmap=t}set color(t){const e=this.uniforms.ambientColor;typeof t=="number"?(ds(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],this._color=fs(e))}get color(){return this._color}get alpha(){return this.uniforms.ambientColor[3]}set alpha(t){this.uniforms.ambientColor[3]=t}};var eS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,iS=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`;let Og=class extends tt{constructor(t){var e,i;super(eS,iS),this.uniforms.blur=t.blur,this.uniforms.gradientBlur=t.gradientBlur,this.uniforms.start=(e=t.start)!=null?e:new j(0,window.innerHeight/2),this.uniforms.end=(i=t.end)!=null?i:new j(600,window.innerHeight/2),this.uniforms.delta=new j(30,30),this.uniforms.texSize=new j(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(t){this.uniforms.blur=t}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(t){this.uniforms.gradientBlur=t}get start(){return this.uniforms.start}set start(t){this.uniforms.start=t,this.updateDelta()}get end(){return this.uniforms.end}set end(t){this.uniforms.end=t,this.updateDelta()}},rS=class extends Og{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/i,this.uniforms.delta.y=e/i}},sS=class extends Og{updateDelta(){const t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/i,this.uniforms.delta.y=t/i}};const Lg=class extends tt{constructor(t,e,i,s){super(),typeof t=="number"&&(Y("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),t={blur:t,gradientBlur:e,start:i,end:s}),t=Object.assign({},Lg.defaults,t),this.tiltShiftXFilter=new rS(t),this.tiltShiftYFilter=new sS(t)}apply(t,e,i,s){const n=t.getFilterTexture();this.tiltShiftXFilter.apply(t,e,n,1),this.tiltShiftYFilter.apply(t,n,i,s),t.returnFilterTexture(n)}get blur(){return this.tiltShiftXFilter.blur}set blur(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}get start(){return this.tiltShiftXFilter.start}set start(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}get end(){return this.tiltShiftXFilter.end}set end(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}};let nS=Lg;nS.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};var oS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aS=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;const kg=class extends tt{constructor(r){super(oS,aS),Object.assign(this,kg.defaults,r)}get offset(){return this.uniforms.offset}set offset(r){this.uniforms.offset=r}get radius(){return this.uniforms.radius}set radius(r){this.uniforms.radius=r}get angle(){return this.uniforms.angle}set angle(r){this.uniforms.angle=r}};let hS=kg;hS.defaults={radius:200,angle:4,padding:20,offset:new j};var lS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,uS=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,kd=Object.getOwnPropertySymbols,cS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable,fS=(r,t)=>{var e={};for(var i in r)cS.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&kd)for(var i of kd(r))t.indexOf(i)<0&&dS.call(r,i)&&(e[i]=r[i]);return e};const Ng=class extends tt{constructor(r){const t=Object.assign(Ng.defaults,r),{maxKernelSize:e}=t,i=fS(t,["maxKernelSize"]);super(lS,uS.replace("${maxKernelSize}",e.toFixed(1))),Object.assign(this,i)}get center(){return this.uniforms.uCenter}set center(r){this.uniforms.uCenter=r}get strength(){return this.uniforms.uStrength}set strength(r){this.uniforms.uStrength=r}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(r){this.uniforms.uInnerRadius=r}get radius(){return this.uniforms.uRadius}set radius(r){(r<0||r===1/0)&&(r=-1),this.uniforms.uRadius=r}};let pS=Ng;pS.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};class mS extends fa{constructor(){super(...arguments);L(this,"container");L(this,"particleContainer");L(this,"particleFogContainer");L(this,"particleAddContainer");L(this,"particleGlowContainer");L(this,"particleSparksContainer");L(this,"woodSprite");L(this,"fEmitter");L(this,"aEmitter");L(this,"gEmitter");L(this,"sEmitter")}init(){this.container=new Ke(0,0,this,"Container"),this.woodSprite=new wm(722,613,200,75,We.WoodSPrite,this.container),this.particleContainer=new Ke(718,607,this.container,"ParticleContainer"),this.particleContainer.scale.set(2,2),this.particleFogContainer=new Ke(0,-25,this.particleContainer,"particleFogContainer"),this.particleSparksContainer=new Ke(0,-45,this.particleContainer,"particleSparksContainer"),this.particleSparksContainer.scale.set(2,1),this.particleGlowContainer=new Ke(0,0,this.particleContainer,"particleGlowContainer"),this.particleAddContainer=new Ke(0,0,this.particleContainer,"particleAddContainer");const e=Gi.instance.backMenuButtonUp;new da({x:1245,y:35,width:70,height:70,config:Ee.MenuButton,callback:e.bind(this,this.name),parent:this.container});const i=We.FireSmallParticles.map(a=>a.frame);this.fEmitter=new ro(i,We.fireGeneralEmitter,this.particleFogContainer),this.gEmitter=new ro(i,We.fireGlowEmitter,this.particleGlowContainer),this.aEmitter=new ro(i,We.fireGeneralEmitter,this.particleAddContainer),this.aEmitter.particleBlendMode=W.ADD,this.sEmitter=new ro(We.FireParticle.frame,We.fireSparkEmitter,this.particleAddContainer);const s=k.from(We.FireParticle.frame),n=new Ld(s,0),o=new Ld(s,13270592);this.woodSprite.filters=[o,n],this.initDisplayEvents()}setVisualPortrait(){}setVisualLandscape(){}dispose(){this.fEmitter.destroy(),this.gEmitter.destroy(),this.aEmitter.destroy(),this.sEmitter.destroy()}}class gS extends Wt{constructor(e,i,s={}){super();L(this,"_textStyle");L(this,"_maxWidth");L(this,"_currentText");this._textStyle=s,this._maxWidth=i,this._currentText=e,this.updateText(e)}updateText(e){this._currentText=e,this.removeChildren();const i=this.parseText(e);this.buildElements(i)}updateTextStyle(e){this._textStyle={...this._textStyle,...e},this.updateText(this._currentText)}parseText(e){const i=/(\[.*?\])|([^[\]\n]+)|(\n)/g,s=[];let n;for(;(n=i.exec(e))!==null;)s.push(n[0]);return s}buildElements(e){let i=new j(0,0),s=0,n=[];for(const o of e){const a=this.createElement(o);i.x+a.width>this._maxWidth&&n.length>0&&(this.positionElements(n,i.y),n=[],i.x=0,i.y+=s,s=0),a.position.set(i.x,i.y),i.x+=a.width,n.push(a),a.height>s&&(s=a.height)}n.length>0&&this.positionElements(n,i.y)}createElement(e){if(e.startsWith("[")){const i=e.substring(1,e.length-1);return new ke(k.from(i))}else return new Rn(e,this._textStyle)}positionElements(e,i){for(const s of e)this.addChild(s),s.position.y=i}getText(){return this._currentText}}class Mi{}L(Mi,"RandomAssetCounter",3),L(Mi,"CreateAssetDuration",2),L(Mi,"RandomRichTextFontSize",{min:10,max:50}),L(Mi,"SpecialTextOptions",["Lorem","ipsum","dolor","sit","amet","game","images","fun","text","[fire/fire02]","[fire/fire01]","[fire/fire03]","[fire/fire04]","more text","random"]);const ta=class ta extends wt{constructor(){super();L(this,"tickers",{});L(this,"gTime");ta.instance=this}addTimeout(e,i,s,n){if(!this.tickers[e]){let o=new wt;o.autoStart=!0,this.tickers[e]=o,this.gTime=new Date().getTime(),this.tickers[e].add(this.addLoop.bind(this,e,i,s,n))}}addLoop(e,i,s,n){var o=i*1e3,a=new Date().getTime(),h=a-this.gTime;h<o||(s.call("",this),n?this.gTime=new Date().getTime():this.tickers[e].remove(this.addLoop.bind(this,e,i,s,n)))}removeTicker(e){this.tickers[e].destroy(),delete this.tickers[e]}getTickers(){return this.tickers}};L(ta,"instance");let _n=ta;class _S extends fa{constructor(){super(...arguments);L(this,"container");L(this,"richText");L(this,"textStyle")}init(){this.container=new Ke(0,0,this,"Container"),this.textStyle={fill:16777215,fontSize:this.generateRandomFontSize()};const e=this.generateRandomText();this.richText=new gS(e,$r.DisplayResolution.width-100,this.textStyle),this.container.addChild(this.richText);const i=Gi.instance.backMenuButtonUp;new da({x:1245,y:35,width:70,height:70,config:Ee.MenuButton,callback:i.bind(this,this.name),parent:this.container}),this.setCenterRandomRichTextPosition(),_n.instance.addTimeout("RandomText",Mi.CreateAssetDuration,this.updateRandomContent.bind(this),!0),this.initDisplayEvents()}generateRandomText(){const e=Mi.SpecialTextOptions,i=Math.floor(Math.random()*10+5);let s="";for(let n=0;n<i;n++){const o=Math.floor(Math.random()*e.length);s+=e[o]+" "}return s.trim()}generateRandomFontSize(){return Math.floor(Math.random()*Mi.RandomRichTextFontSize.max+Mi.RandomRichTextFontSize.min)}setCenterRandomRichTextPosition(){this.richText.position.set(($r.DisplayResolution.width-this.richText.width)/2,($r.DisplayResolution.height-this.richText.height)/2)}updateRandomContent(){const e=this.generateRandomText(),i=this.generateRandomFontSize();this.richText.updateText(e),this.richText.updateTextStyle({fill:this.textStyle.fill,fontSize:i}),this.setCenterRandomRichTextPosition()}setVisualPortrait(){}setVisualLandscape(){}dispose(){_n.instance.removeTicker("RandomText")}}class ya extends fa{constructor(){super(...arguments);L(this,"stageMap",{[Ae.FirstTask]:MT,[Ae.SecondTask]:_S,[Ae.ThirdTask]:mS,[Ae.Menu]:ya})}init(){new yo({x:640,y:180,width:250,height:130,config:Si.FirstTaskButtonText.bConfig,callback:this.changeStage.bind(this,Ae.FirstTask),parent:this,textConfig:Si.FirstTaskButtonText.tConfig}),new yo({x:640,y:360,width:250,height:130,config:Si.SecondTaskButtonText.bConfig,callback:this.changeStage.bind(this,Ae.SecondTask),parent:this,textConfig:Si.SecondTaskButtonText.tConfig}),new yo({x:640,y:540,width:250,height:130,config:Si.ThirdTaskButtonText.bConfig,callback:this.changeStage.bind(this,Ae.ThirdTask),parent:this,textConfig:Si.ThirdTaskButtonText.tConfig}),this.initDisplayEvents()}setVisualPortrait(){}setVisualLandscape(){}changeStage(e){Gi.instance.removeStage(Ae.Menu),this.stageMap[e]?Gi.instance.startStage(this.stageMap[e],e):console.error("Invalid stage name provided:",e)}dispose(){}}const Gr=class Gr{constructor(t,e,i){L(this,"stages",{});L(this,"stageContainer");Gr.instance=this,this.stageContainer=new Ke(t,e,i,"StageContainer")}createStage(t,e){this.stages[e]==null&&(this.stages[e]=new t,this.stages[e].name=e,this.stageContainer.addChild(this.stages[e]))}backMenuButtonUp(t){Gr.instance.removeStage(t),Gr.instance.startStage(ya,Ae.Menu)}startStage(t,e){this.createStage(t,e),this.stages[e].init()}getStage(t){return this.stages[t]}removeStage(t){this.stages[t].dispose(),this.stages[t].destroy({children:!0,baseTexture:!0}),delete this.stages[t]}getStageContainer(){return this.stageContainer}};L(Gr,"instance");let Gi=Gr;class yS{constructor(){L(this,"displayManager");L(this,"stageManager");new _n,this.displayManager=new ln($r.DisplayResolution.width,$r.DisplayResolution.height),this.stageManager=new Gi(0,0,this.displayManager.getRendererContainer()),this.stageManager.startStage(ya,Ae.Menu),new Xg}}class vS{constructor(){this.initProperties()}async initProperties(){await rr.load("assets/sprites/ui.json"),await rr.load("assets/sprites/particle.png"),new yS}}window.onload=function(){new vS};
